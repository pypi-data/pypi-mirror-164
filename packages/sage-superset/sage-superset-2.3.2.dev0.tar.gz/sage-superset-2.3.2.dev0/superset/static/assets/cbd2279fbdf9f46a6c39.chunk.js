"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7089],{967089:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var r,n=a(943323),s=a(607684);e=a.hmd(e),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const o=(0,n.Z)(s.Z),i=o;var d,l;(d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&d.register(o,"default","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/ReactRose.js"),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&l(e)},607684:(e,t,a)=>{a.d(t,{Z:()=>y});var r,n=a(615078),s=a.n(n),o=a(45697),i=a.n(o),d=a(728041),l=a.n(d),c=a(767190),u=a(435778),p=a(328062);e=a.hmd(e),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const f={data:i().objectOf(i().arrayOf(i().shape({key:i().arrayOf(i().string),name:i().arrayOf(i().string),time:i().number,value:i().number}))),width:i().number,height:i().number,dateTimeFormat:i().string,numberFormat:i().string,useRichTooltip:i().bool,useAreaProportions:i().bool};function g(e){return{startAngle:e.startAngle,endAngle:e.endAngle,innerRadius:e.innerRadius,outerRadius:e.outerRadius}}function m(e,t){return e.value===t.value?e.name>t.name?1:-1:t.value-e.value}function h(e,t){const{data:a,width:r,height:n,colorScheme:o,dateTimeFormat:i,numberFormat:d,useRichTooltip:f,useAreaProportions:h}=t,b=s().select(e);b.classed("superset-legacy-chart-rose",!0);const y=a,_=Object.keys(y).map((e=>parseInt(e,10))).sort(((e,t)=>e-t)),v=_.length,R=y[_[0]].length,I=(0,c.JB)(d),A=(0,u.bt)(i),L=p.getScale(o);s().select(".nvtooltip").remove(),b.selectAll("*").remove();const T=s().svg.arc(),w=l().models.legend(),M=l().models.tooltip(),k={disabled:y[_[0]].map((()=>!1))},H=b.append("svg").attr("width",r).attr("height",n).append("g").attr("class","rose").append("g"),G=H.append("g").attr("class","legendWrap");function O(e){return e[_[0]].map(((e,t)=>({disabled:k.disabled[t],key:e.name})))}w.width(r).color((e=>L(e.key))),G.datum(O(y)).call(w),M.headerFormatter(A).valueFormatter(I);const C=n-w.height(),x=w.height(),P=Math.min(r,C)/2-35,U=.075,F=`translate(${r/2},${C/2+x})`,E=H.append("g").attr("transform",F).attr("class","roseWrap"),N=H.append("g").attr("transform",F).attr("class","labelsWrap"),S=H.append("g").attr("transform",F).attr("class","groupLabelsWrap");function D(e){let t=0,a=0;const r=[];for(const e of _){const n=y[e].reduce(((e,t,a)=>e+(k.disabled[a]?0:t.value)),0);t=n>t?n:t,r[a]=n,a+=1}const n=2*Math.PI/v,s=[];for(let e=0;e<=v;e+=1)s.push(n*e-Math.PI/2);const o=P/t,i=o*P,d=(e,t)=>h?Math.sqrt(i*e+t*t):o*e+t,l={data:[],extend:{},push:{},pieStart:{},pie:{},pieOver:{},mini:{},labels:[],groupLabels:[]};let c=0;for(let t=0;t<v;t+=1){const a=_[t],n=s[t],o=s[t+1],i=2*Math.PI/r[t];let u,p,f=0,g=0;for(const t of e[a]){const e=k.disabled[c%R]?0:t.value,{name:a,time:r}=t;t.id=c,u=d(e,f),l.data.push({startAngle:n,endAngle:o,innerRadius:f,outerRadius:u,name:a,arcId:c,val:e,time:r}),l.extend[c]={startAngle:n,endAngle:o,innerRadius:f,name:a,outerRadius:u+8},l.push[c]={startAngle:n,endAngle:o,innerRadius:f+8,outerRadius:u+8},l.pieStart[c]={startAngle:n,endAngle:o,innerRadius:U*P,outerRadius:P},l.mini[c]={startAngle:n,endAngle:o,innerRadius:f*U,outerRadius:u*U},c+=1,f=u}const h={...l.data[t*R]};h.outerRadius=P+20,h.innerRadius=P+15,l.labels.push(h);for(const n of e[a].concat().sort(m))p=i*(k.disabled[n.id%R]?0:n.value)+g,l.pie[n.id]={startAngle:g,endAngle:p,innerRadius:P*U,outerRadius:P,percent:n.value/r[t]},l.pieOver[n.id]={startAngle:g,endAngle:p,innerRadius:P*U,outerRadius:P+8},g=p}return l.groupLabels=l.data.slice(0,R),l}let W=D(y);function j(e,t){return function(a){const r=s().interpolate(g(a),g(e));return e=>t(Object.assign(a,r(e)))}}function J(e){return j(e,(e=>T(e)))}function q(e){return j(e,(e=>`translate(${T.centroid(e)})`))}const B={};function K(e){if(B[e])return B[e];const t=Math.floor(e/R);return B[e]=[e+1,R*(t+1)-1],B[e]}const Z={};function $(e){if(Z[e])return Z[e];const t=Math.floor(e/R);return Z[e]=[t*R,(t+1)*R-1],Z[e]}let V=-1,z=!1;const Q=E.selectAll("g").data(JSON.parse(JSON.stringify(W.data))).enter().append("g").attr("class","segment").classed("clickable",!0).on("mouseover",(function(e,t){M.data(function(e,t,a){const r=Math.floor(e.arcId/R),n=f?a[_[r]].filter((e=>!k.disabled[e.id%R])).map((t=>({key:t.name,value:t.value,color:L(t.name),highlight:t.id===e.arcId}))):[{key:e.name,value:e.val,color:L(e.name)}];return{key:"Date",value:e.time,series:n}}(e,0,y)).hidden(!1);const a=s().select(this);if(a.classed("hover",!0),V<0&&!z){a.select("path").interrupt().transition().duration(180).attrTween("d",J(W.extend[t]));const e=K(t);ee.filter((t=>e[0]<=t.arcId&&t.arcId<=e[1])).interrupt().transition().duration(180).attrTween("d",(e=>J(W.push[e.arcId])(e)))}else if(!z){const r=$(V);r[0]<=e.arcId&&e.arcId<=r[1]&&a.select("path").interrupt().transition().duration(180).attrTween("d",J(W.pieOver[t]))}})).on("mouseout",(function(e,t){M.hidden(!0);const a=s().select(this);if(a.classed("hover",!1),V<0&&!z){a.select("path").interrupt().transition().duration(180).attrTween("d",J(W.data[t]));const e=K(t);ee.filter((t=>e[0]<=t.arcId&&t.arcId<=e[1])).interrupt().transition().duration(180).attrTween("d",(e=>J(W.data[e.arcId])(e)))}else if(!z){const r=$(V);r[0]<=e.arcId&&e.arcId<=r[1]&&a.select("path").interrupt().transition().duration(180).attrTween("d",J(W.pie[t]))}})).on("mousemove",(function(){M()})).on("click",(function(e,t){if(z)return;const a=s().event.altKey?3750:375,r=$(t);if(V<0)z=!0,V=t,X.interrupt().transition().duration(a).attrTween("transform",(e=>q({outerRadius:0,innerRadius:0,startAngle:e.startAngle,endAngle:e.endAngle})(e))).style("opacity",0),Y.attr("transform",`translate(${T.centroid({outerRadius:P+20,innerRadius:P+15,startAngle:W.data[t].startAngle,endAngle:W.data[t].endAngle})})`).interrupt().transition().delay(a).duration(a).attrTween("transform",(e=>q({outerRadius:P+20,innerRadius:P+15,startAngle:W.pie[r[0]+e.arcId].startAngle,endAngle:W.pie[r[0]+e.arcId].endAngle})(e))).style("opacity",(e=>k.disabled[e.arcId]||W.pie[r[0]+e.arcId].percent<.05?0:1)),Q.classed("clickable",(e=>r[0]>e.arcId||e.arcId>r[1])),ee.filter((e=>r[0]<=e.arcId&&e.arcId<=r[1])).interrupt().transition().duration(a).attrTween("d",(e=>J(W.pieStart[e.arcId])(e))).transition().duration(a).attrTween("d",(e=>J(W.pie[e.arcId])(e))).each("end",(()=>{z=!1})),ee.filter((e=>r[0]>e.arcId||e.arcId>r[1])).interrupt().transition().duration(a).attrTween("d",(e=>J(W.mini[e.arcId])(e)));else if(V<r[0]||r[1]<V){z=!0;const e=$(V);X.interrupt().transition().delay(a).duration(a).attrTween("transform",(e=>q(W.labels[e.arcId/R])(e))).style("opacity",1),Y.interrupt().transition().duration(a).attrTween("transform",q({outerRadius:P+20,innerRadius:P+15,startAngle:W.data[V].startAngle,endAngle:W.data[V].endAngle})).style("opacity",0),Q.classed("clickable",!0),ee.filter((t=>e[0]<=t.arcId&&t.arcId<=e[1])).interrupt().transition().duration(a).attrTween("d",(e=>J(W.pieStart[e.arcId])(e))).transition().duration(a).attrTween("d",(e=>J(W.data[e.arcId])(e))).each("end",(()=>{V=-1,z=!1})),ee.filter((t=>e[0]>t.arcId||t.arcId>e[1])).interrupt().transition().delay(a).duration(a).attrTween("d",(e=>J(W.data[e.arcId])(e)))}})),X=N.selectAll("g").data(JSON.parse(JSON.stringify(W.labels))).enter().append("g").attr("class","roseLabel").attr("transform",(e=>`translate(${T.centroid(e)})`));X.append("text").style("text-anchor","middle").style("fill","#000").text((e=>A(e.time)));const Y=S.selectAll("g").data(JSON.parse(JSON.stringify(W.groupLabels))).enter().append("g");Y.style("opacity",0).attr("class","roseGroupLabels").append("text").style("text-anchor","middle").style("fill","#000").text((e=>e.name));const ee=Q.append("path").attr("class","arc").attr("fill",(e=>L(e.name))).attr("d",T);w.dispatch.on("stateChange",(e=>{k.disabled!==e.disabled&&(k.disabled=e.disabled,function(){const e=s().event.altKey?3e3:300;G.datum(O(y)).call(w);const t=D(y);if(z=!0,V<0)ee.style("opacity",1).interrupt().transition().duration(e).attrTween("d",(e=>J(t.data[e.arcId])(e))).each("end",(()=>{z=!1,W=t})).transition().duration(0).style("opacity",(e=>k.disabled[e.arcId%R]?0:1));else{const a=$(V);ee.style("opacity",1).interrupt().transition().duration(e).attrTween("d",(e=>a[0]<=e.arcId&&e.arcId<=a[1]?J(t.pie[e.arcId])(e):J(t.mini[e.arcId])(e))).each("end",(()=>{z=!1,W=t})).transition().duration(0).style("opacity",(e=>k.disabled[e.arcId%R]?0:1)),Y.interrupt().transition().duration(e).attrTween("transform",(e=>q({outerRadius:P+20,innerRadius:P+15,startAngle:t.pie[a[0]+e.arcId].startAngle,endAngle:t.pie[a[0]+e.arcId].endAngle})(e))).style("opacity",(e=>k.disabled[e.arcId]||W.pie[a[0]+e.arcId].percent<.05?0:1))}}())}))}h.displayName="Rose",h.propTypes=f;const b=h,y=b;var _,v;(_="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(_.register(f,"propTypes","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js"),_.register(g,"copyArc","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js"),_.register(m,"sortValues","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js"),_.register(h,"Rose","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js"),_.register(b,"default","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js")),(v="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&v(e)},943323:(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>reactify});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(667294),_emotion_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(211965),enterModule;module=__webpack_require__.hmd(module),enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},reactHotLoader,leaveModule;function reactify(renderFn,callbacks){class ReactifiedComponent extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(e){super(e),this.container=void 0,this.setContainerRef=this.setContainerRef.bind(this)}componentDidMount(){this.execute()}componentDidUpdate(){this.execute()}componentWillUnmount(){this.container=void 0,null!=callbacks&&callbacks.componentWillUnmount&&callbacks.componentWillUnmount.bind(this)()}setContainerRef(e){this.container=e}execute(){this.container&&renderFn(this.container,this.props)}render(){const{id:e,className:t}=this.props;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_1__.tZ)("div",{ref:this.setContainerRef,id:e,className:t})}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}const ReactifiedClass=ReactifiedComponent;return renderFn.displayName&&(ReactifiedClass.displayName=renderFn.displayName),renderFn.propTypes&&(ReactifiedClass.propTypes={...ReactifiedClass.propTypes,...renderFn.propTypes}),renderFn.defaultProps&&(ReactifiedClass.defaultProps=renderFn.defaultProps),ReactifiedComponent}reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&reactHotLoader.register(reactify,"reactify","/Users/chenming/superset/superset-frontend/packages/superset-ui-core/src/chart/components/reactify.tsx"),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)}}]);