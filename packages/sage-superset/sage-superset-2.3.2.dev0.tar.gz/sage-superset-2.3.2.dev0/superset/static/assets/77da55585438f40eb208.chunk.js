"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[5094],{725094:(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>AnnotationLayer});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(667294),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(45697),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),react_color__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(24198),src_components_Button__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(835932),_superset_ui_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(311064),_superset_ui_core__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(760524),_superset_ui_core__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(895826),_superset_ui_core__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(431069),_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(455867),_superset_ui_core__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(281545),src_explore_components_controls_SelectControl__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(182199),src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(979684),src_explore_components_controls_CheckboxControl__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(379069),src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(10945),src_components_PopoverSection__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(883734),src_explore_components_ControlHeader__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(482342),_emotion_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(211965),enterModule;function _EMOTION_STRINGIFIED_CSS_ERROR__(){return"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."}module=__webpack_require__.hmd(module),enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(_){return _};const AUTOMATIC_COLOR="",propTypes={name:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,annotationType:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,sourceType:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,color:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,opacity:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,style:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,width:prop_types__WEBPACK_IMPORTED_MODULE_1___default().number,showMarkers:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,hideLine:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,value:prop_types__WEBPACK_IMPORTED_MODULE_1___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,prop_types__WEBPACK_IMPORTED_MODULE_1___default().number]),overrides:prop_types__WEBPACK_IMPORTED_MODULE_1___default().object,show:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,showLabel:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,titleColumn:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,descriptionColumns:prop_types__WEBPACK_IMPORTED_MODULE_1___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),timeColumn:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,intervalEndColumn:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,vizType:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,error:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,colorScheme:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,addAnnotationLayer:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,removeAnnotationLayer:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,close:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func},defaultProps={name:"",annotationType:src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.qy,sourceType:"",color:AUTOMATIC_COLOR,opacity:"",style:"solid",width:1,showMarkers:!1,hideLine:!1,overrides:{},colorScheme:"d3Category10",show:!0,showLabel:!1,titleColumn:"",descriptionColumns:[],timeColumn:"",intervalEndColumn:"",addAnnotationLayer:()=>{},removeAnnotationLayer:()=>{},close:()=>{}};var _ref={name:"1h52dri",styles:"overflow:hidden;text-overflow:ellipsis;white-space:nowrap"},reactHotLoader,leaveModule;class AnnotationLayer extends react__WEBPACK_IMPORTED_MODULE_0__.PureComponent{constructor(_){super(_);const{name:e,annotationType:t,sourceType:o,color:n,opacity:r,style:s,width:a,showMarkers:i,hideLine:l,value:E,overrides:p,show:u,showLabel:c,titleColumn:O,descriptionColumns:M,timeColumn:D,intervalEndColumn:d,vizType:P}=_;("since"in p||"until"in p)&&(p.time_range=null,delete p.since,delete p.until);const T=(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_10__.Z)().get(P),C=(null==T?void 0:T.supportedAnnotationTypes)||[],m=C.includes(t)?t:C[0];this.state={name:e,annotationType:m,sourceType:o,value:E,overrides:p,show:u,showLabel:c,titleColumn:O,descriptionColumns:M,timeColumn:D,intervalEndColumn:d,color:n||AUTOMATIC_COLOR,opacity:r,style:s,width:a,showMarkers:i,hideLine:l,isNew:!e,isLoadingOptions:!0,valueOptions:[]},this.submitAnnotation=this.submitAnnotation.bind(this),this.deleteAnnotation=this.deleteAnnotation.bind(this),this.applyAnnotation=this.applyAnnotation.bind(this),this.fetchOptions=this.fetchOptions.bind(this),this.handleAnnotationType=this.handleAnnotationType.bind(this),this.handleAnnotationSourceType=this.handleAnnotationSourceType.bind(this),this.handleValue=this.handleValue.bind(this),this.isValidForm=this.isValidForm.bind(this)}componentDidMount(){const{annotationType:_,sourceType:e,isLoadingOptions:t}=this.state;this.fetchOptions(_,e,t)}componentDidUpdate(_,e){e.sourceType!==this.state.sourceType&&this.fetchOptions(this.state.annotationType,this.state.sourceType,!0)}getSupportedSourceTypes(_){var e;const t=(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_10__.Z)().entries().filter((({value:e})=>e.canBeAnnotationType(_))).map((({key:_,value:e})=>({value:_,label:e.name})));return null!=(e=src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.J_[_])&&e.supportNativeSource&&t.unshift(src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.dS.NATIVE),t}isValidFormulaAnnotation(_,e){return e!==src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.FORMULA||(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_11__.$)(_)}isValidForm(){const{name:_,annotationType:e,sourceType:t,value:o,timeColumn:n,intervalEndColumn:r}=this.state,s=[(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_12__.Z)(_),(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_12__.Z)(e),(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_12__.Z)(o)];return t!==src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.S4.NATIVE&&(e===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.EVENT&&s.push((0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_12__.Z)(n)),e===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.INTERVAL&&(s.push((0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_12__.Z)(n)),s.push((0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_12__.Z)(r)))),s.push(!this.isValidFormulaAnnotation(o,e)),!s.filter((_=>_)).length}handleAnnotationType(_){this.setState({annotationType:_,sourceType:null,value:null})}handleAnnotationSourceType(_){const{sourceType:e}=this.state;e!==_&&this.setState({sourceType:_,value:null,isLoadingOptions:!0})}handleValue(_){this.setState({value:_,descriptionColumns:[],intervalEndColumn:null,timeColumn:null,titleColumn:null,overrides:{time_range:null}})}fetchOptions(_,e,t){t&&(e===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.S4.NATIVE?_superset_ui_core__WEBPACK_IMPORTED_MODULE_13__.Z.get({endpoint:"/annotationlayermodelview/api/read?"}).then((({json:_})=>{const e=_?_.result.map((_=>({value:_.id,label:_.name}))):[];this.setState({isLoadingOptions:!1,valueOptions:e})})):(0,src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.m7)(e)?_superset_ui_core__WEBPACK_IMPORTED_MODULE_13__.Z.get({endpoint:"/superset/user_slices"}).then((({json:e})=>{const t=(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_10__.Z)();this.setState({isLoadingOptions:!1,valueOptions:e.filter((e=>{const o=t.get(e.viz_type);return o&&o.canBeAnnotationType(_)})).map((_=>({value:_.id,label:_.title,slice:_})))})})):this.setState({isLoadingOptions:!1,valueOptions:[]}))}deleteAnnotation(){this.props.removeAnnotationLayer(),this.props.close()}applyAnnotation(){if(this.isValidForm()){const _={};["name","annotationType","sourceType","color","opacity","style","width","showMarkers","hideLine","value","overrides","show","showLabel","titleColumn","descriptionColumns","timeColumn","intervalEndColumn"].forEach((e=>{null!==this.state[e]&&(_[e]=this.state[e])})),_.color===AUTOMATIC_COLOR&&(_.color=null),this.props.addAnnotationLayer(_),this.setState({isNew:!1})}}submitAnnotation(){this.applyAnnotation(),this.props.close()}renderOption(_){return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)("span",{css:_ref,title:_.label},_.label)}renderValueConfiguration(){const{annotationType:_,sourceType:e,value:t,valueOptions:o,isLoadingOptions:n}=this.state;let r="",s="";return(0,src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.m7)(e)?e===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.S4.NATIVE?(r="Annotation layer",s="Select the Annotation Layer you would like to use."):(r=(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Chart"),s=`Use a pre defined Superset Chart as a source for annotations and overlays.\n        your chart must be one of these visualization types:\n        [${this.getSupportedSourceTypes(_).map((_=>_.label)).join(", ")}]`):_===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.FORMULA&&(r="Formula",s="Expects a formula with depending time parameter 'x'\n        in milliseconds since epoch. mathjs is used to evaluate the formulas.\n        Example: '2x+5'"),(0,src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.m7)(e)?(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_SelectControl__WEBPACK_IMPORTED_MODULE_4__.Z,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation layer value"),name:"annotation-layer-value",showHeader:!0,hovered:!0,description:s,label:r,placeholder:"",options:o,isLoading:n,value:t,onChange:this.handleValue,validationErrors:t?[]:["Mandatory"],optionRenderer:this.renderOption}):_===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.FORMULA?(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_5__.Z,{name:"annotation-layer-value",hovered:!0,showHeader:!0,description:s,label:r,placeholder:"",value:t,onChange:this.handleValue,validationErrors:this.isValidFormulaAnnotation(t,_)?[]:["Bad formula."]}):""}renderSliceConfiguration(){const{annotationType:_,sourceType:e,value:t,valueOptions:o,overrides:n,titleColumn:r,timeColumn:s,intervalEndColumn:a,descriptionColumns:i}=this.state,{slice:l}=o.find((_=>_.value===t))||{};if(e!==src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.S4.NATIVE&&l){const e=(l.data.groupby||[]).concat(l.data.all_columns||[]).map((_=>({value:_,label:_}))),t=l.data.include_time?[{value:"__timestamp",label:"__timestamp"}].concat(e):e;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)("div",{style:{marginRight:"2rem"}},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_components_PopoverSection__WEBPACK_IMPORTED_MODULE_8__.Z,{isSelected:!0,title:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation Slice Configuration"),info:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("This section allows you to configure how to use the slice\n               to generate annotations.")},(_===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.EVENT||_===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.INTERVAL)&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_SelectControl__WEBPACK_IMPORTED_MODULE_4__.Z,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation layer time column"),hovered:!0,name:"annotation-layer-time-column",label:_===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.INTERVAL?(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Interval start column"):(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Event time column"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("This column must contain date/time information."),validationErrors:s?[]:["Mandatory"],clearable:!1,options:t,value:s,onChange:_=>this.setState({timeColumn:_})}),_===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.INTERVAL&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_SelectControl__WEBPACK_IMPORTED_MODULE_4__.Z,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation layer interval end"),hovered:!0,name:"annotation-layer-intervalEnd",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Interval End column"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("This column must contain date/time information."),validationErrors:a?[]:["Mandatory"],options:e,value:a,onChange:_=>this.setState({intervalEndColumn:_})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_SelectControl__WEBPACK_IMPORTED_MODULE_4__.Z,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation layer title column"),hovered:!0,name:"annotation-layer-title",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Title Column"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Pick a title for you annotation."),options:[{value:"",label:"None"}].concat(e),value:r,onChange:_=>this.setState({titleColumn:_})}),_!==src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.TIME_SERIES&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_SelectControl__WEBPACK_IMPORTED_MODULE_4__.Z,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation layer description columns"),hovered:!0,name:"annotation-layer-title",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Description Columns"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Pick one or more columns that should be shown in the annotation. If you don't select a column all of them will be shown."),multi:!0,options:e,value:i,onChange:_=>this.setState({descriptionColumns:_})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)("div",{style:{marginTop:"1rem"}},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_CheckboxControl__WEBPACK_IMPORTED_MODULE_6__.Z,{hovered:!0,name:"annotation-override-time_range",label:"Override time range",description:'This controls whether the "time_range" field from the current\n                  view should be passed down to the chart containing the annotation data.',value:"time_range"in n,onChange:_=>{delete n.time_range,_?this.setState({overrides:{...n,time_range:null}}):this.setState({overrides:{...n}})}}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_CheckboxControl__WEBPACK_IMPORTED_MODULE_6__.Z,{hovered:!0,name:"annotation-override-timegrain",label:"Override time grain",description:"This controls whether the time grain field from the current\n                  view should be passed down to the chart containing the annotation data.",value:"time_grain_sqla"in n,onChange:_=>{delete n.time_grain_sqla,delete n.granularity,_?this.setState({overrides:{...n,time_grain_sqla:null,granularity:null}}):this.setState({overrides:{...n}})}}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_5__.Z,{hovered:!0,name:"annotation-layer-timeshift",label:"Time Shift",description:"Time delta in natural language\n                  (example:  24 hours, 7 days, 56 weeks, 365 days)",placeholder:"",value:n.time_shift,onChange:_=>this.setState({overrides:{...n,time_shift:_}})}))))}return""}renderDisplayConfiguration(){const{color:_,opacity:e,style:t,width:o,showMarkers:n,hideLine:r,annotationType:s}=this.state,a=(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_16__.Z)().get(this.props.colorScheme).colors.concat();return _&&_!==AUTOMATIC_COLOR&&!a.find((e=>e.toLowerCase()===_.toLowerCase()))&&a.push(_),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_components_PopoverSection__WEBPACK_IMPORTED_MODULE_8__.Z,{isSelected:!0,title:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Display configuration"),info:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Configure your how you overlay is displayed here.")},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_SelectControl__WEBPACK_IMPORTED_MODULE_4__.Z,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation layer stroke"),name:"annotation-layer-stroke",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Style"),options:[{value:"solid",label:"Solid"},{value:"dashed",label:"Dashed"},{value:"longDashed",label:"Long dashed"},{value:"dotted",label:"Dotted"}],value:t,clearable:!1,onChange:_=>this.setState({style:_})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_SelectControl__WEBPACK_IMPORTED_MODULE_4__.Z,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation layer opacity"),name:"annotation-layer-opacity",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Opacity"),options:[{value:"",label:"Solid"},{value:"opacityLow",label:"0.2"},{value:"opacityMedium",label:"0.5"},{value:"opacityHigh",label:"0.8"}],value:e,onChange:_=>this.setState({opacity:_})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)("div",null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_ControlHeader__WEBPACK_IMPORTED_MODULE_9__.Z,{label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Color")}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)("div",{style:{display:"flex",flexDirection:"column"}},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(react_color__WEBPACK_IMPORTED_MODULE_2__.Ie,{color:_,colors:a,onChangeComplete:_=>this.setState({color:_.hex})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_components_Button__WEBPACK_IMPORTED_MODULE_3__.Z,{style:{marginTop:"0.5rem",marginBottom:"0.5rem"},buttonStyle:_===AUTOMATIC_COLOR?"success":"default",buttonSize:"xsmall",onClick:()=>this.setState({color:AUTOMATIC_COLOR})},"Automatic Color"))),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_5__.Z,{name:"annotation-layer-stroke-width",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Line width"),isInt:!0,value:o,onChange:_=>this.setState({width:_})}),s===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.TIME_SERIES&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_CheckboxControl__WEBPACK_IMPORTED_MODULE_6__.Z,{hovered:!0,name:"annotation-layer-show-markers",label:"Show Markers",description:"Shows or hides markers for the time series",value:n,onChange:_=>this.setState({showMarkers:_})}),s===src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.DT.TIME_SERIES&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_CheckboxControl__WEBPACK_IMPORTED_MODULE_6__.Z,{hovered:!0,name:"annotation-layer-hide-line",label:"Hide Line",description:"Hides the Line for the time series",value:r,onChange:_=>this.setState({hideLine:_})}))}render(){const{isNew:_,name:e,annotationType:t,sourceType:o,show:n,showLabel:r}=this.state,s=this.isValidForm(),a=(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_10__.Z)().get(this.props.vizType),i=a?a.supportedAnnotationTypes.map((_=>src_modules_AnnotationTypes__WEBPACK_IMPORTED_MODULE_7__.J_[_])):[],l=this.getSupportedSourceTypes(t);return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,this.props.error&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)("span",{style:{color:"red"}},"ERROR: ",this.props.error),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)("div",{style:{display:"flex",flexDirection:"row"}},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)("div",{style:{marginRight:"2rem"}},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_components_PopoverSection__WEBPACK_IMPORTED_MODULE_8__.Z,{isSelected:!0,title:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Layer configuration"),info:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Configure the basics of your Annotation Layer.")},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_5__.Z,{name:"annotation-layer-name",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Name"),placeholder:"",value:e,onChange:_=>this.setState({name:_}),validationErrors:e?[]:[(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Mandatory")]}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_CheckboxControl__WEBPACK_IMPORTED_MODULE_6__.Z,{name:"annotation-layer-hide",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Hide layer"),value:!n,onChange:_=>this.setState({show:!_})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_CheckboxControl__WEBPACK_IMPORTED_MODULE_6__.Z,{name:"annotation-label-show",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Show label"),value:r,hovered:!0,description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Whether to always show the annotation label"),onChange:_=>this.setState({showLabel:_})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_SelectControl__WEBPACK_IMPORTED_MODULE_4__.Z,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation layer type"),hovered:!0,description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Choose the annotation layer type"),label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation layer type"),name:"annotation-layer-type",clearable:!1,options:i,value:t,onChange:this.handleAnnotationType}),l.length>0&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_explore_components_controls_SelectControl__WEBPACK_IMPORTED_MODULE_4__.Z,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation source type"),hovered:!0,description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Choose the source of your annotations"),label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Annotation Source"),name:"annotation-source-type",options:l,value:o,onChange:this.handleAnnotationSourceType,validationErrors:o?[]:[(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Mandatory")]}),this.renderValueConfiguration())),this.renderSliceConfiguration(),this.renderDisplayConfiguration()),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)("div",{style:{display:"flex",justifyContent:"space-between"}},_?(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_components_Button__WEBPACK_IMPORTED_MODULE_3__.Z,{buttonSize:"small",onClick:()=>this.props.close()},(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Cancel")):(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_components_Button__WEBPACK_IMPORTED_MODULE_3__.Z,{buttonSize:"small",onClick:this.deleteAnnotation},(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Remove")),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)("div",null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_components_Button__WEBPACK_IMPORTED_MODULE_3__.Z,{buttonSize:"small",disabled:!s,onClick:this.applyAnnotation},(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("Apply")),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_14__.tZ)(src_components_Button__WEBPACK_IMPORTED_MODULE_3__.Z,{buttonSize:"small",buttonStyle:"primary",disabled:!s,onClick:this.submitAnnotation},(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_15__.t)("OK")))))}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}AnnotationLayer.propTypes=propTypes,AnnotationLayer.defaultProps=defaultProps,reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&(reactHotLoader.register(AUTOMATIC_COLOR,"AUTOMATIC_COLOR","/Users/chenming/superset/superset-frontend/src/explore/components/controls/AnnotationLayerControl/AnnotationLayer.jsx"),reactHotLoader.register(propTypes,"propTypes","/Users/chenming/superset/superset-frontend/src/explore/components/controls/AnnotationLayerControl/AnnotationLayer.jsx"),reactHotLoader.register(defaultProps,"defaultProps","/Users/chenming/superset/superset-frontend/src/explore/components/controls/AnnotationLayerControl/AnnotationLayer.jsx"),reactHotLoader.register(AnnotationLayer,"AnnotationLayer","/Users/chenming/superset/superset-frontend/src/explore/components/controls/AnnotationLayerControl/AnnotationLayer.jsx")),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)},760524:(_,e,t)=>{t.d(e,{f:()=>i,$:()=>l});var o,n=t(22087),r=t.n(n);_=t.hmd(_),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&o(_),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const s=[[new RegExp(/==/g),"Eq"],[new RegExp(/>=/g),"Gte"],[new RegExp(/<=/g),"Lte"],[new RegExp(/>/g),"Gt"],[new RegExp(/</g),"Lt"]],a=[{type:3,token:"x",show:"x",value:"x"},{type:2,token:"&",show:"&",value:(_,e)=>_&e},{type:2,token:"|",show:"|",value:(_,e)=>_|e},{type:2,token:"and",show:"and",value:(_,e)=>_&&e},{type:2,token:"xor",show:"xor",value:(_,e)=>_^e},{type:2,token:"or",show:"or",value:(_,e)=>Number(_||e)},{type:2,token:"Eq",show:"Eq",value:(_,e)=>Number(_===e)},{type:2,token:"Lt",show:"Lt",value:(_,e)=>Number(_<e)},{type:2,token:"Lte",show:"Lte",value:(_,e)=>Number(_<=e)},{type:2,token:"Gt",show:"Gt",value:(_,e)=>Number(_>e)},{type:2,token:"Gte",show:"Gte",value:(_,e)=>Number(_>=e)}];function i(_,e){var t;let o=_;s.forEach((([_,e])=>{o=o.replace(_,e)}));const n=String(o).split("=");return o=null!=(t=n[1])?t:n[0],Number(r().eval(o,a,{x:e}))}function l(_){try{i(_,0)}catch(_){return!1}return!0}var E,p;(E="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(E.register(s,"REPLACE_OPERATORS","/Users/chenming/superset/superset-frontend/packages/superset-ui-core/src/math-expression/index.ts"),E.register(a,"TOKENS","/Users/chenming/superset/superset-frontend/packages/superset-ui-core/src/math-expression/index.ts"),E.register(i,"evalExpression","/Users/chenming/superset/superset-frontend/packages/superset-ui-core/src/math-expression/index.ts"),E.register(l,"isValidExpression","/Users/chenming/superset/superset-frontend/packages/superset-ui-core/src/math-expression/index.ts")),(p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&p(_)}}]);