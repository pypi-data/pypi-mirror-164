"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[4787],{129848:(e,t,a)=>{a.d(t,{Z:()=>c}),a(667294);var n,o=a(751995),r=a(358593),s=a(87693),l=a(211965);e=a.hmd(e),(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const i=o.iK.span`
  white-space: nowrap;
  min-width: 100px;
  svg,
  i {
    margin-right: 8px;

    &:hover {
      path {
        fill: ${({theme:e})=>e.colors.primary.base};
      }
    }
  }
`,d=o.iK.span`
  color: ${({theme:e})=>e.colors.grayscale.base};
`;function c({actions:e}){return(0,l.tZ)(i,{className:"actions"},e.map(((e,t)=>{const a=s.Z[e.icon];return e.tooltip?(0,l.tZ)(r.u,{id:`${e.label}-tooltip`,title:e.tooltip,placement:e.placement,key:t},(0,l.tZ)(d,{role:"button",tabIndex:0,className:"action-button","data-test":e.label,onClick:e.onClick},(0,l.tZ)(a,null))):(0,l.tZ)(d,{role:"button",tabIndex:0,className:"action-button",onClick:e.onClick,"data-test":e.label,key:t},(0,l.tZ)(a,null))})))}var u,p;(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(u.register(i,"StyledActions","/Users/chenming/superset/superset-frontend/src/components/ListView/ActionsBar.tsx"),u.register(d,"ActionWrapper","/Users/chenming/superset/superset-frontend/src/components/ListView/ActionsBar.tsx"),u.register(c,"ActionsBar","/Users/chenming/superset/superset-frontend/src/components/ListView/ActionsBar.tsx")),(p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&p(e)},240239:(e,t,a)=>{a.d(t,{Z:()=>b});var n,o=a(667294),r=a(751995),s=a(455867),l=a(34858),i=a(87693),d=a(440768),c=a(574520),u=a(414114),p=a(211965);e=a.hmd(e),(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);var m="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e};const y=r.iK.div`
  margin: ${({theme:e})=>2*e.gridUnit}px auto
    ${({theme:e})=>4*e.gridUnit}px auto;
`,g=r.iK.div`
  margin-bottom: ${({theme:e})=>10*e.gridUnit}px;

  .control-label {
    margin-bottom: ${({theme:e})=>2*e.gridUnit}px;
  }

  .required {
    margin-left: ${({theme:e})=>e.gridUnit/2}px;
    color: ${({theme:e})=>e.colors.error.base};
  }

  textarea,
  input[type='text'] {
    padding: ${({theme:e})=>1.5*e.gridUnit}px
      ${({theme:e})=>2*e.gridUnit}px;
    border: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    border-radius: ${({theme:e})=>e.gridUnit}px;
    width: 50%;
  }

  input,
  textarea {
    flex: 1 1 auto;
  }

  textarea {
    width: 100%;
    height: 160px;
    resize: none;
  }

  input::placeholder,
  textarea::placeholder {
    color: ${({theme:e})=>e.colors.grayscale.light1};
  }
`,f=({addDangerToast:e,addSuccessToast:t,onLayerAdd:a,onHide:n,show:r,layer:u=null})=>{const[m,f]=(0,o.useState)(!0),[h,b]=(0,o.useState)(),[L,v]=(0,o.useState)(!0),Z=null!==u,{state:{loading:w,resource:C},fetchResource:H,createResource:A,updateResource:S}=(0,l.LE)("annotation_layer",(0,s.t)("annotation_layer"),e),x=()=>{b({name:"",descr:""})},D=()=>{v(!0),x(),n()},M=e=>{const{target:t}=e,a={...h,name:h?h.name:"",descr:h?h.descr:""};a[t.name]=t.value,b(a)};return(0,o.useEffect)((()=>{if(Z&&(!h||!h.id||u&&u.id!==h.id||L&&r)){if(r&&u&&null!==u.id&&!w){const e=u.id||0;H(e)}}else!Z&&(!h||h.id||L&&r)&&x()}),[u,r]),(0,o.useEffect)((()=>{C&&b(C)}),[C]),(0,o.useEffect)((()=>{var e;h&&null!=(e=h.name)&&e.length?f(!1):f(!0)}),[h?h.name:"",h?h.descr:""]),L&&r&&v(!1),(0,p.tZ)(c.Z,{disablePrimaryButton:m,onHandledPrimaryAction:()=>{if(Z){if(h&&h.id){const e=h.id;delete h.id,delete h.created_by,S(e,h).then((e=>{e&&(D(),t((0,s.t)("Annotation template updated")))}))}}else h&&A(h).then((e=>{e&&(a&&a(e),D(),t((0,s.t)("Annotation template created")))}))},onHide:D,primaryButtonName:Z?(0,s.t)("Save"):(0,s.t)("Add"),show:r,width:"55%",title:(0,p.tZ)("h4",{"data-test":"annotation-layer-modal-title"},Z?(0,p.tZ)(i.Z.EditAlt,{css:d.xL}):(0,p.tZ)(i.Z.PlusLarge,{css:d.xL}),Z?(0,s.t)("Edit annotation layer properties"):(0,s.t)("Add annotation layer"))},(0,p.tZ)(y,null,(0,p.tZ)("h4",null,(0,s.t)("Basic information"))),(0,p.tZ)(g,null,(0,p.tZ)("div",{className:"control-label"},(0,s.t)("Annotation layer name"),(0,p.tZ)("span",{className:"required"},"*")),(0,p.tZ)("input",{name:"name",onChange:M,type:"text",value:null==h?void 0:h.name})),(0,p.tZ)(g,null,(0,p.tZ)("div",{className:"control-label"},(0,s.t)("description")),(0,p.tZ)("textarea",{name:"descr",value:null==h?void 0:h.descr,placeholder:(0,s.t)("Description (this can be seen in the list)"),onChange:M})))};m(f,"useState{[disableSave, setDisableSave](true)}\nuseState{[currentLayer, setCurrentLayer]}\nuseState{[isHidden, setIsHidden](true)}\nuseSingleViewResource{{ state: { loading, resource }, fetchResource, createResource, updateResource, }}\nuseEffect{}\nuseEffect{}\nuseEffect{}",(()=>[l.LE]));const h=(0,u.Z)(f),b=h;var L,v;(L="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(L.register(y,"StyledAnnotationLayerTitle","/Users/chenming/superset/superset-frontend/src/views/CRUD/annotationlayers/AnnotationLayerModal.tsx"),L.register(g,"LayerContainer","/Users/chenming/superset/superset-frontend/src/views/CRUD/annotationlayers/AnnotationLayerModal.tsx"),L.register(f,"AnnotationLayerModal","/Users/chenming/superset/superset-frontend/src/views/CRUD/annotationlayers/AnnotationLayerModal.tsx"),L.register(h,"default","/Users/chenming/superset/superset-frontend/src/views/CRUD/annotationlayers/AnnotationLayerModal.tsx")),(v="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&v(e)},59534:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D});var n,o=a(667294),r=a(115926),s=a.n(r),l=a(455867),i=a(431069),d=a(505977),c=a(473727),u=a(730381),p=a.n(u),m=a(34858),y=a(440768),g=a(414114),f=a(620755),h=a(129848),b=a(550859),L=a(835932),v=a(217198),Z=a(419259),w=a(240239),C=a(211965);e=a.hmd(e),(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);var H="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e};const A="MMM DD, YYYY";function S({addDangerToast:e,addSuccessToast:t,user:a}){const{state:{loading:n,resourceCount:r,resourceCollection:u,bulkSelectEnabled:g},hasPerm:S,fetchData:x,refreshData:D,toggleBulkSelect:M}=(0,m.Yi)("annotation_layer",(0,l.t)("Annotation layers"),e),[U,k]=(0,o.useState)(!1),[G,$]=(0,o.useState)(null),[_,E]=(0,o.useState)(null),R=S("can_write"),T=S("can_write"),B=S("can_write");function N(e){$(e),k(!0)}const Y=[{id:"name",desc:!0}],P=(0,o.useMemo)((()=>[{accessor:"name",Header:(0,l.t)("Name"),Cell:H((({row:{original:{id:e,name:t}}})=>{let a=!0;try{(0,d.k6)()}catch(e){a=!1}return a?(0,C.tZ)(c.rU,{to:`/annotationmodelview/${e}/annotation`},t):(0,C.tZ)("a",{href:`/annotationmodelview/${e}/annotation`},t)}),"useHistory{}",(()=>[d.k6]))},{accessor:"descr",Header:(0,l.t)("Description")},{Cell:({row:{original:{changed_on:e}}})=>{const t=new Date(e),a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return p()(a).format(A)},Header:(0,l.t)("Last modified"),accessor:"changed_on",size:"xl"},{Cell:({row:{original:{created_on:e}}})=>{const t=new Date(e),a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return p()(a).format(A)},Header:(0,l.t)("Created on"),accessor:"created_on",size:"xl"},{accessor:"created_by",disableSortBy:!0,Header:(0,l.t)("Created by"),Cell:({row:{original:{created_by:e}}})=>e?`${e.first_name} ${e.last_name}`:"",size:"xl"},{Cell:({row:{original:e}})=>{const t=[T?{label:"edit-action",tooltip:(0,l.t)("Edit template"),placement:"bottom",icon:"Edit",onClick:()=>N(e)}:null,B?{label:"delete-action",tooltip:(0,l.t)("Delete template"),placement:"bottom",icon:"Trash",onClick:()=>E(e)}:null].filter((e=>!!e));return(0,C.tZ)(h.Z,{actions:t})},Header:(0,l.t)("Actions"),id:"actions",disableSortBy:!0,hidden:!T&&!B,size:"xl"}]),[B,R]),z=[];R&&z.push({name:(0,C.tZ)(o.Fragment,null,(0,C.tZ)("i",{className:"fa fa-plus"})," ",(0,l.t)("Annotation layer")),buttonStyle:"primary",onClick:()=>{N(null)}}),B&&z.push({name:(0,l.t)("Bulk select"),onClick:M,buttonStyle:"secondary"});const F=(0,o.useMemo)((()=>[{Header:(0,l.t)("Created by"),id:"created_by",input:"select",operator:b.p.relationOneMany,unfilteredLabel:"All",fetchSelects:(0,y.tm)("annotation_layer","created_by",(0,y.v$)((e=>(0,l.t)("An error occurred while fetching dataset datasource values: %s",e))),a),paginate:!0},{Header:(0,l.t)("Search"),id:"name",input:"search",operator:b.p.contains}]),[]),O=(0,C.tZ)(L.Z,{buttonStyle:"primary",onClick:()=>{N(null)}},(0,C.tZ)(o.Fragment,null,(0,C.tZ)("i",{className:"fa fa-plus"})," ",(0,l.t)("Annotation layer"))),V={message:(0,l.t)("No annotation layers yet"),slot:O};return(0,C.tZ)(o.Fragment,null,(0,C.tZ)(f.Z,{name:(0,l.t)("Annotation layers"),buttons:z}),(0,C.tZ)(w.Z,{addDangerToast:e,layer:G,onLayerAdd:e=>{window.location.href=`/annotationmodelview/${e}/annotation`},onHide:()=>{D(),k(!1)},show:U}),_&&(0,C.tZ)(v.Z,{description:(0,l.t)("This action will permanently delete the layer."),onConfirm:()=>{_&&(({id:a,name:n})=>{i.Z.delete({endpoint:`/api/v1/annotation_layer/${a}`}).then((()=>{D(),E(null),t((0,l.t)("Deleted: %s",n))}),(0,y.v$)((t=>e((0,l.t)("There was an issue deleting %s: %s",n,t)))))})(_)},onHide:()=>E(null),open:!0,title:(0,l.t)("Delete Layer?")}),(0,C.tZ)(Z.Z,{title:(0,l.t)("Please confirm"),description:(0,l.t)("Are you sure you want to delete the selected layers?"),onConfirm:a=>{i.Z.delete({endpoint:`/api/v1/annotation_layer/?q=${s().encode(a.map((({id:e})=>e)))}`}).then((({json:e={}})=>{D(),t(e.message)}),(0,y.v$)((t=>e((0,l.t)("There was an issue deleting the selected layers: %s",t)))))}},(e=>{const t=B?[{key:"delete",name:(0,l.t)("Delete"),onSelect:e,type:"danger"}]:[];return(0,C.tZ)(b.Z,{className:"annotation-layers-list-view",columns:P,count:r,data:u,fetchData:x,filters:F,initialSort:Y,loading:n,pageSize:25,bulkActions:t,bulkSelectEnabled:g,disableBulkSelect:M,emptyState:V})})))}H(S,"useListViewResource{{ state: { loading, resourceCount: layersCount, resourceCollection: layers, bulkSelectEnabled, }, hasPerm, fetchData, refreshData, toggleBulkSelect, }}\nuseState{[annotationLayerModalOpen, setAnnotationLayerModalOpen](false)}\nuseState{[currentAnnotationLayer, setCurrentAnnotationLayer](null)}\nuseState{[layerCurrentlyDeleting, setLayerCurrentlyDeleting](null)}\nuseMemo{columns}\nuseMemo{filters}",(()=>[m.Yi]));const x=(0,g.Z)(S),D=x;var M,U;(M="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(M.register(25,"PAGE_SIZE","/Users/chenming/superset/superset-frontend/src/views/CRUD/annotationlayers/AnnotationLayersList.tsx"),M.register(A,"MOMENT_FORMAT","/Users/chenming/superset/superset-frontend/src/views/CRUD/annotationlayers/AnnotationLayersList.tsx"),M.register(S,"AnnotationLayersList","/Users/chenming/superset/superset-frontend/src/views/CRUD/annotationlayers/AnnotationLayersList.tsx"),M.register(x,"default","/Users/chenming/superset/superset-frontend/src/views/CRUD/annotationlayers/AnnotationLayersList.tsx")),(U="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&U(e)}}]);