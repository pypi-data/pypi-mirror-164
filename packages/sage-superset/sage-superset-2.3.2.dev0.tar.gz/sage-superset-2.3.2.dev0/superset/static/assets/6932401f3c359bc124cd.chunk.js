"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[4152],{164152:(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _emotion_react__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(211965),rison__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(115926),rison__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(rison__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(667294),prop_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(45697),prop_types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__),src_components_Radio__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(287183),src_components_Card__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(657011),src_components_Alert__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(229487),src_components_Badge__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(782607),shortid__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(714670),shortid__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(shortid__WEBPACK_IMPORTED_MODULE_7__),_superset_ui_core__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(751995),_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(455867),_superset_ui_core__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(431069),_superset_ui_core__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(468135),src_components__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(104715),src_components_Form__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(558347),src_components_Button__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(835932),src_components_Tabs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(940637),src_components_CertifiedBadge__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(679789),src_components_WarningIconWithTooltip__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(486057),src_components_DatabaseSelector__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(73995),src_components_Label__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(737921),src_components_Loading__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(838703),src_components_TableSelector__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(517982),src_components_EditableTitle__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(138270),src_utils_getClientErrorObject__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(998286),src_explore_components_controls_CheckboxControl__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(379069),src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(979684),src_explore_components_controls_TextAreaControl__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(542878),src_explore_components_controls_SpatialControl__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(100665),src_components_MessageToasts_withToasts__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(414114),src_featureFlags__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(591877),src_components_Icons__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(87693),_CollectionTable__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(148120),_Fieldset__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(209989),_Field__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(131743),enterModule;function _EMOTION_STRINGIFIED_CSS_ERROR__(){return"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."}module=__webpack_require__.hmd(module),enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(_){return _};const DatasourceContainer=_superset_ui_core__WEBPACK_IMPORTED_MODULE_30__.iK.div`
  .change-warning {
    margin: 16px 10px 0;
    color: ${({theme:_})=>_.colors.warning.base};
  }

  .change-warning .bold {
    font-weight: ${({theme:_})=>_.typography.weights.bold};
  }

  .form-group.has-feedback > .help-block {
    margin-top: 8px;
  }

  .form-group.form-group-md {
    margin-bottom: 8px;
  }
`,FlexRowContainer=_superset_ui_core__WEBPACK_IMPORTED_MODULE_30__.iK.div`
  align-items: center;
  display: flex;

  svg {
    margin-right: ${({theme:_})=>_.gridUnit}px;
  }
`,StyledTableTabs=(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_30__.iK)(src_components_Tabs__WEBPACK_IMPORTED_MODULE_11__.ZP)`
  overflow: visible;
  .ant-tabs-content-holder {
    overflow: visible;
  }
`,StyledBadge=(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_30__.iK)(src_components_Badge__WEBPACK_IMPORTED_MODULE_6__.Z)`
  .ant-badge-count {
    line-height: ${({theme:_})=>4*_.gridUnit}px;
    height: ${({theme:_})=>4*_.gridUnit}px;
    margin-left: ${({theme:_})=>_.gridUnit}px;
  }
`,EditLockContainer=_superset_ui_core__WEBPACK_IMPORTED_MODULE_30__.iK.div`
  font-size: ${({theme:_})=>_.typography.sizes.s}px;
  display: flex;
  align-items: center;
  a {
    padding: 0 10px;
  }
`,ColumnButtonWrapper=_superset_ui_core__WEBPACK_IMPORTED_MODULE_30__.iK.div`
  text-align: right;
  ${({theme:_})=>`margin-bottom: ${2*_.gridUnit}px`}
`,StyledLabelWrapper=_superset_ui_core__WEBPACK_IMPORTED_MODULE_30__.iK.div`
  display: flex;
  align-items: center;
  span {
    margin-right: ${({theme:_})=>_.gridUnit}px;
  }
`,StyledColumnsTabWrapper=_superset_ui_core__WEBPACK_IMPORTED_MODULE_30__.iK.div`
  .table > tbody > tr > td {
    vertical-align: middle;
  }

  .ant-tag {
    margin-top: ${({theme:_})=>_.gridUnit}px;
  }
`,checkboxGenerator=(_,e)=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_CheckboxControl__WEBPACK_IMPORTED_MODULE_20__.Z,{value:_,onChange:e}),DATA_TYPES=[{value:"STRING",label:"STRING"},{value:"NUMERIC",label:"NUMERIC"},{value:"DATETIME",label:"DATETIME"},{value:"BOOLEAN",label:"BOOLEAN"}],DATASOURCE_TYPES_ARR=[{key:"physical",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Physical (table or view)")},{key:"virtual",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Virtual (SQL)")}],DATASOURCE_TYPES={};DATASOURCE_TYPES_ARR.forEach((_=>{DATASOURCE_TYPES[_.key]=_}));var _ref={name:"s5xdrg",styles:"display:flex;align-items:center"};function CollectionTabTitle({title:_,collection:e}){return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",{css:_ref,"data-test":`collection-tab-${_}`},_," ",(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(StyledBadge,{count:e?e.length:0,showZero:!0}))}function ColumnCollectionTable({columns:_,datasource:e,onColumnsChange:t,onDatasourceChange:o,editableColumnName:r,showExpression:a,allowAddItem:n,allowEditDataType:s,itemGenerator:i}){return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_CollectionTable__WEBPACK_IMPORTED_MODULE_27__.Z,{collection:_,tableColumns:["column_name","type","is_dttm","main_dttm_col","filterable","groupby"],sortColumns:["column_name","type","is_dttm","main_dttm_col","filterable","groupby"],allowDeletes:!0,allowAddItem:n,itemGenerator:i,stickyHeader:!0,expandFieldset:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(FormContainer,null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Fieldset__WEBPACK_IMPORTED_MODULE_28__.Z,{compact:!0},a&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"expression",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("SQL expression"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextAreaControl__WEBPACK_IMPORTED_MODULE_22__.Z,{language:"markdown",offerEditInModal:!1})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"verbose_name",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Label"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"verbose_name",placeholder:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Label")})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"description",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Description"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"description",placeholder:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Description")})}),s&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"type",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Data type"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components__WEBPACK_IMPORTED_MODULE_8__.Ph,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Data type"),options:DATA_TYPES,name:"type",allowNewOptions:!0,allowClear:!0})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"python_date_format",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Datetime format"),description:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",null,(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("The pattern of timestamp format. For strings use "),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("a",{href:"https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior"},(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Python datetime string pattern")),(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)(" expression which needs to adhere to the "),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("a",{href:"https://en.wikipedia.org/wiki/ISO_8601"},(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("ISO 8601")),(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)(" standard to ensure that the lexicographical ordering\n                      coincides with the chronological ordering. If the\n                      timestamp format does not adhere to the ISO 8601 standard\n                      you will need to define an expression and type for\n                      transforming the string into a date or timestamp. Note\n                      currently time zones are not supported. If time is stored\n                      in epoch format, put `epoch_s` or `epoch_ms`. If no pattern\n                      is specified we fall back to using the optional defaults on a per\n                      database/column name level via the extra parameter.")),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"python_date_format",placeholder:"%Y/%m/%d"})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"certified_by",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Certified By"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Person or group that has certified this metric"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"certified",placeholder:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Certified by")})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"certification_details",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Certification details"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Details of the certification"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"certificationDetails",placeholder:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Certification details")})}))),columnLabels:{column_name:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Column"),type:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Data type"),groupby:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Is dimension"),is_dttm:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Is temporal"),main_dttm_col:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Default datetime"),filterable:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Is filterable")},onChange:t,itemRenderers:{column_name:(_,e,t,o)=>r?(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(StyledLabelWrapper,null,o.is_certified&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_CertifiedBadge__WEBPACK_IMPORTED_MODULE_12__.Z,{certifiedBy:o.certified_by,details:o.certification_details}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{value:_,onChange:e})):(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(StyledLabelWrapper,null,o.is_certified&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_CertifiedBadge__WEBPACK_IMPORTED_MODULE_12__.Z,{certifiedBy:o.certified_by,details:o.certification_details}),_),main_dttm_col:(t,r,a,n)=>{const s=e.main_dttm_col===n.column_name,i=!_.find((_=>_.column_name===n.column_name)).is_dttm;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Radio__WEBPACK_IMPORTED_MODULE_3__.Y,{"data-test":`radio-default-dttm-${n.column_name}`,checked:s,disabled:i,onChange:()=>o({...e,main_dttm_col:n.column_name})})},type:_=>_?(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Label__WEBPACK_IMPORTED_MODULE_15__.Z,null,_):null,is_dttm:checkboxGenerator,filterable:checkboxGenerator,groupby:checkboxGenerator}})}function StackedField({label:_,formElement:e}){return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("strong",null,_)),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",null,e))}function FormContainer({children:_}){return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Card__WEBPACK_IMPORTED_MODULE_4__.Z,{padded:!0},_)}CollectionTabTitle.propTypes={title:prop_types__WEBPACK_IMPORTED_MODULE_2___default().string,collection:prop_types__WEBPACK_IMPORTED_MODULE_2___default().array},ColumnCollectionTable.propTypes={columns:prop_types__WEBPACK_IMPORTED_MODULE_2___default().array.isRequired,datasource:prop_types__WEBPACK_IMPORTED_MODULE_2___default().object.isRequired,onColumnsChange:prop_types__WEBPACK_IMPORTED_MODULE_2___default().func.isRequired,onDatasourceChange:prop_types__WEBPACK_IMPORTED_MODULE_2___default().func.isRequired,editableColumnName:prop_types__WEBPACK_IMPORTED_MODULE_2___default().bool,showExpression:prop_types__WEBPACK_IMPORTED_MODULE_2___default().bool,allowAddItem:prop_types__WEBPACK_IMPORTED_MODULE_2___default().bool,allowEditDataType:prop_types__WEBPACK_IMPORTED_MODULE_2___default().bool,itemGenerator:prop_types__WEBPACK_IMPORTED_MODULE_2___default().func},ColumnCollectionTable.defaultProps={editableColumnName:!1,showExpression:!1,allowAddItem:!1,allowEditDataType:!1,itemGenerator:()=>({column_name:"<new column>",filterable:!0,groupby:!0})},StackedField.propTypes={label:prop_types__WEBPACK_IMPORTED_MODULE_2___default().string,formElement:prop_types__WEBPACK_IMPORTED_MODULE_2___default().node},FormContainer.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_2___default().node};const propTypes={datasource:prop_types__WEBPACK_IMPORTED_MODULE_2___default().object.isRequired,onChange:prop_types__WEBPACK_IMPORTED_MODULE_2___default().func,addSuccessToast:prop_types__WEBPACK_IMPORTED_MODULE_2___default().func.isRequired,addDangerToast:prop_types__WEBPACK_IMPORTED_MODULE_2___default().func.isRequired},defaultProps={onChange:()=>{}};function OwnersSelector({datasource:_,onChange:e}){const t=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(((_="",e,t)=>{const o=rison__WEBPACK_IMPORTED_MODULE_0___default().encode({filter:_,page:e,page_size:t});return _superset_ui_core__WEBPACK_IMPORTED_MODULE_33__.Z.get({endpoint:`/api/v1/dataset/related/owners?q=${o}`}).then((_=>({data:_.json.result.map((_=>({value:_.value,label:_.text}))),totalCount:_.json.count})))}),[]);return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components__WEBPACK_IMPORTED_MODULE_8__.Ph,{ariaLabel:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Select owners"),mode:"multiple",name:"owners",value:_.owners,options:t,onChange:e,header:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Form__WEBPACK_IMPORTED_MODULE_9__.lX,null,(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Owners")),allowClear:!0})}__signature__(OwnersSelector,"useCallback{loadOptions}");var _ref2={name:"hkh81z",styles:"margin-top:8px"},_ref3={name:"hkh81z",styles:"margin-top:8px"};class DatasourceEditor extends react__WEBPACK_IMPORTED_MODULE_1__.PureComponent{constructor(_){var e;super(_),this.state={datasource:{..._.datasource,owners:_.datasource.owners.map((_=>({value:_.value||_.id,label:_.label||`${_.first_name} ${_.last_name}`}))),metrics:null==(e=_.datasource.metrics)?void 0:e.map((_=>{const{certified_by:e,certification_details:t}=_,{certification:{details:o,certified_by:r}={},warning_markdown:a}=JSON.parse(_.extra||"{}")||{};return{..._,certification_details:t||o,warning_markdown:a||"",certified_by:r||e}}))},errors:[],isDruid:"druid"===_.datasource.type||"druid"===_.datasource.datasource_type,isSqla:"table"===_.datasource.datasource_type||"table"===_.datasource.type,isEditMode:!1,databaseColumns:_.datasource.columns.filter((_=>!_.expression)),calculatedColumns:_.datasource.columns.filter((_=>!!_.expression)),metadataLoading:!1,activeTabKey:0,datasourceType:_.datasource.sql?DATASOURCE_TYPES.virtual.key:DATASOURCE_TYPES.physical.key},this.onChange=this.onChange.bind(this),this.onChangeEditMode=this.onChangeEditMode.bind(this),this.onDatasourcePropChange=this.onDatasourcePropChange.bind(this),this.onDatasourceChange=this.onDatasourceChange.bind(this),this.tableChangeAndSyncMetadata=this.tableChangeAndSyncMetadata.bind(this),this.syncMetadata=this.syncMetadata.bind(this),this.setColumns=this.setColumns.bind(this),this.validateAndChange=this.validateAndChange.bind(this),this.handleTabSelect=this.handleTabSelect.bind(this),this.allowEditSource=!(0,src_featureFlags__WEBPACK_IMPORTED_MODULE_25__.cr)(src_featureFlags__WEBPACK_IMPORTED_MODULE_25__.TT.DISABLE_DATASET_SOURCE_EDIT)}onChange(){const{datasourceType:_,datasource:e}=this.state,t=_===DATASOURCE_TYPES.physical.key?"":e.sql,o={...this.state.datasource,sql:t,columns:[...this.state.databaseColumns,...this.state.calculatedColumns]};this.props.onChange(o,this.state.errors)}onChangeEditMode(){this.setState((_=>({isEditMode:!_.isEditMode})))}onDatasourceChange(_,e=this.validateAndChange){this.setState({datasource:_},e)}onDatasourcePropChange(_,e){if(void 0===e)return;const t={...this.state.datasource,[_]:e};this.setState((t=>({datasource:{...t.datasource,[_]:e}})),"table_name"===_?this.onDatasourceChange(t,this.tableChangeAndSyncMetadata):this.onDatasourceChange(t,this.validateAndChange))}onDatasourceTypeChange(_){this.setState({datasourceType:_})}setColumns(_){this.setState(_,this.validateAndChange)}validateAndChange(){this.validate(this.onChange)}tableChangeAndSyncMetadata(){this.validate((()=>{this.syncMetadata(),this.onChange()}))}updateColumns(_){const{databaseColumns:e}=this.state,t=_.map((_=>_.name)),o=e.reduce(((_,e)=>({..._,[e.column_name]:e})),{}),r=[],a={added:[],modified:[],removed:e.map((_=>_.column_name)).filter((_=>!t.includes(_)))};return _.forEach((_=>{const e=o[_.name];e?e.type!==_.type||!e.is_dttm&&_.is_dttm?(r.push({...e,type:_.type,is_dttm:e.is_dttm||_.is_dttm}),a.modified.push(_.name)):r.push(e):(r.push({id:shortid__WEBPACK_IMPORTED_MODULE_7___default().generate(),column_name:_.name,type:_.type,groupby:!0,filterable:!0,is_dttm:_.is_dttm}),a.added.push(_.name))})),(a.added.length||a.modified.length||a.removed.length)&&this.setColumns({databaseColumns:r}),a}syncMetadata(){const{datasource:_}=this.state,e={datasource_type:_.type||_.datasource_type,database_name:_.database.database_name||_.database.name,schema_name:_.schema,table_name:_.table_name};Object.entries(e).forEach((([_,t])=>{void 0===t&&(e[_]=null)}));const t=`/datasource/external_metadata_by_name/?q=${rison__WEBPACK_IMPORTED_MODULE_0___default().encode(e)}`;this.setState({metadataLoading:!0}),_superset_ui_core__WEBPACK_IMPORTED_MODULE_33__.Z.get({endpoint:t}).then((({json:_})=>{const e=this.updateColumns(_);e.modified.length&&this.props.addSuccessToast((0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Modified columns: %s",e.modified.join(", "))),e.removed.length&&this.props.addSuccessToast((0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Removed columns: %s",e.removed.join(", "))),e.added.length&&this.props.addSuccessToast((0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("New columns added: %s",e.added.join(", "))),this.props.addSuccessToast((0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Metadata has been synced")),this.setState({metadataLoading:!1})})).catch((_=>(0,src_utils_getClientErrorObject__WEBPACK_IMPORTED_MODULE_19__.O)(_).then((({error:_,statusText:e})=>{this.props.addDangerToast(_||e||(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("An error has occurred")),this.setState({metadataLoading:!1})}))))}findDuplicates(_,e){const t={},o=[];return _.forEach((_=>{const r=e(_);r in t?o.push(r):t[r]=null})),o}validate(_){let e,t=[];const{datasource:o}=this.state;e=this.findDuplicates(o.columns,(_=>_.column_name)),t=t.concat(e.map((_=>(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Column name [%s] is duplicated",_)))),e=this.findDuplicates(o.metrics,(_=>_.metric_name)),t=t.concat(e.map((_=>(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Metric name [%s] is duplicated",_))));const r=this.state.calculatedColumns.filter((_=>!_.expression&&!_.json));t=t.concat(r.map((_=>(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Calculated column [%s] requires an expression",_.column_name)))),this.setState({errors:t},_)}handleTabSelect(_){this.setState({activeTabKey:_})}sortMetrics(_){return _.sort((({id:_},{id:e})=>e-_))}renderSettingsFieldset(){const{datasource:_}=this.state;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Fieldset__WEBPACK_IMPORTED_MODULE_28__.Z,{title:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Basic"),item:_,onChange:this.onDatasourceChange},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"description",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Description"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextAreaControl__WEBPACK_IMPORTED_MODULE_22__.Z,{language:"markdown",offerEditInModal:!1})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"default_endpoint",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Default URL"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Default URL to redirect to when accessing from the dataset list page"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"default_endpoint"})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{inline:!0,fieldKey:"filter_select_enabled",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Autocomplete filters"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Whether to populate autocomplete filters options"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_CheckboxControl__WEBPACK_IMPORTED_MODULE_20__.Z,null)}),this.state.isSqla&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"fetch_values_predicate",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Autocomplete query predicate"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)('When using "Autocomplete filters", this can be used to improve performance of the query fetching the values. Use this option to apply a predicate (WHERE clause) to the query selecting the distinct values from the table. Typically the intent would be to limit the scan by applying a relative time filter on a partitioned or indexed time-related field.'),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextAreaControl__WEBPACK_IMPORTED_MODULE_22__.Z,{language:"sql",controlId:"fetch_values_predicate",minLines:5})}),this.state.isSqla&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"extra",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Extra"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)('Extra data to specify table metadata. Currently supports metadata of the format: `{ "certification": { "certified_by": "Data Platform Team", "details": "This table is the source of truth." }, "warning_markdown": "This is a warning." }`.'),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextAreaControl__WEBPACK_IMPORTED_MODULE_22__.Z,{controlId:"extra",language:"json",offerEditInModal:!1})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(OwnersSelector,{datasource:_,onChange:e=>{this.onDatasourceChange({..._,owners:e})}}))}renderAdvancedFieldset(){const{datasource:_}=this.state;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Fieldset__WEBPACK_IMPORTED_MODULE_28__.Z,{title:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Advanced"),item:_,onChange:this.onDatasourceChange},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"cache_timeout",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Cache timeout"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("The duration of time in seconds before the cache is invalidated"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"cache_timeout"})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"offset",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Hours offset"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"offset"}),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("The number of hours, negative or positive, to shift the time column. This can be used to move UTC time to local time.")}),this.state.isSqla&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"template_params",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Template parameters"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("A set of parameters that become available in the query using Jinja templating syntax"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"template_params"})}))}renderSpatialTab(){const{datasource:_}=this.state,{spatials:e,all_cols:t}=_;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Tabs__WEBPACK_IMPORTED_MODULE_11__.ZP.TabPane,{tab:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(CollectionTabTitle,{collection:e,title:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Spatial")}),key:4},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_CollectionTable__WEBPACK_IMPORTED_MODULE_27__.Z,{tableColumns:["name","config"],onChange:this.onDatasourcePropChange.bind(this,"spatials"),itemGenerator:()=>({name:"<new spatial>",type:"<no type>",config:null}),collection:e,allowDeletes:!0,itemRenderers:{name:(_,e)=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_EditableTitle__WEBPACK_IMPORTED_MODULE_18__.Z,{canEdit:!0,title:_,onSaveTitle:e}),config:(_,e)=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_SpatialControl__WEBPACK_IMPORTED_MODULE_23__.Z,{value:_,onChange:e,choices:t})}}))}renderSourceFieldset(_){const{datasource:e}=this.state;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",null,this.allowEditSource&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(EditLockContainer,null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("span",{role:"button",tabIndex:0,onClick:this.onChangeEditMode},this.state.isEditMode?(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Icons__WEBPACK_IMPORTED_MODULE_26__.Z.LockUnlocked,{iconColor:_.colors.grayscale.base}):(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Icons__WEBPACK_IMPORTED_MODULE_26__.Z.LockLocked,{iconColor:_.colors.grayscale.base})),!this.state.isEditMode&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",null,(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Click the lock to make changes.")),this.state.isEditMode&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",null,(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Click the lock to prevent further changes."))),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",{className:"m-l-10 m-t-20 m-b-10"},DATASOURCE_TYPES_ARR.map((_=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Radio__WEBPACK_IMPORTED_MODULE_3__.Y,{key:_.key,value:_.key,inline:!0,onChange:this.onDatasourceTypeChange.bind(this,_.key),checked:this.state.datasourceType===_.key,disabled:!this.state.isEditMode},_.label)))),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("hr",null),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Fieldset__WEBPACK_IMPORTED_MODULE_28__.Z,{item:e,onChange:this.onDatasourceChange,compact:!0},this.state.datasourceType===DATASOURCE_TYPES.virtual.key&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",null,this.state.isSqla&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment,null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components__WEBPACK_IMPORTED_MODULE_8__.JX,{xs:24,md:12},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"databaseSelector",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("virtual"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",{css:_ref2},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_DatabaseSelector__WEBPACK_IMPORTED_MODULE_14__.Z,{db:null==e?void 0:e.database,schema:e.schema,onSchemaChange:_=>this.state.isEditMode&&this.onDatasourcePropChange("schema",_),onDbChange:_=>this.state.isEditMode&&this.onDatasourcePropChange("database",_),formMode:!1,handleError:this.props.addDangerToast,readOnly:!this.state.isEditMode}))}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",{css:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.iv)({width:"calc(100% - 34px)",marginTop:-16},"","")},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"table_name",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Dataset name"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"table_name",onChange:_=>{this.onDatasourcePropChange("table_name",_)},placeholder:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Dataset name"),disabled:!this.state.isEditMode})}))),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"sql",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("SQL"),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("When specifying SQL, the datasource acts as a view. Superset will use this statement as a subquery while grouping and filtering on the generated parent queries."),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextAreaControl__WEBPACK_IMPORTED_MODULE_22__.Z,{language:"sql",offerEditInModal:!1,minLines:20,maxLines:20,readOnly:!this.state.isEditMode})})),this.state.isDruid&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"json",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("JSON"),description:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",null,(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("The JSON metric or post aggregation definition.")),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextAreaControl__WEBPACK_IMPORTED_MODULE_22__.Z,{language:"json",offerEditInModal:!1})})),this.state.datasourceType===DATASOURCE_TYPES.physical.key&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components__WEBPACK_IMPORTED_MODULE_8__.JX,{xs:24,md:12},this.state.isSqla&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"tableSelector",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Physical"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",{css:_ref3},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_TableSelector__WEBPACK_IMPORTED_MODULE_17__.Z,{clearable:!1,database:{...e.database,database_name:e.database.database_name||e.database.name},dbId:e.database.id,handleError:this.props.addDangerToast,schema:e.schema,sqlLabMode:!1,tableName:e.table_name,onSchemaChange:this.state.isEditMode?_=>this.onDatasourcePropChange("schema",_):void 0,onDbChange:this.state.isEditMode?_=>this.onDatasourcePropChange("database",_):void 0,onTableChange:this.state.isEditMode?_=>this.onDatasourcePropChange("table_name",_):void 0,readOnly:!this.state.isEditMode})),description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("The pointer to a physical table (or view). Keep in mind that the chart is associated to this Superset logical table, and this logical table points the physical table referenced here.")}))))}renderErrors(){return this.state.errors.length>0?(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Alert__WEBPACK_IMPORTED_MODULE_5__.Z,{css:_=>({marginBottom:4*_.gridUnit}),type:"error",message:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment,null,this.state.errors.map((_=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("div",{key:_},_))))}):null}renderMetricCollection(){const{datasource:_}=this.state,{metrics:e}=_,t=null!=e&&e.length?this.sortMetrics(e):[];return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_CollectionTable__WEBPACK_IMPORTED_MODULE_27__.Z,{tableColumns:["metric_name","verbose_name","expression"],sortColumns:["metric_name","verbose_name","expression"],columnLabels:{metric_name:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Metric"),verbose_name:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Label"),expression:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("SQL expression")},expandFieldset:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(FormContainer,null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Fieldset__WEBPACK_IMPORTED_MODULE_28__.Z,{compact:!0},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"description",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Description"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"description",placeholder:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Description")})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{fieldKey:"d3format",label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("D3 format"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"d3format",placeholder:"%y/%m/%d"})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Certified by"),fieldKey:"certified_by",description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Person or group that has certified this metric"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"certified_by",placeholder:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Certified by")})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Certification details"),fieldKey:"certification_details",description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Details of the certification"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{controlId:"certification_details",placeholder:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Certification details")})}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(_Field__WEBPACK_IMPORTED_MODULE_29__.Z,{label:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Warning"),fieldKey:"warning_markdown",description:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Optional warning about use of this metric"),control:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextAreaControl__WEBPACK_IMPORTED_MODULE_22__.Z,{controlId:"warning_markdown",language:"markdown",offerEditInModal:!1})}))),collection:t,allowAddItem:!0,onChange:this.onDatasourcePropChange.bind(this,"metrics"),itemGenerator:()=>({metric_name:"<new metric>",verbose_name:"",expression:""}),itemRenderers:{metric_name:(_,e,t,o)=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(FlexRowContainer,null,o.is_certified&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_CertifiedBadge__WEBPACK_IMPORTED_MODULE_12__.Z,{certifiedBy:o.certified_by,details:o.certification_details}),o.warning_markdown&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_WarningIconWithTooltip__WEBPACK_IMPORTED_MODULE_13__.Z,{warningMarkdown:o.warning_markdown}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_EditableTitle__WEBPACK_IMPORTED_MODULE_18__.Z,{canEdit:!0,title:_,onSaveTitle:e})),verbose_name:(_,e)=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{canEdit:!0,value:_,onChange:e}),expression:(_,e)=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextAreaControl__WEBPACK_IMPORTED_MODULE_22__.Z,{canEdit:!0,initialValue:_,onChange:e,extraClasses:["datasource-sql-expression"],language:"sql",offerEditInModal:!1,minLines:5}),description:(_,e,t)=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(StackedField,{label:t,formElement:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{value:_,onChange:e})}),d3format:(_,e,t)=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(StackedField,{label:t,formElement:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_explore_components_controls_TextControl__WEBPACK_IMPORTED_MODULE_21__.Z,{value:_,onChange:e})})},allowDeletes:!0,stickyHeader:!0})}render(){const{datasource:_,activeTabKey:e}=this.state,{metrics:t}=_,o=null!=t&&t.length?this.sortMetrics(t):[],{theme:r}=this.props;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(DatasourceContainer,null,this.renderErrors(),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Alert__WEBPACK_IMPORTED_MODULE_5__.Z,{css:_=>({marginBottom:4*_.gridUnit}),type:"warning",message:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment,null," ",(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("strong",null,(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Be careful.")," "),(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Changing these settings will affect all charts using this dataset, including charts owned by other people."))}),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(StyledTableTabs,{fullWidth:!1,id:"table-tabs","data-test":"edit-dataset-tabs",onChange:this.handleTabSelect,defaultActiveKey:e},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Tabs__WEBPACK_IMPORTED_MODULE_11__.ZP.TabPane,{key:0,tab:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Source")},this.renderSourceFieldset(r)),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Tabs__WEBPACK_IMPORTED_MODULE_11__.ZP.TabPane,{tab:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(CollectionTabTitle,{collection:o,title:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Metrics")}),key:1},this.renderMetricCollection()),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Tabs__WEBPACK_IMPORTED_MODULE_11__.ZP.TabPane,{tab:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(CollectionTabTitle,{collection:this.state.databaseColumns,title:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Columns")}),key:2},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(StyledColumnsTabWrapper,null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(ColumnButtonWrapper,null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("span",{className:"m-t-10 m-r-10"},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Button__WEBPACK_IMPORTED_MODULE_10__.Z,{buttonSize:"small",buttonStyle:"tertiary",onClick:this.syncMetadata,className:"sync-from-source",disabled:this.state.isEditMode},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)("i",{className:"fa fa-database"})," ",(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Sync columns from source")))),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(ColumnCollectionTable,{className:"columns-table",columns:this.state.databaseColumns,datasource:_,onColumnsChange:_=>this.setColumns({databaseColumns:_}),onDatasourceChange:this.onDatasourceChange}),this.state.metadataLoading&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Loading__WEBPACK_IMPORTED_MODULE_16__.Z,null))),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Tabs__WEBPACK_IMPORTED_MODULE_11__.ZP.TabPane,{tab:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(CollectionTabTitle,{collection:this.state.calculatedColumns,title:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Calculated columns")}),key:3},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(StyledColumnsTabWrapper,null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(ColumnCollectionTable,{columns:this.state.calculatedColumns,onColumnsChange:_=>this.setColumns({calculatedColumns:_}),onDatasourceChange:this.onDatasourceChange,datasource:_,editableColumnName:!0,showExpression:!0,allowAddItem:!0,allowEditDataType:!0,itemGenerator:()=>({column_name:"<new column>",filterable:!0,groupby:!0,expression:"<enter SQL expression here>",__expanded:!0})}))),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components_Tabs__WEBPACK_IMPORTED_MODULE_11__.ZP.TabPane,{key:4,tab:(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_32__.t)("Settings")},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components__WEBPACK_IMPORTED_MODULE_8__.X2,{gutter:16},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components__WEBPACK_IMPORTED_MODULE_8__.JX,{xs:24,md:12},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(FormContainer,null,this.renderSettingsFieldset())),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(src_components__WEBPACK_IMPORTED_MODULE_8__.JX,{xs:24,md:12},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_31__.tZ)(FormContainer,null,this.renderAdvancedFieldset()))))))}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}DatasourceEditor.defaultProps=defaultProps,DatasourceEditor.propTypes=propTypes;const DataSourceComponent=(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_34__.b)(DatasourceEditor),_default=(0,src_components_MessageToasts_withToasts__WEBPACK_IMPORTED_MODULE_24__.Z)(DataSourceComponent),__WEBPACK_DEFAULT_EXPORT__=_default;var reactHotLoader,leaveModule;reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&(reactHotLoader.register(DatasourceContainer,"DatasourceContainer","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(FlexRowContainer,"FlexRowContainer","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(StyledTableTabs,"StyledTableTabs","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(StyledBadge,"StyledBadge","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(EditLockContainer,"EditLockContainer","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(ColumnButtonWrapper,"ColumnButtonWrapper","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(StyledLabelWrapper,"StyledLabelWrapper","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(StyledColumnsTabWrapper,"StyledColumnsTabWrapper","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(checkboxGenerator,"checkboxGenerator","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(DATA_TYPES,"DATA_TYPES","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(DATASOURCE_TYPES_ARR,"DATASOURCE_TYPES_ARR","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(DATASOURCE_TYPES,"DATASOURCE_TYPES","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(CollectionTabTitle,"CollectionTabTitle","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(ColumnCollectionTable,"ColumnCollectionTable","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(StackedField,"StackedField","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(FormContainer,"FormContainer","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(propTypes,"propTypes","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(defaultProps,"defaultProps","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(OwnersSelector,"OwnersSelector","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(DatasourceEditor,"DatasourceEditor","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(DataSourceComponent,"DataSourceComponent","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"),reactHotLoader.register(_default,"default","/Users/chenming/superset/superset-frontend/src/components/Datasource/DatasourceEditor.jsx")),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)},578705:(_,e,t)=>{t.d(e,{F:()=>s});var o,r,a,n=t(667294);function s(_,e,t){return n.Children.map(_,(_=>{let o=_;return _&&_.type.name===e.name&&(o=n.cloneElement(_,t(_))),o&&o.props.children&&(o=n.cloneElement(o,{children:s(o.props.children,e,t)})),o}))}_=t.hmd(_),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&o(_),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature,(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&r.register(s,"recurseReactClone","/Users/chenming/superset/superset-frontend/src/components/Datasource/utils.js"),(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&a(_)},782607:(_,e,t)=>{t.d(e,{Z:()=>c}),t(667294);var o,r=t(751995),a=t(762529),n=t(211965);_=t.hmd(_),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&o(_),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const s=(0,r.iK)((({textColor:_,...e})=>(0,n.tZ)(a.Z,e)))`
  & > sup {
    padding: 0 ${({theme:_})=>2*_.gridUnit}px;
    background: ${({theme:_,color:e})=>e||_.colors.primary.base};
    color: ${({theme:_,textColor:e})=>e||_.colors.grayscale.light5};
  }
`,i=s,c=i;var l,E;(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(l.register(s,"Badge","/Users/chenming/superset/superset-frontend/src/components/Badge/index.tsx"),l.register(i,"default","/Users/chenming/superset/superset-frontend/src/components/Badge/index.tsx")),(E="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&E(_)},657011:(_,e,t)=>{t.d(e,{Z:()=>l});var o,r=t(205872),a=t.n(r),n=(t(667294),t(570302)),s=t(211965);_=t.hmd(_),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&o(_),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const i=({padded:_,...e})=>(0,s.tZ)(n.Z,a()({},e,{css:e=>({backgroundColor:e.colors.grayscale.light4,borderRadius:e.borderRadius,".ant-card-body":{padding:_?4*e.gridUnit:e.gridUnit}})})),c=i,l=c;var E,d;(E="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(E.register(i,"Card","/Users/chenming/superset/superset-frontend/src/components/Card/index.tsx"),E.register(c,"default","/Users/chenming/superset/superset-frontend/src/components/Card/index.tsx")),(d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&d(_)},679789:(_,e,t)=>{t.d(e,{Z:()=>d});var o,r=t(667294),a=t(455867),n=t(751995),s=t(87693),i=t(358593),c=t(211965);function l({certifiedBy:_,details:e,size:t="l"}){return(0,c.tZ)(i.u,{id:"certified-details-tooltip",title:(0,c.tZ)(r.Fragment,null,_&&(0,c.tZ)("div",null,(0,c.tZ)("strong",null,(0,a.t)("Certified by %s",_))),(0,c.tZ)("div",null,e))},(0,c.tZ)(s.Z.Certified,{iconColor:n.K6.colors.primary.base,iconSize:t}))}_=t.hmd(_),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&o(_),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const E=l,d=E;var u,D;(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(u.register(l,"CertifiedBadge","/Users/chenming/superset/superset-frontend/src/components/CertifiedBadge/index.tsx"),u.register(E,"default","/Users/chenming/superset/superset-frontend/src/components/CertifiedBadge/index.tsx")),(D="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&D(_)},148120:(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>CRUDCollection});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(667294),shortid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(714670),shortid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(shortid__WEBPACK_IMPORTED_MODULE_1__),_superset_ui_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(751995),_superset_ui_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(455867),src_components_Button__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(835932),src_components_Icons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(87693),_Fieldset__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(209989),_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(578705),_emotion_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(211965),enterModule;module=__webpack_require__.hmd(module),enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(_){return _},SortOrder;function createCollectionArray(_){return Object.keys(_).map((e=>_[e]))}function createKeyedCollection(_){const e=_.map((_=>({..._,id:_.id||shortid__WEBPACK_IMPORTED_MODULE_1___default().generate()}))),t={};return e.forEach((_=>{t[_.id]=_})),{collection:t,collectionArray:e}}!function(_){_[_.asc=1]="asc",_[_.desc=2]="desc",_[_.unsort=0]="unsort"}(SortOrder||(SortOrder={}));const CrudTableWrapper=_superset_ui_core__WEBPACK_IMPORTED_MODULE_6__.iK.div`
  ${({stickyHeader:_})=>_&&"\n      height: 350px;\n      overflow-y: auto;\n      overflow-x: auto;\n\n      .table {\n        min-width: 800px;\n      }\n      thead th {\n        background: #fff;\n        position: sticky;\n        top: 0;\n        z-index: 9;\n        min\n      }\n    "}
  th span {
    vertical-align: ${({theme:_})=>-2*_.gridUnit}px;
  }
`,CrudButtonWrapper=_superset_ui_core__WEBPACK_IMPORTED_MODULE_6__.iK.div`
  text-align: right;
  ${({theme:_})=>`margin-bottom: ${2*_.gridUnit}px`}
`;class CRUDCollection extends react__WEBPACK_IMPORTED_MODULE_0__.PureComponent{constructor(_){super(_);const{collection:e,collectionArray:t}=createKeyedCollection(_.collection);this.state={expandedColumns:{},collection:e,collectionArray:t,sortColumn:"",sort:0},this.renderItem=this.renderItem.bind(this),this.onAddItem=this.onAddItem.bind(this),this.renderExpandableSection=this.renderExpandableSection.bind(this),this.getLabel=this.getLabel.bind(this),this.onFieldsetChange=this.onFieldsetChange.bind(this),this.renderTableBody=this.renderTableBody.bind(this),this.changeCollection=this.changeCollection.bind(this),this.sortColumn=this.sortColumn.bind(this),this.renderSortIcon=this.renderSortIcon.bind(this)}UNSAFE_componentWillReceiveProps(_){if(_.collection!==this.props.collection){const{collection:e,collectionArray:t}=createKeyedCollection(_.collection);this.setState({collection:e,collectionArray:t})}}onCellChange(_,e,t){this.changeCollection({...this.state.collection,[_]:{...this.state.collection[_],[e]:t}})}onAddItem(){if(this.props.itemGenerator){let _=this.props.itemGenerator();_.id||(_={..._,id:shortid__WEBPACK_IMPORTED_MODULE_1___default().generate()}),this.changeCollection(this.state.collection,_)}}onFieldsetChange(_){this.changeCollection({...this.state.collection,[_.id]:_})}getLabel(_){const{columnLabels:e}=this.props;let t=e&&e[_]?e[_]:_;return t.startsWith("__")&&(t=""),t}changeCollection(_,e){if(this.setState({collection:_}),this.props.onChange){const t=this.state.collectionArray.map((e=>_[e.id])).filter((_=>void 0!==_));e&&t.unshift(e),this.props.onChange(t)}}deleteItem(_){const e={...this.state.collection};delete e[_],this.changeCollection(e)}effectiveTableColumns(){const{tableColumns:_,allowDeletes:e,expandFieldset:t}=this.props,o=e?_.concat(["__actions"]):_;return t?["__expand"].concat(o):o}toggleExpand(_){this.onCellChange(_,"__expanded",!1),this.setState((e=>({expandedColumns:{...e.expandedColumns,[_]:!e.expandedColumns[_]}})))}sortColumn(_,e=SortOrder.unsort){const{sortColumns:t}=this.props;return()=>{if(null!=t&&t.includes(_)){if(e===SortOrder.unsort){const{collection:_}=createKeyedCollection(this.props.collection),t=createCollectionArray(_);return void this.setState({collectionArray:t,sortColumn:"",sort:e})}const t=[...this.state.collectionArray].sort(((e,t)=>{return o=e[_],r=t[_],"string"==typeof o?(o||" ").localeCompare(r):o-r;var o,r})),o=e===SortOrder.asc?t:t.reverse();this.setState((t=>({...t,collectionArray:o,sortColumn:_,sort:e})))}}}renderSortIcon(_){return this.state.sortColumn===_&&this.state.sort===SortOrder.asc?(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)(src_components_Icons__WEBPACK_IMPORTED_MODULE_3__.Z.SortAsc,{onClick:this.sortColumn(_,2)}):this.state.sortColumn===_&&this.state.sort===SortOrder.desc?(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)(src_components_Icons__WEBPACK_IMPORTED_MODULE_3__.Z.SortDesc,{onClick:this.sortColumn(_,0)}):(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)(src_components_Icons__WEBPACK_IMPORTED_MODULE_3__.Z.Sort,{onClick:this.sortColumn(_,1)})}renderHeaderRow(){const _=this.effectiveTableColumns(),{allowDeletes:e,expandFieldset:t,extraButtons:o,sortColumns:r}=this.props;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("thead",null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("tr",null,t&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("th",{"aria-label":"Expand",className:"tiny-cell"}),_.map((_=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("th",{key:_},this.getLabel(_),(null==r?void 0:r.includes(_))&&this.renderSortIcon(_)))),o,e&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("th",{key:"delete-item","aria-label":"Delete",className:"tiny-cell"})))}renderExpandableSection(_){return(0,_utils__WEBPACK_IMPORTED_MODULE_5__.F)(this.props.expandFieldset,_Fieldset__WEBPACK_IMPORTED_MODULE_4__.Z,(()=>({item:_,onChange:this.onFieldsetChange})))}renderCell(_,e){const t=this.props.itemRenderers&&this.props.itemRenderers[e],o=_[e],r=this.onCellChange.bind(this,_.id,e);return t?t(o,r,this.getLabel(e),_):o}renderItem(_){const{allowAddItem:e,allowDeletes:t,expandFieldset:o,tableColumns:r}=this.props,a=!!this.state.expandedColumns[_.id]||_.__expanded;let n=[];o&&n.push((0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("td",{key:"__expand",className:"expand"},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("i",{role:"button","aria-label":"Toggle expand",tabIndex:0,className:`fa fa-caret-${a?"down":"right"} text-primary pointer`,onClick:this.toggleExpand.bind(this,_.id)}))),n=n.concat(r.map((e=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("td",{key:e},this.renderCell(_,e))))),e&&n.push((0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("td",{key:"add"})),t&&n.push((0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("td",{key:"__actions","data-test":"crud-delete-option",className:"text-primary"},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)(src_components_Icons__WEBPACK_IMPORTED_MODULE_3__.Z.Trash,{"aria-label":"Delete item",className:"pointer","data-test":"crud-delete-icon",role:"button",tabIndex:0,onClick:this.deleteItem.bind(this,_.id)})));const s=[(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("tr",{"data-test":"table-row",className:"row",key:_.id},n)];return a&&s.push((0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("tr",{className:"exp",key:`exp__${_.id}`},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("td",{colSpan:this.effectiveTableColumns().length,className:"expanded"},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("div",null,this.renderExpandableSection(_))))),s}renderEmptyCell(){return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("tr",null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("td",{className:"empty-collection"},this.props.emptyMessage))}renderTableBody(){const _=this.state.collectionArray,e=_.length?_.map((_=>this.renderItem(_))):this.renderEmptyCell();return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("tbody",{"data-test":"table-content-rows"},e)}render(){return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)(CrudButtonWrapper,null,this.props.allowAddItem&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("span",{className:"m-t-10 m-r-10"},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)(src_components_Button__WEBPACK_IMPORTED_MODULE_2__.Z,{buttonSize:"small",buttonStyle:"tertiary",onClick:this.onAddItem,"data-test":"add-item-button"},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("i",{"data-test":"crud-add-table-item",className:"fa fa-plus"})," ",(0,_superset_ui_core__WEBPACK_IMPORTED_MODULE_8__.t)("Add item")))),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)(CrudTableWrapper,{className:"CRUD",stickyHeader:this.props.stickyHeader},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_7__.tZ)("table",{"data-test":"crud-table",className:"table"},this.renderHeaderRow(),this.renderTableBody())))}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}var reactHotLoader,leaveModule;reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&(reactHotLoader.register(SortOrder,"SortOrder","/Users/chenming/superset/superset-frontend/src/components/Datasource/CollectionTable.tsx"),reactHotLoader.register(createCollectionArray,"createCollectionArray","/Users/chenming/superset/superset-frontend/src/components/Datasource/CollectionTable.tsx"),reactHotLoader.register(createKeyedCollection,"createKeyedCollection","/Users/chenming/superset/superset-frontend/src/components/Datasource/CollectionTable.tsx"),reactHotLoader.register(CrudTableWrapper,"CrudTableWrapper","/Users/chenming/superset/superset-frontend/src/components/Datasource/CollectionTable.tsx"),reactHotLoader.register(CrudButtonWrapper,"CrudButtonWrapper","/Users/chenming/superset/superset-frontend/src/components/Datasource/CollectionTable.tsx"),reactHotLoader.register(CRUDCollection,"CRUDCollection","/Users/chenming/superset/superset-frontend/src/components/Datasource/CollectionTable.tsx")),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)},131743:(_,e,t)=>{t.d(e,{Z:()=>l});var o,r=t(667294),a=t(211965),n=t(358593),s=t(558347);_=t.hmd(_),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&o(_);var i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(_){return _};const c=a.iv`
  .ant-form-item-control-input-content {
    display: flex;
    flex-direction: row;
  }
`;function l({fieldKey:_,value:e,label:t,description:o=null,control:i,onChange:l=(()=>{}),compact:E=!1,inline:d}){const u=(0,r.useCallback)((e=>{l(_,e)}),[l,_]),D=r.cloneElement(i,{value:e,onChange:u});return(0,a.tZ)(s.xJ,{label:(0,a.tZ)(s.lX,{className:"m-r-5"},t||_,E&&o&&(0,a.tZ)(n.u,{id:"field-descr",placement:"right",title:o},(0,a.tZ)("i",{className:"fa fa-info-circle m-l-5"}))),css:d&&c},D,!E&&o&&(0,a.tZ)("div",{css:_=>({color:_.colors.grayscale.base,[d?"marginLeft":"marginTop"]:_.gridUnit})},o))}var E,d;i(l,"useCallback{onControlChange}"),(E="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(E.register(c,"formItemInlineCss","/Users/chenming/superset/superset-frontend/src/components/Datasource/Field.tsx"),E.register(l,"Field","/Users/chenming/superset/superset-frontend/src/components/Datasource/Field.tsx")),(d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&d(_)},209989:(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>Fieldset});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(667294),src_components_Form__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(558347),_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(578705),_Field__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(131743),_emotion_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(211965),enterModule;module=__webpack_require__.hmd(module),enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(_){return _},reactHotLoader,leaveModule;class Fieldset extends react__WEBPACK_IMPORTED_MODULE_0__.PureComponent{constructor(_){super(_),this.onChange=this.onChange.bind(this)}onChange(_,e){return this.props.onChange({...this.props.item,[_]:e})}render(){const{title:_}=this.props;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_4__.tZ)(src_components_Form__WEBPACK_IMPORTED_MODULE_1__.l0,{className:"CRUD",layout:"vertical"},_&&(0,_emotion_react__WEBPACK_IMPORTED_MODULE_4__.tZ)("legend",null,_),(0,_utils__WEBPACK_IMPORTED_MODULE_2__.F)(this.props.children,_Field__WEBPACK_IMPORTED_MODULE_3__.Z,(_=>({onChange:this.onChange,value:this.props.item[_.props.fieldKey],compact:this.props.compact}))))}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}Fieldset.defaultProps={compact:!1,title:null},reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&reactHotLoader.register(Fieldset,"Fieldset","/Users/chenming/superset/superset-frontend/src/components/Datasource/Fieldset.tsx"),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)},138270:(_,e,t)=>{t.d(e,{Z:()=>D});var o,r=t(667294),a=t(294184),n=t.n(a),s=t(751995),i=t(455867),c=t(358593),l=t(679789),E=t(211965);_=t.hmd(_),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&o(_);var d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(_){return _};const u=(0,s.iK)(l.Z)`
  vertical-align: middle;
`;function D({canEdit:_=!1,editing:e=!1,extraClasses:t,multiLine:o=!1,noPermitTooltip:a,onSaveTitle:s,showTooltip:l=!0,style:d,title:D="",defaultTitle:p="",placeholder:M="",certifiedBy:P,certificationDetails:O}){const[m,C]=(0,r.useState)(e),[T,h]=(0,r.useState)(D),[L,A]=(0,r.useState)(D),[U,I]=(0,r.useState)(null),R=(0,r.useRef)();function b(){if(!_||m)return;const e=R.current?R.current.getBoundingClientRect():null;C(!0),I(e)}function B(){const e=T.trim();_&&(C(!1),e.length?(L!==e&&A(e),D!==e&&s(e)):h(L))}function K(_){" "===_.key&&_.stopPropagation(),"Enter"===_.key&&(_.preventDefault(),B())}function W(e){_&&h(e.target.value)}function f(_){"Enter"===_.key&&(_.preventDefault(),B())}let g;(0,r.useEffect)((()=>{D!==T&&(A(T),h(D))}),[D]),(0,r.useEffect)((()=>{if(m&&(R.current.focus(),R.current.setSelectionRange)){const{length:_}=R.current.value;R.current.setSelectionRange(_,_),R.current.scrollLeft=R.current.scrollWidth,R.current.scrollTop=R.current.scrollHeight}}),[m]),g=T,m||T||(g=p||D);const y=m&&U?{height:`${U.height}px`}:void 0;let Z=o&&m?(0,E.tZ)("textarea",{"data-test":"editable-title-input",ref:R,value:g,className:D?void 0:"text-muted",onKeyDown:K,onChange:W,onBlur:B,onClick:b,onKeyPress:f,placeholder:M,style:y}):(0,E.tZ)("input",{"data-test":"editable-title-input",ref:R,type:m?"text":"button",value:g,className:D?void 0:"text-muted",onKeyDown:K,onChange:W,onBlur:B,onClick:b,onKeyPress:f,placeholder:M});return l&&!m&&(Z=(0,E.tZ)(c.u,{id:"title-tooltip",title:_?(0,i.t)("Click to edit"):a||(0,i.t)("You don't have the rights to alter this title.")},Z)),_||(Z=(0,E.tZ)("span",{"data-test":"editable-title-input",title:g},g)),(0,E.tZ)("span",{"data-test":"editable-title",className:n()("editable-title",t,_&&"editable-title--editable",m&&"editable-title--editing"),style:d},P&&(0,E.tZ)(r.Fragment,null,(0,E.tZ)(u,{certifiedBy:P,details:O,size:"xl"})," "),Z)}var p,M;d(D,"useState{[isEditing, setIsEditing](editing)}\nuseState{[currentTitle, setCurrentTitle](title)}\nuseState{[lastTitle, setLastTitle](title)}\nuseState{[contentBoundingRect, setContentBoundingRect](null)}\nuseRef{contentRef}\nuseEffect{}\nuseEffect{}"),(p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(p.register(u,"StyledCertifiedBadge","/Users/chenming/superset/superset-frontend/src/components/EditableTitle/index.tsx"),p.register(D,"EditableTitle","/Users/chenming/superset/superset-frontend/src/components/EditableTitle/index.tsx")),(M="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&M(_)}}]);