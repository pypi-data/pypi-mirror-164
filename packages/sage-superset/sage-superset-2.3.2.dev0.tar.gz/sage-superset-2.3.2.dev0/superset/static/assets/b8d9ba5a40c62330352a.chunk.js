"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7299],{79816:(e,t,r)=>{var a;r.d(t,{Z:()=>n}),e=r.hmd(e),(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&a(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const o=function(e,t){let r,a;if(void 0===t)for(const t of e)null!=t&&(void 0===r?t>=t&&(r=a=t):(r>t&&(r=t),a<t&&(a=t)));else{let o=-1;for(let n of e)null!=(n=t(n,++o,e))&&(void 0===r?n>=n&&(r=a=n):(r>n&&(r=n),a<n&&(a=n)))}return[r,a]},n=o;var s,l;(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&s.register(o,"default","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-country-map/node_modules/d3-array/src/extent.js"),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&l(e)},920369:(e,t,r)=>{r.d(t,{Z:()=>m});var a,o=r(615078),n=r.n(o),s=r(45697),l=r.n(s),d=r(79816),i=r(767190),c=r(45511),u=r(756278);e=r.hmd(e),(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&a(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const p={data:l().arrayOf(l().shape({country_id:l().string,metric:l().number})),width:l().number,height:l().number,country:l().string,linearColorScheme:l().string,mapBaseUrl:l().string,numberFormat:l().string},f={};function _(e,t){const{data:r,width:a,height:o,country:s,linearColorScheme:l,numberFormat:p}=t,_=e,y=(0,i.JB)(p),m=(0,c.Z)().get(l).createLinearScale((0,d.Z)(r,(e=>e.metric))),g={};r.forEach((e=>{g[e.country_id]=m(e.metric)}));const h=e=>g[e.properties.ISO]||"none",b=n().geo.path(),v=n().select(_);v.classed("superset-legacy-chart-country-map",!0),v.selectAll("*").remove(),_.style.height=`${o}px`,_.style.width=`${a}px`;const L=v.append("svg:svg").attr("width",a).attr("height",o).attr("preserveAspectRatio","xMidYMid meet"),H=L.append("rect").attr("class","background").attr("width",a).attr("height",o),M=L.append("g"),G=M.append("g").classed("map-layer",!0),C=M.append("g").classed("text-layer",!0).attr("transform",`translate(${a/2}, 45)`),k=C.append("text").classed("big-text",!0),x=C.append("text").classed("result-text",!0).attr("dy","1em");let R;const E=function(e){const t=e&&R!==e;let r,n,s;const l=a/2,d=o/2;if(t){const t=b.centroid(e);[r,n]=t,s=4,R=e}else r=l,n=d,s=1,R=null;M.transition().duration(750).attr("transform",`translate(${l},${d})scale(${s})translate(${-r},${-n})`),C.style("opacity",0).attr("transform",`translate(0,0)translate(${r},${t?n-5:45})`).transition().duration(750).style("opacity",1),k.transition().duration(750).style("font-size",t?6:16),x.transition().duration(750).style("font-size",t?16:24)};H.on("click",E);const U=function(e){let t=h(e);"none"!==t&&(t=n().rgb(t).darker().toString()),n().select(this).style("fill",t),function(e){let t="";e&&e.properties&&(t=e.properties.ID_2?e.properties.NAME_2:e.properties.NAME_1),k.text(t)}(e);const a=r.filter((t=>t.country_id===e.properties.ISO));var o;(o=a).length>0&&x.text(y(o[0].metric))},w=function(){n().select(this).style("fill",h),k.text(""),x.text("")};function O(e){const{features:t}=e,r=n().geo.centroid(e),s=n().geo.mercator().scale(100).center(r).translate([a/2,o/2]);b.projection(s);const l=b.bounds(e),d=100*a/(l[1][0]-l[0][0]),i=100*o/(l[1][1]-l[0][1]),c=d<i?d:i;s.scale(c);const u=b.bounds(e);s.translate([a-(u[0][0]+u[1][0])/2,o-(u[0][1]+u[1][1])/2]),G.selectAll("path").data(t).enter().append("path").attr("d",b).attr("class","region").attr("vector-effect","non-scaling-stroke").style("fill",h).on("mouseenter",U).on("mouseout",w).on("click",E)}const P=f[s];if(P)O(P);else{const t=u.ZP[s];n().json(t,((t,r)=>{if(t){var a;const t=(null==(a=u.O$.find((e=>e[0]===s)))?void 0:a[1])||s;n().select(e).html(`<div class="alert alert-danger">Could not load map data for ${t}</div>`)}else f[s]=r,O(r)}))}}_.displayName="CountryMap",_.propTypes=p;const y=_,m=y;var g,h;(g="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(g.register(p,"propTypes","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-country-map/src/CountryMap.js"),g.register(f,"maps","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-country-map/src/CountryMap.js"),g.register(_,"CountryMap","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-country-map/src/CountryMap.js"),g.register(y,"default","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-country-map/src/CountryMap.js")),(h="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&h(e)},177299:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var a,o=r(943323),n=r(920369);e=r.hmd(e),(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&a(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const s=(0,o.Z)(n.Z),l=s;var d,i;(d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&d.register(s,"default","/Users/chenming/superset/superset-frontend/plugins/legacy-plugin-chart-country-map/src/ReactCountryMap.js"),(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&i(e)},943323:(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>reactify});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(667294),_emotion_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(211965),enterModule;module=__webpack_require__.hmd(module),enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},reactHotLoader,leaveModule;function reactify(renderFn,callbacks){class ReactifiedComponent extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(e){super(e),this.container=void 0,this.setContainerRef=this.setContainerRef.bind(this)}componentDidMount(){this.execute()}componentDidUpdate(){this.execute()}componentWillUnmount(){this.container=void 0,null!=callbacks&&callbacks.componentWillUnmount&&callbacks.componentWillUnmount.bind(this)()}setContainerRef(e){this.container=e}execute(){this.container&&renderFn(this.container,this.props)}render(){const{id:e,className:t}=this.props;return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_1__.tZ)("div",{ref:this.setContainerRef,id:e,className:t})}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}const ReactifiedClass=ReactifiedComponent;return renderFn.displayName&&(ReactifiedClass.displayName=renderFn.displayName),renderFn.propTypes&&(ReactifiedClass.propTypes={...ReactifiedClass.propTypes,...renderFn.propTypes}),renderFn.defaultProps&&(ReactifiedClass.defaultProps=renderFn.defaultProps),ReactifiedComponent}reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&reactHotLoader.register(reactify,"reactify","/Users/chenming/superset/superset-frontend/packages/superset-ui-core/src/chart/components/reactify.tsx"),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)}}]);