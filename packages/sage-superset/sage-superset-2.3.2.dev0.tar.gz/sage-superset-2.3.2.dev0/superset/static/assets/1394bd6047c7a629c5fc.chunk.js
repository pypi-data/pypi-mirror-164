"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[5656],{727989:(e,t,a)=>{a.d(t,{Z:()=>f});var s,r=a(667294),o=a(751995),n=a(455867),l=a(835932),i=a(574520),d=a(104715),u=a(34858),c=a(211965);e=a.hmd(e),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&s(e);var p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e};const m=o.iK.div`
  display: block;
  color: ${({theme:e})=>e.colors.grayscale.base};
  font-size: ${({theme:e})=>e.typography.sizes.s-1}px;
`,h=o.iK.div`
  padding-bottom: ${({theme:e})=>2*e.gridUnit}px;
  padding-top: ${({theme:e})=>2*e.gridUnit}px;

  & > div {
    margin: ${({theme:e})=>e.gridUnit}px 0;
  }

  &.extra-container {
    padding-top: 8px;
  }

  .confirm-overwrite {
    margin-bottom: ${({theme:e})=>2*e.gridUnit}px;
  }

  .input-container {
    display: flex;
    align-items: center;

    label {
      display: flex;
      margin-right: ${({theme:e})=>2*e.gridUnit}px;
    }

    i {
      margin: 0 ${({theme:e})=>e.gridUnit}px;
    }
  }

  input,
  textarea {
    flex: 1 1 auto;
  }

  textarea {
    height: 160px;
    resize: none;
  }

  input::placeholder,
  textarea::placeholder {
    color: ${({theme:e})=>e.colors.grayscale.light1};
  }

  textarea,
  input[type='text'],
  input[type='number'] {
    padding: ${({theme:e})=>1.5*e.gridUnit}px
      ${({theme:e})=>2*e.gridUnit}px;
    border-style: none;
    border: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    border-radius: ${({theme:e})=>e.gridUnit}px;

    &[name='name'] {
      flex: 0 1 auto;
      width: 40%;
    }

    &[name='sqlalchemy_uri'] {
      margin-right: ${({theme:e})=>3*e.gridUnit}px;
    }
  }
`,g=({resourceName:e,resourceLabel:t,passwordsNeededMessage:a,confirmOverwriteMessage:s,addDangerToast:o,onModelImport:p,show:g,onHide:b,passwordFields:f=[],setPasswordFields:y=(()=>{})})=>{const[v,w]=(0,r.useState)(!0),[Z,S]=(0,r.useState)({}),[x,D]=(0,r.useState)(!1),[C,H]=(0,r.useState)(!1),[L,M]=(0,r.useState)([]),[k,_]=(0,r.useState)(!1),U=()=>{M([]),y([]),S({}),D(!1),H(!1),_(!1)},{state:{alreadyExists:G,passwordsNeeded:E},importResource:N}=(0,u.PW)(e,t,(e=>{U(),o(e)}));(0,r.useEffect)((()=>{y(E),E.length>0&&_(!1)}),[E,y]),(0,r.useEffect)((()=>{D(G.length>0),G.length>0&&_(!1)}),[G,D]);return v&&g&&w(!1),(0,c.tZ)(i.Z,{name:"model",className:"import-model-modal",disablePrimaryButton:0===L.length||x&&!C||k,onHandledPrimaryAction:()=>{var e;(null==(e=L[0])?void 0:e.originFileObj)instanceof File&&(_(!0),N(L[0].originFileObj,Z,C).then((e=>{e&&(U(),p())})))},onHide:()=>{w(!0),b(),U()},primaryButtonName:x?(0,n.t)("Overwrite"):(0,n.t)("Import"),primaryButtonType:x?"danger":"primary",width:"750px",show:g,title:(0,c.tZ)("h4",null,(0,n.t)("Import %s",t))},(0,c.tZ)(h,null,(0,c.tZ)(d.gq,{name:"modelFile",id:"modelFile","data-test":"model-file-input",accept:".yaml,.json,.yml,.zip",fileList:L,onChange:e=>{M([{...e.file,status:"done"}])},onRemove:e=>(M(L.filter((t=>t.uid!==e.uid))),!1),customRequest:()=>{}},(0,c.tZ)(l.Z,{loading:k},"Select file"))),0===f.length?null:(0,c.tZ)(r.Fragment,null,(0,c.tZ)("h5",null,"Database passwords"),(0,c.tZ)(m,null,a),f.map((e=>(0,c.tZ)(h,{key:`password-for-${e}`},(0,c.tZ)("div",{className:"control-label"},e,(0,c.tZ)("span",{className:"required"},"*")),(0,c.tZ)("input",{name:`password-${e}`,autoComplete:`password-${e}`,type:"password",value:Z[e],onChange:t=>S({...Z,[e]:t.target.value})}))))),x?(0,c.tZ)(r.Fragment,null,(0,c.tZ)(h,null,(0,c.tZ)("div",{className:"confirm-overwrite"},s),(0,c.tZ)("div",{className:"control-label"},(0,n.t)('Type "%s" to confirm',(0,n.t)("OVERWRITE"))),(0,c.tZ)("input",{"data-test":"overwrite-modal-input",id:"overwrite",type:"text",onChange:e=>{var t,a;const s=null!=(t=null==(a=e.currentTarget)?void 0:a.value)?t:"";H(s.toUpperCase()===(0,n.t)("OVERWRITE"))}}))):null)};p(g,"useState{[isHidden, setIsHidden](true)}\nuseState{[passwords, setPasswords]({})}\nuseState{[needsOverwriteConfirm, setNeedsOverwriteConfirm](false)}\nuseState{[confirmedOverwrite, setConfirmedOverwrite](false)}\nuseState{[fileList, setFileList]([])}\nuseState{[importingModel, setImportingModel](false)}\nuseImportResource{{ state: { alreadyExists, passwordsNeeded }, importResource, }}\nuseEffect{}\nuseEffect{}",(()=>[u.PW]));const b=g,f=b;var y,v;(y="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(y.register(m,"HelperMessage","/Users/chenming/superset/superset-frontend/src/components/ImportModal/index.tsx"),y.register(h,"StyledInputContainer","/Users/chenming/superset/superset-frontend/src/components/ImportModal/index.tsx"),y.register(g,"ImportModelsModal","/Users/chenming/superset/superset-frontend/src/components/ImportModal/index.tsx"),y.register(b,"default","/Users/chenming/superset/superset-frontend/src/components/ImportModal/index.tsx")),(v="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&v(e)},495413:(e,t,a)=>{a.d(t,{Y:()=>o});var s,r=a(455867);e=a.hmd(e),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&s(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const o={name:(0,r.t)("Data"),tabs:[{name:"Databases",label:(0,r.t)("Databases"),url:"/databaseview/list/",usesRouter:!0},{name:"Datasets",label:(0,r.t)("Datasets"),url:"/tablemodelview/list/",usesRouter:!0},{name:"Saved queries",label:(0,r.t)("Saved queries"),url:"/savedqueryview/list/",usesRouter:!0},{name:"Query history",label:(0,r.t)("Query history"),url:"/superset/sqllab/history/",usesRouter:!0}]};var n,l;(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&n.register(o,"commonMenuData","/Users/chenming/superset/superset-frontend/src/views/CRUD/data/common.ts"),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&l(e)},968474:(e,t,a)=>{a.d(t,{Z:()=>b});var s,r=a(667294),o=a(751995),n=a(455867),l=a(34858),i=a(574520),d=a(517982),u=a(414114),c=a(211965);e=a.hmd(e),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&s(e);var p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e};const m=o.iK.div`
  padding-bottom: 340px;
  width: 65%;
`,h=({addDangerToast:e,addSuccessToast:t,onDatasetAdd:a,onHide:s,show:o})=>{const[u,p]=(0,r.useState)(),[h,g]=(0,r.useState)(""),[b,f]=(0,r.useState)(""),[y,v]=(0,r.useState)(!0),{createResource:w}=(0,l.LE)("dataset",(0,n.t)("dataset"),e);(0,r.useEffect)((()=>{v(void 0===u||""===b)}),[b,u]);const Z=()=>{g(""),f(""),p(void 0),v(!0),s()};return(0,c.tZ)(i.Z,{disablePrimaryButton:y,onHandledPrimaryAction:()=>{if(void 0===u)return;const e={database:u.id,...h?{schema:h}:{},table_name:b};w(e).then((e=>{e&&(a&&a({id:e.id,...e}),t((0,n.t)("The dataset has been saved")),Z())}))},onHide:Z,primaryButtonName:(0,n.t)("Add"),show:o,title:(0,n.t)("Add dataset")},(0,c.tZ)(m,null,(0,c.tZ)(d.Z,{clearable:!1,formMode:!0,database:u,schema:h,tableName:b,onDbChange:e=>{p(e)},onSchemaChange:e=>{g(e)},onTableChange:e=>{f(e)},handleError:e})))};p(h,"useState{[currentDatabase, setCurrentDatabase]}\nuseState{[currentSchema, setSchema]('')}\nuseState{[currentTableName, setTableName]('')}\nuseState{[disableSave, setDisableSave](true)}\nuseSingleViewResource{{ createResource }}\nuseEffect{}",(()=>[l.LE]));const g=(0,u.Z)(h),b=g;var f,y;(f="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(f.register(m,"TableSelectorContainer","/Users/chenming/superset/superset-frontend/src/views/CRUD/data/dataset/AddDatasetModal.tsx"),f.register(h,"DatasetModal","/Users/chenming/superset/superset-frontend/src/views/CRUD/data/dataset/AddDatasetModal.tsx"),f.register(g,"default","/Users/chenming/superset/superset-frontend/src/views/CRUD/data/dataset/AddDatasetModal.tsx")),(y="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&y(e)},851236:(e,t,a)=>{a.r(t),a.d(t,{default:()=>$});var s,r=a(751995),o=a(455867),n=a(431069),l=a(667294),i=a(115926),d=a.n(i),u=a(440768),c=a(34858),p=a(419259),m=a(544142),h=a(217198),g=a(232228),b=a(550859),f=a(838703),y=a(620755),v=a(495413),w=a(414114),Z=a(358593),S=a(87693),x=a(776698),D=a(679789),C=a(608272),H=a(727989),L=a(591877),M=a(486057),k=a(968474),_=a(652389),U=a(211965);e=a.hmd(e),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&s(e);var G="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e};const E=r.iK.div`
  align-items: center;
  display: flex;

  svg {
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }
`,N=r.iK.div`
  color: ${({theme:e})=>e.colors.grayscale.base};
`,R=({addDangerToast:e,addSuccessToast:t,user:a})=>{const{state:{loading:s,resourceCount:r,resourceCollection:i,bulkSelectEnabled:w},hasPerm:G,fetchData:R,toggleBulkSelect:T,refreshData:$}=(0,c.Yi)("dataset",(0,o.t)("dataset"),e),[A,I]=(0,l.useState)(!1),[O,P]=(0,l.useState)(null),[B,F]=(0,l.useState)(null),[z,q]=(0,l.useState)(!1),[V,j]=(0,l.useState)([]),[K,W]=(0,l.useState)(!1),Y=G("can_write"),J=G("can_write"),Q=G("can_write"),X=G("can_export"),ee=_.dY,te=(0,l.useCallback)((({id:t})=>{n.Z.get({endpoint:`/api/v1/dataset/${t}`}).then((({json:e={}})=>{const t=e.result.columns.map((e=>{const{certification:{details:t="",certified_by:a=""}={}}=JSON.parse(e.extra||"{}")||{};return{...e,certification_details:t||"",certified_by:a||"",is_certified:t||a}}));e.result.columns=[...t],F(e.result)})).catch((()=>{e((0,o.t)("An error occurred while fetching dataset related data"))}))}),[e]),ae=(0,l.useMemo)((()=>[{Cell:({row:{original:{kind:e}}})=>"physical"===e?(0,U.tZ)(Z.u,{id:"physical-dataset-tooltip",title:(0,o.t)("Physical dataset")},(0,U.tZ)(S.Z.DatasetPhysical,null)):(0,U.tZ)(Z.u,{id:"virtual-dataset-tooltip",title:(0,o.t)("Virtual dataset")},(0,U.tZ)(S.Z.DatasetVirtual,null)),accessor:"kind_icon",disableSortBy:!0,size:"xs"},{Cell:({row:{original:{extra:e,table_name:t,description:a,explore_url:s}}})=>{const r=(0,U.tZ)("a",{href:s},t);try{const t=JSON.parse(e);return(0,U.tZ)(E,null,(null==t?void 0:t.certification)&&(0,U.tZ)(D.Z,{certifiedBy:t.certification.certified_by,details:t.certification.details,size:"l"}),(null==t?void 0:t.warning_markdown)&&(0,U.tZ)(M.Z,{warningMarkdown:t.warning_markdown,size:"l"}),r,a&&(0,U.tZ)(C.Z,{tooltip:a,viewBox:"0 -1 24 24"}))}catch{return r}},Header:(0,o.t)("Name"),accessor:"table_name"},{Cell:({row:{original:{kind:e}}})=>{var t;return(null==(t=e[0])?void 0:t.toUpperCase())+e.slice(1)},Header:(0,o.t)("Type"),accessor:"kind",disableSortBy:!0,size:"md"},{Header:(0,o.t)("Database"),accessor:"database.database_name",size:"lg"},{Header:(0,o.t)("Schema"),accessor:"schema",size:"lg"},{Cell:({row:{original:{changed_on_delta_humanized:e}}})=>(0,U.tZ)("span",{className:"no-wrap"},e),Header:(0,o.t)("Modified"),accessor:"changed_on_delta_humanized",size:"xl"},{Cell:({row:{original:{changed_by_name:e}}})=>e,Header:(0,o.t)("Modified by"),accessor:"changed_by.first_name",size:"xl"},{accessor:"database",disableSortBy:!0,hidden:!0},{Cell:({row:{original:{owners:e=[]}}})=>(0,U.tZ)(x.Z,{users:e}),Header:(0,o.t)("Owners"),id:"owners",disableSortBy:!0,size:"lg"},{accessor:"sql",hidden:!0,disableSortBy:!0},{Cell:({row:{original:e}})=>Y||J||X?(0,U.tZ)(N,{className:"actions"},J&&(0,U.tZ)(Z.u,{id:"delete-action-tooltip",title:(0,o.t)("Delete"),placement:"bottom"},(0,U.tZ)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>{return t=e,n.Z.get({endpoint:`/api/v1/dataset/${t.id}/related_objects`}).then((({json:e={}})=>{P({...t,chart_count:e.charts.count,dashboard_count:e.dashboards.count})})).catch((0,u.v$)((e=>(0,o.t)("An error occurred while fetching dataset related data: %s",e))));var t}},(0,U.tZ)(S.Z.Trash,null))),X&&(0,U.tZ)(Z.u,{id:"export-action-tooltip",title:(0,o.t)("Export"),placement:"bottom"},(0,U.tZ)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>ne([e])},(0,U.tZ)(S.Z.Share,null))),Y&&(0,U.tZ)(Z.u,{id:"edit-action-tooltip",title:(0,o.t)("Edit"),placement:"bottom"},(0,U.tZ)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>te(e)},(0,U.tZ)(S.Z.EditAlt,null)))):null,Header:(0,o.t)("Actions"),id:"actions",hidden:!Y&&!J,disableSortBy:!0}]),[Y,J,X,te]),se=(0,l.useMemo)((()=>[{Header:(0,o.t)("Owner"),id:"owners",input:"select",operator:b.p.relationManyMany,unfilteredLabel:"All",fetchSelects:(0,u.tm)("dataset","owners",(0,u.v$)((e=>(0,o.t)("An error occurred while fetching dataset owner values: %s",e))),a),paginate:!0},{Header:(0,o.t)("Database"),id:"database",input:"select",operator:b.p.relationOneMany,unfilteredLabel:"All",fetchSelects:(0,u.tm)("dataset","database",(0,u.v$)((e=>(0,o.t)("An error occurred while fetching datasets: %s",e)))),paginate:!0},{Header:(0,o.t)("Schema"),id:"schema",input:"select",operator:b.p.equals,unfilteredLabel:"All",fetchSelects:(0,u.wk)("dataset","schema",(0,u.v$)((e=>(0,o.t)("An error occurred while fetching schema values: %s",e)))),paginate:!0},{Header:(0,o.t)("Type"),id:"sql",input:"select",operator:b.p.datasetIsNullOrEmpty,unfilteredLabel:"All",selects:[{label:"Virtual",value:!1},{label:"Physical",value:!0}]},{Header:(0,o.t)("Search"),id:"table_name",input:"search",operator:b.p.contains}]),[]),re={activeChild:"Datasets",...v.Y},oe=[];(J||X)&&oe.push({name:(0,o.t)("Bulk select"),onClick:T,buttonStyle:"secondary"}),Q&&(oe.push({name:(0,U.tZ)(l.Fragment,null,(0,U.tZ)("i",{className:"fa fa-plus"})," ",(0,o.t)("Dataset")," "),onClick:()=>I(!0),buttonStyle:"primary"}),(0,L.cr)(L.TT.VERSIONED_EXPORT)&&oe.push({name:(0,U.tZ)(Z.u,{id:"import-tooltip",title:(0,o.t)("Import datasets"),placement:"bottomRight"},(0,U.tZ)(S.Z.Import,{"data-test":"import-button"})),buttonStyle:"link",onClick:()=>{q(!0)}})),re.buttons=oe;const ne=e=>{const t=e.map((({id:e})=>e));(0,g.Z)("dataset",t,(()=>{W(!1)})),W(!0)};return(0,U.tZ)(l.Fragment,null,(0,U.tZ)(y.Z,re),(0,U.tZ)(k.Z,{show:A,onHide:()=>I(!1),onDatasetAdd:$}),O&&(0,U.tZ)(h.Z,{description:(0,o.t)("The dataset %s is linked to %s charts that appear on %s dashboards. Are you sure you want to continue? Deleting the dataset will break those objects.",O.table_name,O.chart_count,O.dashboard_count),onConfirm:()=>{O&&(({id:a,table_name:s})=>{n.Z.delete({endpoint:`/api/v1/dataset/${a}`}).then((()=>{$(),P(null),t((0,o.t)("Deleted: %s",s))}),(0,u.v$)((t=>e((0,o.t)("There was an issue deleting %s: %s",s,t)))))})(O)},onHide:()=>{P(null)},open:!0,title:(0,o.t)("Delete Dataset?")}),B&&(0,U.tZ)(m.W,{datasource:B,onDatasourceSave:$,onHide:()=>{F(null)},show:!0}),(0,U.tZ)(p.Z,{title:(0,o.t)("Please confirm"),description:(0,o.t)("Are you sure you want to delete the selected datasets?"),onConfirm:a=>{n.Z.delete({endpoint:`/api/v1/dataset/?q=${d().encode(a.map((({id:e})=>e)))}`}).then((({json:e={}})=>{$(),t(e.message)}),(0,u.v$)((t=>e((0,o.t)("There was an issue deleting the selected datasets: %s",t)))))}},(e=>{const t=[];return J&&t.push({key:"delete",name:(0,o.t)("Delete"),onSelect:e,type:"danger"}),X&&t.push({key:"export",name:(0,o.t)("Export"),type:"primary",onSelect:ne}),(0,U.tZ)(b.Z,{className:"dataset-list-view",columns:ae,data:i,count:r,pageSize:_.IV,fetchData:R,filters:se,loading:s,initialSort:ee,bulkActions:t,bulkSelectEnabled:w,disableBulkSelect:T,renderBulkSelectCopy:e=>{const{virtualCount:t,physicalCount:a}=e.reduce(((e,t)=>("physical"===t.original.kind?e.physicalCount+=1:"virtual"===t.original.kind&&(e.virtualCount+=1),e)),{virtualCount:0,physicalCount:0});return e.length?t&&!a?(0,o.t)("%s Selected (Virtual)",e.length,t):a&&!t?(0,o.t)("%s Selected (Physical)",e.length,a):(0,o.t)("%s Selected (%s Physical, %s Virtual)",e.length,a,t):(0,o.t)("0 Selected")}})})),(0,U.tZ)(H.Z,{resourceName:"dataset",resourceLabel:(0,o.t)("dataset"),passwordsNeededMessage:_.iX,confirmOverwriteMessage:_.mI,addDangerToast:e,addSuccessToast:t,onModelImport:()=>{q(!1),$(),t((0,o.t)("Dataset imported"))},show:z,onHide:()=>{q(!1)},passwordFields:V,setPasswordFields:j}),K&&(0,U.tZ)(f.Z,null))};G(R,"useListViewResource{{ state: { loading, resourceCount: datasetCount, resourceCollection: datasets, bulkSelectEnabled, }, hasPerm, fetchData, toggleBulkSelect, refreshData, }}\nuseState{[datasetAddModalOpen, setDatasetAddModalOpen](false)}\nuseState{[datasetCurrentlyDeleting, setDatasetCurrentlyDeleting](null)}\nuseState{[datasetCurrentlyEditing, setDatasetCurrentlyEditing](null)}\nuseState{[importingDataset, showImportModal](false)}\nuseState{[passwordFields, setPasswordFields]([])}\nuseState{[preparingExport, setPreparingExport](false)}\nuseCallback{openDatasetEditModal}\nuseMemo{columns}\nuseMemo{filterTypes}",(()=>[c.Yi]));const T=(0,w.Z)(R),$=T;var A,I;(A="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(A.register(E,"FlexRowContainer","/Users/chenming/superset/superset-frontend/src/views/CRUD/data/dataset/DatasetList.tsx"),A.register(N,"Actions","/Users/chenming/superset/superset-frontend/src/views/CRUD/data/dataset/DatasetList.tsx"),A.register(R,"DatasetList","/Users/chenming/superset/superset-frontend/src/views/CRUD/data/dataset/DatasetList.tsx"),A.register(T,"default","/Users/chenming/superset/superset-frontend/src/views/CRUD/data/dataset/DatasetList.tsx")),(I="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&I(e)}}]);