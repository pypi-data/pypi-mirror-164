def correct_bpm(qx, qy, P, Q):

    x = P[0]
    x += P[1]*qx + P[2]*qy
    x += P[3]*qx**2 + P[4]*qx*qy + P[5]*qy**2
    x += P[6]*qx**3 + P[7]*qx**2*qy + P[8]*qx*qy**2 + P[9]*qy**3
    x += P[10]*qx**4 + P[11]*qx**3*qy + P[12]*qx**2*qy**2 + P[13]*qx*qy**3 + P[14]*qy**4
    x += P[15]*qx**5 + P[16]*qx**4*qy + P[17]*qx**3*qy**2 + P[18]*qx**2*qy**3 + P[19]*qx*qy**4 + P[20]*qy**5
    x += P[21]*qx**6 + P[22]*qx**5*qy + P[23]*qx**4*qy**2 + P[24]*qx**3*qy**3 + P[25]*qx**2*qy**4 + P[26]*qx*qy**5 + P[27]*qy**6
    x += P[28]*qx**7 + P[29]*qx**6*qy + P[30]*qx**5*qy**2 + P[31]*qx**4*qy**3 + P[32]*qx**3*qy**4 + P[33]*qx**2*qy**5 + P[34]*qx*qy**6 + P[35]*qy**7
    x += P[36]*qx**8 + P[37]*qx**7*qy + P[38]*qx**6*qy**2 + P[39]*qx**5*qy**3 + P[40]*qx**4*qy**4 + P[41]*qx**3*qy**5 + P[42]*qx**2*qy**6 + P[43]*qx*qy**7 + P[44]*qy**8
    x += P[45]*qx**9 + P[46]*qx**8*qy + P[47]*qx**7*qy**2 + P[48]*qx**6*qy**3 + P[49]*qx**5*qy**4 + P[50]*qx**4*qy**5 + P[51]*qx**3*qy**6 + P[52]*qx**2*qy**7 + P[53]*qx*qy**8 + P[54]*qy**9
    x += P[55]*qx**10 + P[56]*qx**9*qy + P[57]*qx**8*qy**2 + P[58]*qx**7*qy**3 + P[59]*qx**6*qy**4 + P[60]*qx**5*qy**5 + P[61]*qx**4*qy**6 + P[62]*qx**3*qy**7 + P[63]*qx**2*qy**8 + P[64]*qx*qy**9 + P[65]*qy**10
    x += P[66]*qx**11 + P[67]*qx**10*qy + P[68]*qx**9*qy**2 + P[69]*qx**8*qy**3 + P[70]*qx**7*qy**4 + P[71]*qx**6*qy**5 + P[72]*qx**5*qy**6 + P[73]*qx**4*qy**7 + P[74]*qx**3*qy**8 + P[75]*qx**2*qy**9 + P[76]*qx*qy**10 + P[77]*qy**11


    y = Q[0]
    y += Q[1]*qx + Q[2]*qy
    y += Q[3]*qx**2 + Q[4]*qx*qy + Q[5]*qy**2
    y += Q[6]*qx**3 + Q[7]*qx**2*qy + Q[8]*qx*qy**2 + Q[9]*qy**3
    y += Q[10]*qx**4 + Q[11]*qx**3*qy + Q[12]*qx**2*qy**2 + Q[13]*qx*qy**3 + Q[14]*qy**4
    y += Q[15]*qx**5 + Q[16]*qx**4*qy + Q[17]*qx**3*qy**2 + Q[18]*qx**2*qy**3 + Q[19]*qx*qy**4 + Q[20]*qy**5
    y += Q[21]*qx**6 + Q[22]*qx**5*qy + Q[23]*qx**4*qy**2 + Q[24]*qx**3*qy**3 + Q[25]*qx**2*qy**4 + Q[26]*qx*qy**5 + Q[27]*qy**6
    y += Q[28]*qx**7 + Q[29]*qx**6*qy + Q[30]*qx**5*qy**2 + Q[31]*qx**4*qy**3 + Q[32]*qx**3*qy**4 + Q[33]*qx**2*qy**5 + Q[34]*qx*qy**6 + Q[35]*qy**7
    y += Q[36]*qx**8 + Q[37]*qx**7*qy + Q[38]*qx**6*qy**2 + Q[39]*qx**5*qy**3 + Q[40]*qx**4*qy**4 + Q[41]*qx**3*qy**5 + Q[42]*qx**2*qy**6 + Q[43]*qx*qy**7 + Q[44]*qy**8
    y += Q[45]*qx**9 + Q[46]*qx**8*qy + Q[47]*qx**7*qy**2 + Q[48]*qx**6*qy**3 + Q[49]*qx**5*qy**4 + Q[50]*qx**4*qy**5 + Q[51]*qx**3*qy**6 + Q[52]*qx**2*qy**7 + Q[53]*qx*qy**8 + Q[54]*qy**9
    y += Q[55]*qx**10 + Q[56]*qx**9*qy + Q[57]*qx**8*qy**2 + Q[58]*qx**7*qy**3 + Q[59]*qx**6*qy**4 + Q[60]*qx**5*qy**5 + Q[61]*qx**4*qy**6 + Q[62]*qx**3*qy**7 + Q[63]*qx**2*qy**8 + Q[64]*qx*qy**9 + Q[65]*qy**10
    y += Q[66]*qx**11 + Q[67]*qx**10*qy + Q[68]*qx**9*qy**2 + Q[69]*qx**8*qy**3 + Q[70]*qx**7*qy**4 + Q[71]*qx**6*qy**5 + Q[72]*qx**5*qy**6 + Q[73]*qx**4*qy**7 + Q[74]*qx**3*qy**8 + Q[75]*qx**2*qy**9 + Q[76]*qx*qy**10 + Q[77]*qy**11

    return (x,y)
