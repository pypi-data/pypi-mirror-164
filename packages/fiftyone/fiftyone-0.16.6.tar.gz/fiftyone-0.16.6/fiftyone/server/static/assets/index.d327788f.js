var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,s=(e,t)=>{for(var n in t||(t={}))i.call(t,n)&&a(e,n,t[n]);if(r)for(var n of r(t))o.call(t,n)&&a(e,n,t[n]);return e},u=(e,r)=>t(e,n(r)),c=(e,t)=>{var n={};for(var a in e)i.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&r)for(var a of r(e))t.indexOf(a)<0&&o.call(e,a)&&(n[a]=e[a]);return n};import l from"./RootQuery.graphql.46392c91.js";import{R as d,e as h,a as f,an as p,az as y,s as v,j as g,n as m,i as b,a9 as k,aA as _,y as E,h as S,aB as w,aC as x,a6 as C,aD as O,a2 as T,aE as I,B as K,O as P,X as A,d as R,P as L,au as M,A as j,m as N}from"./vendor.b0739682.js";import{b as D,R as F,u as H,a as U,c as q,d as B,E as V,v as G,g as z,e as $,f as W,h as J,t as X,i as Q,j as Z,k as Y,l as ee,m as te,n as ne,H as re,o as ie,S as oe,G as ae,D as se,r as ue,p as ce}from"./index.5a260dc4.js";const le=e=>{var t=e,{children:n,className:r}=t,i=c(t,["children","className"]);const o=[D,r];return d.createElement("button",s({className:h(...o)},i),n)},de=({children:e,className:t,style:n,title:r,to:i})=>{const o=f.exports.useContext(F),[a,s]=f.exports.useTransition();return d.createElement("a",{href:i,onClick:i?f.exports.useCallback((e=>{e.preventDefault(),s((()=>{o.history.push(i)}))}),[i,o]):void 0,onMouseEnter:i?f.exports.useCallback((()=>{o.preload(i)}),[i,o]):void 0,style:n,className:t,title:r},e)},he={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RootConfig_query",selections:[{alias:null,args:null,concreteType:"AppConfig",kind:"LinkedField",name:"config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"colorBy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"colorPool",storageKey:null},fe={alias:null,args:null,kind:"ScalarField",name:"colorscale",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridZoom",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"loopVideos",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"notebookHeight",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"showConfidence",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"showIndex",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"showLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"showSkeletons",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"showTooltip",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timezone",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"useFrameNumber",storageKey:null}],storageKey:null},fe],type:"Query",abstractKey:null};var fe;he.hash="28b47d8c7639326428a23be097cd357e";const pe={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RootNav_query",selections:[{alias:null,args:null,kind:"ScalarField",name:"teamsSubmission",storageKey:null}],type:"Query",abstractKey:null,hash:"24cca3fbea15640c1527e86151f3899e"},ye={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RootGA_query",selections:[{alias:null,args:null,kind:"ScalarField",name:"context",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dev",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"doNotTrack",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"version",storageKey:null}],type:"Query",abstractKey:null,hash:"40d5fec94e7227a5e638ff2fec41458e"},ve=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"count"},{defaultValue:null,kind:"LocalArgument",name:"cursor"},{defaultValue:null,kind:"LocalArgument",name:"search"}],t=[{kind:"Variable",name:"after",variableName:"cursor"},{kind:"Variable",name:"first",variableName:"count"},{kind:"Variable",name:"search",variableName:"search"}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"DatasetsPaginationQuery",selections:[{args:null,kind:"FragmentSpread",name:"RootDatasets_query"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"DatasetsPaginationQuery",selections:[{alias:null,args:t,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null},{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:["search"],handle:"connection",key:"DatasetsList_query_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"1e0b621671e78c21b0947dcfa72dd51e",id:null,metadata:{},name:"DatasetsPaginationQuery",operationKind:"query",text:"query DatasetsPaginationQuery(\n  $count: Int\n  $cursor: String\n  $search: String\n) {\n  ...RootDatasets_query\n}\n\nfragment RootDatasets_query on Query {\n  datasets(search: $search, first: $count, after: $cursor) {\n    total\n    edges {\n      cursor\n      node {\n        name\n        id\n        __typename\n      }\n    }\n    pageInfo {\n      endCursor\n      hasNextPage\n    }\n  }\n}\n"}}}();ve.hash="280afc557752c2245a140c58ccb00248";const ge=function(){var e=["datasets"];return{argumentDefinitions:[{kind:"RootArgument",name:"count"},{kind:"RootArgument",name:"cursor"},{kind:"RootArgument",name:"search"}],kind:"Fragment",metadata:{connection:[{count:"count",cursor:"cursor",direction:"forward",path:e}],refetch:{connection:{forward:{count:"count",cursor:"cursor"},backward:null,path:e},fragmentPathInResult:[],operation:ve}},name:"RootDatasets_query",selections:[{alias:"datasets",args:[{kind:"Variable",name:"search",variableName:"search"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"__DatasetsList_query_datasets_connection",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null},{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();function me(e){console.warn("[react-ga]",e)}function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ee(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e,t){return(xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ie(e);if(t){var i=Ie(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Oe(this,n)}}function Oe(e,t){return!t||"object"!==be(t)&&"function"!=typeof t?Te(e):t}function Te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ge.hash="280afc557752c2245a140c58ccb00248";var Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xe(e,t)}(o,f.exports.Component);var t,n,r,i=Ce(o);function o(){var e;Se(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ke(Te(e=i.call.apply(i,[this].concat(n))),"handleClick",(function(t){var n=e.props,r=n.target,i=n.eventLabel,a=n.to,s=n.onClick,u=n.trackerNames,c={label:i},l="_blank"!==r,d=!(t.ctrlKey||t.shiftKey||t.metaKey||1===t.button);l&&d?(t.preventDefault(),o.trackLink(c,(function(){window.location.href=a}),u)):o.trackLink(c,(function(){}),u),s&&s(t)})),e}return t=o,(n=[{key:"render",value:function(){var e=this.props,t=e.to,n=e.target,r=_e(_e({},Ee(e,["to","target"])),{},{target:n,href:t,onClick:this.handleClick});return"_blank"===n&&(r.rel="".concat(r.rel?r.rel:""," noopener noreferrer").trim()),delete r.eventLabel,delete r.trackerNames,d.createElement("a",r)}}])&&we(t.prototype,n),r&&we(t,r),o}();Ke(Pe,"trackLink",(function(){me("ga tracking not enabled")})),Pe.propTypes={eventLabel:p.string.isRequired,target:p.string,to:p.string,onClick:p.func,trackerNames:p.arrayOf(p.string)},Pe.defaultProps={target:null,to:null,onClick:null,trackerNames:null};function Ae(e){return"string"==typeof(t=e)&&-1!==t.indexOf("@")?(me("This arg looks like an email address, redacting."),"REDACTED (Potential Email Address)"):e;var t}function Re(e){return e&&e.toString().replace(/^\s+|\s+$/g,"")}var Le=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;function Me(e){return Re(e).replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,(function(e,t,n){return t>0&&t+e.length!==n.length&&e.search(Le)>-1&&":"!==n.charAt(t-2)&&("-"!==n.charAt(t+e.length)||"-"===n.charAt(t-1))&&n.charAt(t-1).search(/[^\s-]/)<0?e.toLowerCase():e.substr(1).search(/[A-Z]|\../)>-1?e:e.charAt(0).toUpperCase()+e.substr(1)}))}var je=!1;function Ne(e){console.info("[react-ga]",e)}var De=[],Fe={calls:De,ga:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];De.push([].concat(t))},resetCalls:function(){De.length=0}};function He(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ve(e){return function(e){if(Array.isArray(e))return Ge(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ge(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ze="undefined"==typeof window||"undefined"==typeof document,$e=!1,We=!0,Je=!1,Xe=!0,Qe=!0,Ze=function(){var e;return Je?Fe.ga.apply(Fe,arguments):!ze&&(window.ga?(e=window).ga.apply(e,arguments):me("ReactGA.initialize must be called first or GoogleAnalytics should be loaded manually"))};function Ye(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e||"";return(arguments.length>1?arguments[1]:void 0)&&(n=Me(e)),t&&(n=Ae(n)),n}(e,We,Qe)}function et(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0];"string"==typeof i?(!Xe&&Array.isArray(e)||Ze.apply(void 0,n),Array.isArray(e)&&e.forEach((function(e){Ze.apply(void 0,Ve(["".concat(e,".").concat(i)].concat(n.slice(1))))}))):me("ga command must be a string")}function tt(e,t){e?t&&(t.debug&&!0===t.debug&&($e=!0),!1===t.titleCase&&(We=!1),!1===t.redactEmail&&(Qe=!1),t.useExistingGa)||(t&&t.gaOptions?Ze("create",e,t.gaOptions):Ze("create",e,"auto")):me("gaTrackingID is required in initialize()")}function nt(e,t){return Array.isArray(e)?e.forEach((function(e){"object"===Be(e)?tt(e.trackingId,e):me("All configs must be an object")})):tt(e,t),!0}function rt(e,t){if(t&&!0===t.testMode)Je=!0;else{if(ze)return;t&&!0===t.standardImplementation||function(e){if(!je){je=!0;var t="https://www.google-analytics.com/analytics.js";e&&e.gaAddress?t=e.gaAddress:e&&e.debug&&(t="https://www.google-analytics.com/analytics_debug.js");var n=e&&e.onerror;!function(e,t,r,i,o,a,s){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,a=t.createElement(r),s=t.getElementsByTagName(r)[0],a.async=1,a.src=i,a.onerror=n,s.parentNode.insertBefore(a,s)}(window,document,"script",t,"ga")}}(t)}Xe=!t||"boolean"!=typeof t.alwaysSendToDefaultTracker||t.alwaysSendToDefaultTracker,nt(e,t)}function it(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.length>0&&(Ze.apply(void 0,t),$e&&(Ne("called ga('arguments');"),Ne("with arguments: ".concat(JSON.stringify(t))))),window.ga}function ot(e,t){e?"object"===Be(e)?(0===Object.keys(e).length&&me("empty `fieldsObject` given to .set()"),et(t,"set",e),$e&&(Ne("called ga('set', fieldsObject);"),Ne("with fieldsObject: ".concat(JSON.stringify(e))))):me("Expected `fieldsObject` arg to be an Object"):me("`fieldsObject` is required in .set()")}function at(e,t){et(t,"send",e),$e&&(Ne("called ga('send', fieldObject);"),Ne("with fieldObject: ".concat(JSON.stringify(e))),Ne("with trackers: ".concat(JSON.stringify(t))))}function st(e,t,n){if(e){var r=Re(e);if(""!==r){var i={};if(n&&(i.title=n),et(t,"send",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){qe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({hitType:"pageview",page:r},i)),$e){Ne("called ga('send', 'pageview', path);");var o="";n&&(o=" and title: ".concat(n)),Ne("with path: ".concat(r).concat(o))}}else me("path cannot be an empty string in .pageview()")}else me("path is required in .pageview()")}function ut(e,t){if(e){var n,r="/"===(n=Re(e)).substring(0,1)?n.substring(1):n;if(""!==r){var i="/modal/".concat(r);et(t,"send","pageview",i),$e&&(Ne("called ga('send', 'pageview', path);"),Ne("with path: ".concat(i)))}else me("modalName cannot be an empty string or a single / in .modalview()")}else me("modalName is required in .modalview(modalName)")}function ct(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.category,n=e.variable,r=e.value,i=e.label,o=arguments.length>1?arguments[1]:void 0;if(t&&n&&"number"==typeof r){var a={hitType:"timing",timingCategory:Ye(t),timingVar:Ye(n),timingValue:r};i&&(a.timingLabel=Ye(i)),at(a,o)}else me("args.category, args.variable AND args.value are required in timing() AND args.value has to be a number")}function lt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.category,n=e.action,r=e.label,i=e.value,o=e.nonInteraction,a=e.transport,s=He(e,["category","action","label","value","nonInteraction","transport"]),u=arguments.length>1?arguments[1]:void 0;if(t&&n){var c={hitType:"event",eventCategory:Ye(t),eventAction:Ye(n)};r&&(c.eventLabel=Ye(r)),void 0!==i&&("number"!=typeof i?me("Expected `args.value` arg to be a Number."):c.eventValue=i),void 0!==o&&("boolean"!=typeof o?me("`args.nonInteraction` must be a boolean."):c.nonInteraction=o),void 0!==a&&("string"!=typeof a?me("`args.transport` must be a string."):(-1===["beacon","xhr","image"].indexOf(a)&&me("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),c.transport=a)),Object.keys(s).filter((function(e){return"dimension"===e.substr(0,"dimension".length)})).forEach((function(e){c[e]=s[e]})),Object.keys(s).filter((function(e){return"metric"===e.substr(0,"metric".length)})).forEach((function(e){c[e]=s[e]})),at(c,u)}else me("args.category AND args.action are required in event()")}function dt(e,t){var n=e.description,r=e.fatal,i={hitType:"exception"};n&&(i.exDescription=Ye(n)),void 0!==r&&("boolean"!=typeof r?me("`args.fatal` must be a boolean."):i.exFatal=r),at(i,t)}var ht={require:function(e,t,n){if(e){var r=Re(e);if(""!==r){var i=n?"".concat(n,".require"):"require";if(t){if("object"!==Be(t))return void me("Expected `options` arg to be an Object");0===Object.keys(t).length&&me("Empty `options` given to .require()"),it(i,r,t),$e&&Ne("called ga('require', '".concat(r,"', ").concat(JSON.stringify(t)))}else it(i,r),$e&&Ne("called ga('require', '".concat(r,"');"))}else me("`name` cannot be an empty string in .require()")}else me("`name` is required in .require()")},execute:function(e,t){for(var n,r,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];if(1===o.length?n=o[0]:(r=o[0],n=o[1]),"string"!=typeof e)me("Expected `pluginName` arg to be a String.");else if("string"!=typeof t)me("Expected `action` arg to be a String.");else{var s="".concat(e,":").concat(t);n=n||null,r&&n?(it(s,r,n),$e&&(Ne("called ga('".concat(s,"');")),Ne('actionType: "'.concat(r,'" with payload: ').concat(JSON.stringify(n))))):n?(it(s,n),$e&&(Ne("called ga('".concat(s,"');")),Ne("with payload: ".concat(JSON.stringify(n))))):(it(s),$e&&Ne("called ga('".concat(s,"');")))}}};function ft(e,t,n){if("function"==typeof t)if(e&&e.label){var r={hitType:"event",eventCategory:"Outbound",eventAction:"Click",eventLabel:Ye(e.label)},i=!1,o=setTimeout((function(){i=!0,t()}),250);r.hitCallback=function(){clearTimeout(o),i||t()},at(r,n)}else me("args.label is required in outboundLink()");else me("hitCallback function is required")}var pt=Fe,yt={initialize:rt,ga:it,set:ot,send:at,pageview:st,modalview:ut,timing:ct,event:lt,exception:dt,plugin:ht,outboundLink:ft,testModeAPI:Fe},vt=Object.freeze(Object.defineProperty({__proto__:null,addTrackers:nt,initialize:rt,ga:it,set:ot,send:at,pageview:st,modalview:ut,timing:ct,event:lt,exception:dt,plugin:ht,outboundLink:ft,testModeAPI:pt,default:yt},Symbol.toStringTag,{value:"Module"}));function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){bt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Pe.origTrackLink=Pe.trackLink,Pe.trackLink=ft;var kt=Pe,_t=mt(mt({},vt),{},{OutboundLink:kt}),Et={app_ids:{prod:"UA-141773487-6",dev:"UA-141773487-7"},dimensions:{dev:"dimension1",version:"dimension2",context:"dimension3"}};var St,wt,xt,Ct,Ot="_page_8fb7q_1",Tt=function(){return(Tt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function It(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Kt(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pt(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function At(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}(wt=St||(St={})).Start="xstate.start",wt.Stop="xstate.stop",wt.Raise="xstate.raise",wt.Send="xstate.send",wt.Cancel="xstate.cancel",wt.NullEvent="",wt.Assign="xstate.assign",wt.After="xstate.after",wt.DoneState="done.state",wt.DoneInvoke="done.invoke",wt.Log="xstate.log",wt.Init="xstate.init",wt.Invoke="xstate.invoke",wt.ErrorExecution="error.execution",wt.ErrorCommunication="error.communication",wt.ErrorPlatform="error.platform",wt.ErrorCustom="xstate.error",wt.Update="xstate.update",wt.Pure="xstate.pure",wt.Choose="xstate.choose",(Ct=xt||(xt={})).Parent="#_parent",Ct.Internal="#_internal";var Rt,Lt=St.Start,Mt=St.Stop,jt=St.Raise,Nt=St.Send,Dt=St.Cancel,Ft=St.NullEvent,Ht=St.Assign,Ut=St.After,qt=St.DoneState,Bt=St.Log,Vt=St.Init,Gt=St.Invoke,zt=St.ErrorExecution,$t=St.ErrorPlatform,Wt=St.ErrorCustom,Jt=St.Update,Xt=St.Choose,Qt=St.Pure,Zt=Object.freeze(Object.defineProperty({__proto__:null,after:Ut,assign:Ht,cancel:Dt,choose:Xt,doneState:qt,error:Wt,errorExecution:zt,errorPlatform:$t,init:Vt,invoke:Gt,log:Bt,nullEvent:Ft,pure:Qt,raise:jt,send:Nt,start:Lt,stop:Mt,update:Jt},Symbol.toStringTag,{value:"Module"})),Yt={};function en(e,t,n){void 0===n&&(n=".");var r=rn(e,n),i=rn(t,n);return kn(i)?!!kn(r)&&i===r:kn(r)?r in i:Object.keys(r).every((function(e){return e in i&&en(r[e],i[e])}))}function tn(e){try{return kn(e)||"number"==typeof e?"".concat(e):e.type}catch(t){throw new Error("Events must be strings or objects with a string event.type property.")}}function nn(e,t){try{return mn(e)?e:e.toString().split(t)}catch(n){throw new Error("'".concat(e,"' is not a valid state path."))}}function rn(e,t){return"object"==typeof(n=e)&&"value"in n&&"context"in n&&"event"in n&&"_event"in n?e.value:mn(e)?on(e):"string"!=typeof e?e:on(nn(e,t));var n}function on(e){if(1===e.length)return e[0];for(var t={},n=t,r=0;r<e.length-1;r++)r===e.length-2?n[e[r]]=e[r+1]:(n[e[r]]={},n=n[e[r]]);return t}function an(e,t){for(var n={},r=Object.keys(e),i=0;i<r.length;i++){var o=r[i];n[o]=t(e[o],o,e,i)}return n}function sn(e,t,n){var r,i,o={};try{for(var a=Kt(Object.keys(e)),s=a.next();!s.done;s=a.next()){var u=s.value,c=e[u];n(c)&&(o[u]=t(c,u,e))}}catch(l){r={error:l}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}var un=function(e){return function(t){var n,r,i=t;try{for(var o=Kt(e),a=o.next();!a.done;a=o.next()){i=i[a.value]}}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}};function cn(e){return e?kn(e)?[[e]]:ln(Object.keys(e).map((function(t){var n=e[t];return"string"==typeof n||n&&Object.keys(n).length?cn(e[t]).map((function(e){return[t].concat(e)})):[[t]]}))):[[]]}function ln(e){var t;return(t=[]).concat.apply(t,At([],Pt(e),!1))}function dn(e){return mn(e)?e:[e]}function hn(e){return void 0===e?[]:dn(e)}function fn(e,t,n){var r,i;if(bn(e))return e(t,n.data);var o={};try{for(var a=Kt(Object.keys(e)),s=a.next();!s.done;s=a.next()){var u=s.value,c=e[u];bn(c)?o[u]=c(t,n.data):o[u]=c}}catch(l){r={error:l}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function pn(e){return e instanceof Promise||!(null===e||!bn(e)&&"object"!=typeof e||!bn(e.then))}function yn(e,t){var n,r,i=Pt([[],[]],2),o=i[0],a=i[1];try{for(var s=Kt(e),u=s.next();!u.done;u=s.next()){var c=u.value;t(c)?o.push(c):a.push(c)}}catch(l){n={error:l}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return[o,a]}function vn(e,t){return an(e.states,(function(e,n){if(e){var r=(kn(t)?void 0:t[n])||(e?e.current:void 0);if(r)return{current:r,states:vn(e,r)}}}))}function gn(e,t,n,r){return e?n.reduce((function(e,n){var i,o,a=n.assignment,s={state:r,action:n,_event:t},u={};if(bn(a))u=a(e,t.data,s);else try{for(var c=Kt(Object.keys(a)),l=c.next();!l.done;l=c.next()){var d=l.value,h=a[d];u[d]=bn(h)?h(e,t.data,s):h}}catch(f){i={error:f}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}return Object.assign({},e,u)}),e):e}function mn(e){return Array.isArray(e)}function bn(e){return"function"==typeof e}function kn(e){return"string"==typeof e}function _n(e,t){if(e)return kn(e)?{type:"xstate.guard",name:e,predicate:t?t[e]:void 0}:bn(e)?{type:"xstate.guard",name:e.name,predicate:e}:e}var En=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function Sn(e){return!!e&&"__xstatenode"in e}(Rt={})[En]=function(){return this},Rt[Symbol.observable]=function(){return this};var wn=function(){var e=0;return function(){return(++e).toString(16)}}();function xn(e,t){return kn(e)||"number"==typeof e?Tt({type:e},t):e}function Cn(e,t){if(!kn(e)&&"$$type"in e&&"scxml"===e.$$type)return e;var n=xn(e);return Tt({name:n.type,data:n,$$type:"scxml",type:"external"},t)}function On(e,t){return dn(t).map((function(t){return void 0===t||"string"==typeof t||Sn(t)?{target:t,event:e}:Tt(Tt({},t),{event:e})}))}function Tn(e,t,n,r,i){var o=e.options.guards,a={state:i,cond:t,_event:r};if("xstate.guard"===t.type)return((null==o?void 0:o[t.name])||t.predicate)(n,r.data,a);var s=null==o?void 0:o[t.type];if(!s)throw new Error("Guard '".concat(t.type,"' is not implemented on machine '").concat(e.id,"'."));return s(n,r.data,a)}function In(e){return"string"==typeof e?{type:e}:e}function Kn(e,t,n){if("object"==typeof e)return e;var r=function(){};return{next:e,error:t||r,complete:n||r}}function Pn(e,t){return"".concat(e,":invocation[").concat(t,"]")}var An=Cn({type:Vt});function Rn(e,t){return t&&t[e]||void 0}function Ln(e,t){var n;if(kn(e)||"number"==typeof e)n=bn(r=Rn(e,t))?{type:e,exec:r}:r||{type:e,exec:void 0};else if(bn(e))n={type:e.name||e.toString(),exec:e};else{var r;if(bn(r=Rn(e.type,t)))n=Tt(Tt({},e),{exec:r});else if(r){var i=r.type||e.type;n=Tt(Tt(Tt({},r),e),{type:i})}else n=e}return n}var Mn=function(e,t){return e?(mn(e)?e:[e]).map((function(e){return Ln(e,t)})):[]};function jn(e){var t=Ln(e);return Tt(Tt({id:kn(e)?e:t.id},t),{type:t.type})}function Nn(e){return kn(e)?{type:jt,event:e}:Fn(e,{to:xt.Internal})}function Dn(e){return{type:jt,_event:Cn(e.event)}}function Fn(e,t){return{to:t?t.to:void 0,type:Nt,event:bn(e)?e:xn(e),delay:t?t.delay:void 0,id:t&&void 0!==t.id?t.id:bn(e)?e.name:tn(e)}}function Hn(e,t,n,r){var i,o={_event:n},a=Cn(bn(e.event)?e.event(t,n.data,o):e.event);if(kn(e.delay)){var s=r&&r[e.delay];i=bn(s)?s(t,n.data,o):s}else i=bn(e.delay)?e.delay(t,n.data,o):e.delay;var u=bn(e.to)?e.to(t,n.data,o):e.to;return Tt(Tt({},e),{to:u,_event:a,event:a.data,delay:i})}function Un(e,t){return Fn(e,Tt(Tt({},t),{to:xt.Parent}))}var qn=function(e,t){return{context:e,event:t}};var Bn=function(e,t,n){return Tt(Tt({},e),{value:kn(e.expr)?e.expr:e.expr(t,n.data,{_event:n})})},Vn=function(e){return{type:Dt,sendId:e}};function Gn(e){var t=jn(e);return{type:St.Start,activity:t,exec:void 0}}function zn(e){var t=bn(e)?e:jn(e);return{type:St.Stop,activity:t,exec:void 0}}function $n(e,t,n){var r=bn(e.activity)?e.activity(t,n.data):e.activity,i="string"==typeof r?{id:r}:r;return{type:St.Stop,activity:i}}var Wn=function(e){return{type:Ht,assignment:e}};function Jn(e,t){var n=t?"#".concat(t):"";return"".concat(St.After,"(").concat(e,")").concat(n)}function Xn(e,t){var n="".concat(St.DoneState,".").concat(e),r={type:n,data:t,toString:function(){return n}};return r}function Qn(e,t){var n="".concat(St.DoneInvoke,".").concat(e),r={type:n,data:t,toString:function(){return n}};return r}function Zn(e,t){var n="".concat(St.ErrorPlatform,".").concat(e),r={type:n,data:t,toString:function(){return n}};return r}function Yn(e,t,n,r,i,o){void 0===o&&(o=!1);var a=Pt(o?[[],i]:yn(i,(function(e){return e.type===Ht})),2),s=a[0],u=a[1],c=s.length?gn(n,r,s,t):n,l=o?[n]:void 0;return[ln(u.map((function(n){var i;switch(n.type){case jt:return Dn(n);case Nt:return Hn(n,c,r,e.options.delays);case Bt:return Bn(n,c,r);case Xt:if(!(d=null===(i=n.conds.find((function(n){var i=_n(n.cond,e.options.guards);return!i||Tn(e,i,c,r,t)})))||void 0===i?void 0:i.actions))return[];var a=Pt(Yn(e,t,c,r,Mn(hn(d),e.options.actions),o),2),s=a[0],u=a[1];return c=u,null==l||l.push(c),s;case Qt:var d;if(!(d=n.get(c,r.data)))return[];var h=Pt(Yn(e,t,c,r,Mn(hn(d),e.options.actions),o),2),f=h[0],p=h[1];return c=p,null==l||l.push(c),f;case Mt:return $n(n,c,r);case Ht:c=gn(c,r,[n],t),null==l||l.push(c);break;default:var y=Ln(n,e.options.actions),v=y.exec;if(v&&l){var g=l.length-1;y=Tt(Tt({},y),{exec:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];v.apply(void 0,At([l[g]],Pt(t),!1))}})}return y}})).filter((function(e){return!!e}))),c]}var er=Object.freeze(Object.defineProperty({__proto__:null,actionTypes:Zt,after:Jn,assign:Wn,cancel:Vn,choose:function(e){return{type:St.Choose,conds:e}},done:Xn,doneInvoke:Qn,error:Zn,escalate:function(e,t){return Un((function(t,n,r){return{type:Wt,data:bn(e)?e(t,n,r):e}}),Tt(Tt({},t),{to:xt.Parent}))},forwardTo:function(e,t){return Fn((function(e,t){return t}),Tt(Tt({},t),{to:e}))},getActionFunction:Rn,initEvent:An,isActionObject:function(e){return"object"==typeof e&&"type"in e},log:function(e,t){return void 0===e&&(e=qn),{type:Bt,label:t,expr:e}},pure:function(e){return{type:St.Pure,get:e}},raise:Nn,resolveActions:Yn,resolveLog:Bn,resolveRaise:Dn,resolveSend:Hn,resolveStop:$n,respond:function(e,t){return Fn(e,Tt(Tt({},t),{to:function(e,t,n){return n._event.origin}}))},send:Fn,sendParent:Un,sendTo:function(e,t,n){return Fn(t,Tt(Tt({},n),{to:e}))},sendUpdate:function(){return Un(Jt)},start:Gn,stop:zn,toActionObject:Ln,toActionObjects:Mn,toActivityDefinition:jn},Symbol.toStringTag,{value:"Module"})),tr=[],nr=function(e,t){tr.push(e);var n=t(e);return tr.pop(),n};function rr(e){var t;return(t={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:e}}})[En]=function(){return this},t}function ir(e,t,n){var r=rr(t);if(r.deferred=!0,Sn(e)){var i=r.state=nr(void 0,(function(){return(n?e.withContext(n):e).initialState}));r.getSnapshot=function(){return i}}return r}var or=function(e){return"atomic"===e.type||"final"===e.type};function ar(e){return Object.keys(e.states).map((function(t){return e.states[t]})).filter((function(e){return"history"!==e.type}))}function sr(e){var t=[e];return or(e)?t:t.concat(ln(ar(e).map(sr)))}function ur(e,t){var n,r,i,o,a,s,u,c,l=lr(new Set(e)),d=new Set(t);try{for(var h=Kt(d),f=h.next();!f.done;f=h.next())for(var p=(S=f.value).parent;p&&!d.has(p);)d.add(p),p=p.parent}catch(w){n={error:w}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}var y=lr(d);try{for(var v=Kt(d),g=v.next();!g.done;g=v.next()){if("compound"!==(S=g.value).type||y.get(S)&&y.get(S).length){if("parallel"===S.type)try{for(var m=(a=void 0,Kt(ar(S))),b=m.next();!b.done;b=m.next()){var k=b.value;d.has(k)||(d.add(k),l.get(k)?l.get(k).forEach((function(e){return d.add(e)})):k.initialStateNodes.forEach((function(e){return d.add(e)})))}}catch(x){a={error:x}}finally{try{b&&!b.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}}else l.get(S)?l.get(S).forEach((function(e){return d.add(e)})):S.initialStateNodes.forEach((function(e){return d.add(e)}))}}catch(C){i={error:C}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}try{for(var _=Kt(d),E=_.next();!E.done;E=_.next()){var S;for(p=(S=E.value).parent;p&&!d.has(p);)d.add(p),p=p.parent}}catch(O){u={error:O}}finally{try{E&&!E.done&&(c=_.return)&&c.call(_)}finally{if(u)throw u.error}}return d}function cr(e,t){var n=t.get(e);if(!n)return{};if("compound"===e.type){var r=n[0];if(!r)return{};if(or(r))return r.key}var i={};return n.forEach((function(e){i[e.key]=cr(e,t)})),i}function lr(e){var t,n,r=new Map;try{for(var i=Kt(e),o=i.next();!o.done;o=i.next()){var a=o.value;r.has(a)||r.set(a,[]),a.parent&&(r.has(a.parent)||r.set(a.parent,[]),r.get(a.parent).push(a))}}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function dr(e,t){return cr(e,lr(ur([e],t)))}function hr(e,t){return Array.isArray(e)?e.some((function(e){return e===t})):e instanceof Set&&e.has(t)}function fr(e,t){return"compound"===t.type?ar(t).some((function(t){return"final"===t.type&&hr(e,t)})):"parallel"===t.type&&ar(t).every((function(t){return fr(e,t)}))}function pr(e){return new Set(ln(e.map((function(e){return e.tags}))))}function yr(e,t){if(e===t)return!0;if(void 0===e||void 0===t)return!1;if(kn(e)||kn(t))return e===t;var n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every((function(n){return yr(e[n],t[n])}))}var vr=function(){function e(e){var t,n,r=this;this.actions=[],this.activities=Yt,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||Yt,this.meta=(void 0===(n=e.configuration)&&(n=[]),n.reduce((function(e,t){return void 0!==t.meta&&(e[t.id]=t.meta),e}),{})),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=null!==(t=Array.isArray(e.tags)?new Set(e.tags):e.tags)&&void 0!==t?t:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return function(e){return At([],Pt(new Set(ln(At([],Pt(e.map((function(e){return e.ownEvents}))),!1)))),!1)}(r.configuration)}})}return e.from=function(t,n){return t instanceof e?t.context!==n?new e({value:t.value,context:n,_event:t._event,_sessionid:null,historyValue:t.historyValue,history:t.history,actions:[],activities:t.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):t:new e({value:t,context:n,_event:An,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},e.create=function(t){return new e(t)},e.inert=function(t,n){if(t instanceof e){if(!t.actions.length)return t;var r=An;return new e({value:t.value,context:n,_event:r,_sessionid:null,historyValue:t.historyValue,history:t.history,activities:t.activities,configuration:t.configuration,transitions:[],children:{}})}return e.from(t,n)},e.prototype.toStrings=function(e,t){var n=this;if(void 0===e&&(e=this.value),void 0===t&&(t="."),kn(e))return[e];var r=Object.keys(e);return r.concat.apply(r,At([],Pt(r.map((function(r){return n.toStrings(e[r],t).map((function(e){return r+t+e}))}))),!1))},e.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var t=e.tags;e.machine;var n=It(e,["configuration","transitions","tags","machine"]);return Tt(Tt({},n),{tags:Array.from(t)})},e.prototype.matches=function(e){return en(e,this.value)},e.prototype.hasTag=function(e){return this.tags.has(e)},e.prototype.can=function(e){var t;this.machine;var n=null===(t=this.machine)||void 0===t?void 0:t.getTransitionData(this,e);return!!(null==n?void 0:n.transitions.length)&&n.transitions.some((function(e){return void 0!==e.target||e.actions.length}))},e}(),gr={deferEvents:!1},mr=function(){function e(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=Tt(Tt({},gr),e)}return e.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents)return void this.schedule(e);this.process(e)}this.flushEvents()},e.prototype.schedule=function(e){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()}else this.queue.push(e)},e.prototype.clear=function(){this.queue=[]},e.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},e.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(t){throw this.clear(),t}finally{this.processingEvent=!1}},e}(),br=new Map,kr=0,_r=function(){return"x:".concat(kr++)},Er=function(e,t){return br.set(e,t),e},Sr=function(e){return br.get(e)},wr=function(e){br.delete(e)};function xr(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0}function Cr(e){if(xr()){var t=function(){var e=xr();if(e&&"__xstate__"in e)return e.__xstate__}();t&&t.register(e)}}function Or(e,t){void 0===t&&(t={});var n,r,i=e.initialState,o=new Set,a=[],s=!1,u=(n={id:t.id,send:function(t){a.push(t),function(){if(!s){for(s=!0;a.length>0;){var t=a.shift();i=e.transition(i,t,c),o.forEach((function(e){return e.next(i)}))}s=!1}}()},getSnapshot:function(){return i},subscribe:function(e,t,n){var r=Kn(e,t,n);return o.add(r),r.next(i),{unsubscribe:function(){o.delete(r)}}}},Tt(((r={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[En]=function(){return this},r),n)),c={parent:t.parent,self:u,id:t.id||"anonymous",observers:o};return i=e.start?e.start(c):i,u}var Tr,Ir,Kr={sync:!1,autoForward:!1};(Ir=Tr||(Tr={}))[Ir.NotStarted=0]="NotStarted",Ir[Ir.Running=1]="Running",Ir[Ir.Stopped=2]="Stopped";var Pr=function(){function e(t,n){var r=this;void 0===n&&(n=e.defaultOptions),this.machine=t,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=Tr.NotStarted,this.children=new Map,this.forwardTo=new Set,this.init=this.start,this.send=function(e,t){if(mn(e))return r.batch(e),r.state;var n=Cn(xn(e,t));if(r.status===Tr.Stopped)return r.state;if(r.status!==Tr.Running&&!r.options.deferEvents)throw new Error('Event "'.concat(n.name,'" was sent to uninitialized service "').concat(r.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(n.data)));return r.scheduler.schedule((function(){r.forward(n);var e=r.nextState(n);r.update(e,n)})),r._state},this.sendTo=function(e,t){var n,i=r.parent&&(t===xt.Parent||r.parent.id===t),o=i?r.parent:kn(t)?r.children.get(t)||Sr(t):(n=t)&&"function"==typeof n.send?t:void 0;if(o)"machine"in o?o.send(Tt(Tt({},e),{name:e.name===Wt?"".concat(Zn(r.id)):e.name,origin:r.sessionId})):o.send(e.data);else if(!i)throw new Error("Unable to send event to child '".concat(t,"' from service '").concat(r.id,"'."))};var i=Tt(Tt({},e.defaultOptions),n),o=i.clock,a=i.logger,s=i.parent,u=i.id,c=void 0!==u?u:t.id;this.id=c,this.logger=a,this.clock=o,this.parent=s,this.options=i,this.scheduler=new mr({deferEvents:this.options.deferEvents}),this.sessionId=_r()}return Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:nr(this,(function(){return e._initialState=e.machine.initialState,e._initialState}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(e,t){var n,r;try{for(var i=Kt(e.actions),o=i.next();!o.done;o=i.next()){var a=o.value;this.exec(a,e,t)}}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.update=function(e,t){var n,r,i,o,a,s,u,c,l=this;if(e._sessionid=this.sessionId,this._state=e,this.options.execute&&this.execute(this.state),this.children.forEach((function(e){l.state.children[e.id]=e})),this.devTools&&this.devTools.send(t.data,e),e.event)try{for(var d=Kt(this.eventListeners),h=d.next();!h.done;h=d.next()){(0,h.value)(e.event)}}catch(E){n={error:E}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}try{for(var f=Kt(this.listeners),p=f.next();!p.done;p=f.next()){(0,p.value)(e,e.event)}}catch(S){i={error:S}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}try{for(var y=Kt(this.contextListeners),v=y.next();!v.done;v=y.next()){(0,v.value)(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(w){a={error:w}}finally{try{v&&!v.done&&(s=y.return)&&s.call(y)}finally{if(a)throw a.error}}var g=fr(e.configuration||[],this.machine);if(this.state.configuration&&g){var m=e.configuration.find((function(e){return"final"===e.type&&e.parent===l.machine})),b=m&&m.doneData?fn(m.doneData,e.context,t):void 0;try{for(var k=Kt(this.doneListeners),_=k.next();!_.done;_=k.next()){(0,_.value)(Qn(this.id,b))}}catch(x){u={error:x}}finally{try{_&&!_.done&&(c=k.return)&&c.call(k)}finally{if(u)throw u.error}}this.stop()}},e.prototype.onTransition=function(e){return this.listeners.add(e),this.status===Tr.Running&&e(this.state,this.state.event),this},e.prototype.subscribe=function(e,t,n){var r,i=this;if(!e)return{unsubscribe:function(){}};var o=n;return"function"==typeof e?r=e:(r=e.next.bind(e),o=e.complete.bind(e)),this.listeners.add(r),this.status!==Tr.NotStarted&&r(this.state),o&&(this.status===Tr.Stopped?o():this.onDone(o)),{unsubscribe:function(){r&&i.listeners.delete(r),o&&i.doneListeners.delete(o)}}},e.prototype.onEvent=function(e){return this.eventListeners.add(e),this},e.prototype.onSend=function(e){return this.sendListeners.add(e),this},e.prototype.onChange=function(e){return this.contextListeners.add(e),this},e.prototype.onStop=function(e){return this.stopListeners.add(e),this},e.prototype.onDone=function(e){return this.doneListeners.add(e),this},e.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},e.prototype.start=function(e){var t=this;if(this.status===Tr.Running)return this;this.machine._init(),Er(this.sessionId,this),this.initialized=!0,this.status=Tr.Running;var n=void 0===e?this.initialState:nr(this,(function(){return"object"==typeof(n=e)&&null!==n&&"value"in n&&"_event"in n?t.machine.resolveState(e):t.machine.resolveState(vr.from(e,t.machine.context));var n}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){t.update(n,An)})),this},e.prototype.stop=function(){var e,t,n,r,i,o,a,s,u,c,l=this;try{for(var d=Kt(this.listeners),h=d.next();!h.done;h=d.next()){var f=h.value;this.listeners.delete(f)}}catch(S){e={error:S}}finally{try{h&&!h.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}try{for(var p=Kt(this.stopListeners),y=p.next();!y.done;y=p.next()){(f=y.value)(),this.stopListeners.delete(f)}}catch(w){n={error:w}}finally{try{y&&!y.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}try{for(var v=Kt(this.contextListeners),g=v.next();!g.done;g=v.next()){f=g.value;this.contextListeners.delete(f)}}catch(x){i={error:x}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}try{for(var m=Kt(this.doneListeners),b=m.next();!b.done;b=m.next()){f=b.value;this.doneListeners.delete(f)}}catch(C){a={error:C}}finally{try{b&&!b.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}if(!this.initialized)return this;At([],Pt(this.state.configuration),!1).sort((function(e,t){return t.order-e.order})).forEach((function(e){var t,n;try{for(var r=Kt(e.definition.exit),i=r.next();!i.done;i=r.next()){var o=i.value;l.exec(o,l.state)}}catch(a){t={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}})),this.children.forEach((function(e){bn(e.stop)&&e.stop()})),this.children.clear();try{for(var k=Kt(Object.keys(this.delayedEventsMap)),_=k.next();!_.done;_=k.next()){var E=_.value;this.clock.clearTimeout(this.delayedEventsMap[E])}}catch(O){u={error:O}}finally{try{_&&!_.done&&(c=k.return)&&c.call(k)}finally{if(u)throw u.error}}return this.scheduler.clear(),this.scheduler=new mr({deferEvents:this.options.deferEvents}),this.initialized=!1,this.status=Tr.Stopped,this._initialState=void 0,wr(this.sessionId),this},e.prototype.batch=function(e){var t=this;if(this.status===Tr.NotStarted&&this.options.deferEvents);else if(this.status!==Tr.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));this.scheduler.schedule((function(){var n,r,i=t.state,o=!1,a=[],s=function(e){var n=Cn(e);t.forward(n),i=nr(t,(function(){return t.machine.transition(i,n)})),a.push.apply(a,At([],Pt(i.actions.map((function(e){return n=i,r=(t=e).exec,Tt(Tt({},t),{exec:void 0!==r?function(){return r(n.context,n.event,{action:t,state:n,_event:n._event})}:void 0});var t,n,r}))),!1)),o=o||!!i.changed};try{for(var u=Kt(e),c=u.next();!c.done;c=u.next()){s(c.value)}}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}i.changed=o,i.actions=a,t.update(i,Cn(e[e.length-1]))}))},e.prototype.sender=function(e){return this.send.bind(this,e)},e.prototype.nextState=function(e){var t=this,n=Cn(e);if(0===n.name.indexOf($t)&&!this.state.nextEvents.some((function(e){return 0===e.indexOf($t)})))throw n.data.data;return nr(this,(function(){return t.machine.transition(t.state,n)}))},e.prototype.forward=function(e){var t,n;try{for(var r=Kt(this.forwardTo),i=r.next();!i.done;i=r.next()){var o=i.value,a=this.children.get(o);if(!a)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));a.send(e)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.defer=function(e){var t=this;this.delayedEventsMap[e.id]=this.clock.setTimeout((function(){e.to?t.sendTo(e._event,e.to):t.send(e._event)}),e.delay)},e.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},e.prototype.exec=function(e,t,n){void 0===n&&(n=this.machine.options.actions);var r=t.context,i=t._event,o=e.exec||Rn(e.type,n),a=bn(o)?o:o?o.exec:e.exec;if(a)try{return a(r,i.data,{action:e,state:this.state,_event:i})}catch(b){throw this.parent&&this.parent.send({type:"xstate.error",data:b}),b}switch(e.type){case Nt:var s=e;if("number"==typeof s.delay)return void this.defer(s);s.to?this.sendTo(s._event,s.to):this.send(s._event);break;case Dt:this.cancel(e.sendId);break;case Lt:if(this.status!==Tr.Running)return;var u=e.activity;if(!this.state.activities[u.id||u.type])break;if(u.type===St.Invoke){var c=In(u.src),l=this.machine.options.services?this.machine.options.services[c.type]:void 0,d=u.id,h=u.data,f="autoForward"in u?u.autoForward:!!u.forward;if(!l)return;var p=h?fn(h,r,i):void 0;if("string"==typeof l)return;var y=bn(l)?l(r,i.data,{data:p,src:c,meta:u.meta}):l;if(!y)return;var v=void 0;Sn(y)&&(y=p?y.withContext(p):y,v={autoForward:f}),this.spawn(y,d,v)}else this.spawnActivity(u);break;case Mt:this.stopChild(e.activity.id);break;case Bt:var g=e.label,m=e.value;g?this.logger(g,m):this.logger(m)}},e.prototype.removeChild=function(e){var t;this.children.delete(e),this.forwardTo.delete(e),null===(t=this.state)||void 0===t||delete t.children[e]},e.prototype.stopChild=function(e){var t=this.children.get(e);t&&(this.removeChild(e),bn(t.stop)&&t.stop())},e.prototype.spawn=function(e,t,n){if(pn(e))return this.spawnPromise(Promise.resolve(e),t);if(bn(e))return this.spawnCallback(e,t);if(function(e){try{return"function"==typeof e.send}catch(t){return!1}}(i=e)&&"id"in i)return this.spawnActor(e,t);if(function(e){try{return"subscribe"in e&&bn(e.subscribe)}catch(t){return!1}}(e))return this.spawnObservable(e,t);if(Sn(e))return this.spawnMachine(e,Tt(Tt({},n),{id:t}));if(null!==(r=e)&&"object"==typeof r&&"transition"in r&&"function"==typeof r.transition)return this.spawnBehavior(e,t);throw new Error('Unable to spawn entity "'.concat(t,'" of type "').concat(typeof e,'".'));var r,i},e.prototype.spawnMachine=function(t,n){var r=this;void 0===n&&(n={});var i=new e(t,Tt(Tt({},this.options),{parent:this,id:n.id||t.id})),o=Tt(Tt({},Kr),n);o.sync&&i.onTransition((function(e){r.send(Jt,{state:e,id:i.id})}));var a=i;return this.children.set(i.id,a),o.autoForward&&this.forwardTo.add(i.id),i.onDone((function(e){r.removeChild(i.id),r.send(Cn(e,{origin:i.id}))})).start(),a},e.prototype.spawnBehavior=function(e,t){var n=Or(e,{id:t,parent:this});return this.children.set(t,n),n},e.prototype.spawnPromise=function(e,t){var n,r,i=this,o=!1;e.then((function(e){o||(r=e,i.removeChild(t),i.send(Cn(Qn(t,e),{origin:t})))}),(function(e){if(!o){i.removeChild(t);var n=Zn(t,e);try{i.send(Cn(n,{origin:t}))}catch(r){i.devTools&&i.devTools.send(n,i.state),i.machine.strict&&i.stop()}}}));var a=((n={id:t,send:function(){},subscribe:function(t,n,r){var i=Kn(t,n,r),o=!1;return e.then((function(e){o||(i.next(e),o||i.complete())}),(function(e){o||i.error(e)})),{unsubscribe:function(){return o=!0}}},stop:function(){o=!0},toJSON:function(){return{id:t}},getSnapshot:function(){return r}})[En]=function(){return this},n);return this.children.set(t,a),a},e.prototype.spawnCallback=function(e,t){var n,r,i,o=this,a=!1,s=new Set,u=new Set;try{i=e((function(e){r=e,u.forEach((function(t){return t(e)})),a||o.send(Cn(e,{origin:t}))}),(function(e){s.add(e)}))}catch(l){this.send(Zn(t,l))}if(pn(i))return this.spawnPromise(i,t);var c=((n={id:t,send:function(e){return s.forEach((function(t){return t(e)}))},subscribe:function(e){var t=Kn(e);return u.add(t.next),{unsubscribe:function(){u.delete(t.next)}}},stop:function(){a=!0,bn(i)&&i()},toJSON:function(){return{id:t}},getSnapshot:function(){return r}})[En]=function(){return this},n);return this.children.set(t,c),c},e.prototype.spawnObservable=function(e,t){var n,r,i=this,o=e.subscribe((function(e){r=e,i.send(Cn(e,{origin:t}))}),(function(e){i.removeChild(t),i.send(Cn(Zn(t,e),{origin:t}))}),(function(){i.removeChild(t),i.send(Cn(Qn(t),{origin:t}))})),a=((n={id:t,send:function(){},subscribe:function(t,n,r){return e.subscribe(t,n,r)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return r},toJSON:function(){return{id:t}}})[En]=function(){return this},n);return this.children.set(t,a),a},e.prototype.spawnActor=function(e,t){return this.children.set(t,e),e},e.prototype.spawnActivity=function(e){var t=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(t){var n=t(this.state.context,e);this.spawnEffect(e.id,n)}},e.prototype.spawnEffect=function(e,t){var n;this.children.set(e,((n={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:t||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}})[En]=function(){return this},n))},e.prototype.attachDev=function(){var e=xr();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var t="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(Tt(Tt({name:this.id,autoPause:!0,stateSanitizer:function(e){return{value:e.value,context:e.context,actions:e.actions}}},t),{features:Tt({jump:!1,skip:!1},t?t.features:void 0)}),this.machine),this.devTools.init(this.state)}Cr(this)}},e.prototype.toJSON=function(){return{id:this.id}},e.prototype[En]=function(){return this},e.prototype.getSnapshot=function(){return this.status===Tr.NotStarted?this.initialState:this._state},e.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},e.interpret=Rr,e}();function Ar(e,t){var n=function(e){return kn(e)?Tt(Tt({},Kr),{name:e}):Tt(Tt(Tt({},Kr),{name:wn()}),e)}(t);return function(t){return t?t.spawn(e,n.name,n):ir(e,n.name)}(tr[tr.length-1])}function Rr(e,t){return new Pr(e,t)}function Lr(e){if("string"==typeof e){var t={type:e,toString:function(){return e}};return t}return e}function Mr(e){return Tt(Tt({type:Gt},e),{toJSON:function(){e.onDone,e.onError;var t=It(e,["onDone","onError"]);return Tt(Tt({},t),{type:Gt,src:Lr(e.src)})}})}var jr={},Nr=function(e){return"#"===e[0]},Dr=function(){function e(t,n,r,i){var o,a=this;void 0===r&&(r="context"in t?t.context:void 0),this.config=t,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},n),this.parent=null==i?void 0:i.parent,this.key=this.config.key||(null==i?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||At([this.machine.key],Pt(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(o=this.config.schema)&&void 0!==o?o:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?an(this.config.states,(function(t,n){var r,i=new e(t,{},void 0,{parent:a,key:n});return Object.assign(a.idMap,Tt(((r={})[i.id]=i,r),i.idMap)),i})):jr;var s=0;!function e(t){var n,r;t.order=s++;try{for(var i=Kt(ar(t)),o=i.next();!o.done;o=i.next()){e(o.value)}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(e){return""===e.event})):""in this.config.on),this.strict=!!this.config.strict,this.onEntry=hn(this.config.entry||this.config.onEntry).map((function(e){return Ln(e)})),this.onExit=hn(this.config.exit||this.config.onExit).map((function(e){return Ln(e)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=hn(this.config.invoke).map((function(e,t){var n,r;if(Sn(e)){var i=Pn(a.id,t);return a.machine.options.services=Tt(((n={})[i]=e,n),a.machine.options.services),Mr({src:i,id:i})}if(kn(e.src)){i=e.id||Pn(a.id,t);return Mr(Tt(Tt({},e),{id:i,src:e.src}))}if(Sn(e.src)||bn(e.src)){i=e.id||Pn(a.id,t);return a.machine.options.services=Tt(((r={})[i]=e.src,r),a.machine.options.services),Mr(Tt(Tt({id:i},e),{src:i}))}var o=e.src;return Mr(Tt(Tt({id:Pn(a.id,t)},e),{src:o}))})),this.activities=hn(this.config.activities).concat(this.invoke).map((function(e){return jn(e)})),this.transition=this.transition.bind(this),this.tags=hn(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||sr(this).forEach((function(e){return e.on}))},e.prototype.withConfig=function(t,n){var r=this.options,i=r.actions,o=r.activities,a=r.guards,s=r.services,u=r.delays;return new e(this.config,{actions:Tt(Tt({},i),t.actions),activities:Tt(Tt({},o),t.activities),guards:Tt(Tt({},a),t.guards),services:Tt(Tt({},s),t.services),delays:Tt(Tt({},u),t.delays)},null!=n?n:this.context)},e.prototype.withContext=function(t){return new e(this.config,this.options,t)},Object.defineProperty(e.prototype,"context",{get:function(){return bn(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:an(this.states,(function(e){return e.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},Object.defineProperty(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce((function(e,t){return e[t.eventType]=e[t.eventType]||[],e[t.eventType].push(t),e}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=""===e,n=this.transitions.filter((function(n){var r=n.eventType===e;return t?r:r||"*"===n.eventType}));return this.__cache.candidates[e]=n,n},e.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var n=function(t,n){var r=Jn(bn(t)?"".concat(e.id,":delay[").concat(n,"]"):t,e.id);return e.onEntry.push(Fn(r,{delay:t})),e.onExit.push(Vn(r)),r};return(mn(t)?t.map((function(e,t){var r=n(e.delay,t);return Tt(Tt({},e),{event:r})})):ln(Object.keys(t).map((function(e,r){var i=t[e],o=kn(i)?{target:i}:i,a=isNaN(+e)?e:+e,s=n(a,r);return hn(o).map((function(e){return Tt(Tt({},e),{event:s,delay:a})}))})))).map((function(t){var n=t.delay;return Tt(Tt({},e.formatTransition(t)),{delay:n})}))},e.prototype.getStateNodes=function(e){var t,n=this;if(!e)return[];var r=e instanceof vr?e.value:rn(e,this.delimiter);if(kn(r)){var i=this.getStateNode(r).initial;return void 0!==i?this.getStateNodes(((t={})[r]=i,t)):[this,this.states[r]]}var o=Object.keys(r),a=[this];return a.push.apply(a,At([],Pt(ln(o.map((function(e){return n.getStateNode(e).getStateNodes(r[e])})))),!1)),a},e.prototype.handles=function(e){var t=tn(e);return this.events.includes(t)},e.prototype.resolveState=function(e){var t=e instanceof vr?e:vr.create(e),n=Array.from(ur([],this.getStateNodes(t.value)));return new vr(Tt(Tt({},t),{value:this.resolve(t.value),configuration:n,done:fr(n,this),tags:pr(n),machine:this.machine}))},e.prototype.transitionLeafNode=function(e,t,n){var r=this.getStateNode(e).next(t,n);return r&&r.transitions.length?r:this.next(t,n)},e.prototype.transitionCompoundNode=function(e,t,n){var r=Object.keys(e),i=this.getStateNode(r[0])._transition(e[r[0]],t,n);return i&&i.transitions.length?i:this.next(t,n)},e.prototype.transitionParallelNode=function(e,t,n){var r,i,o={};try{for(var a=Kt(Object.keys(e)),s=a.next();!s.done;s=a.next()){var u=s.value,c=e[u];if(c){var l=this.getStateNode(u)._transition(c,t,n);l&&(o[u]=l)}}}catch(y){r={error:y}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}var d=Object.keys(o).map((function(e){return o[e]})),h=ln(d.map((function(e){return e.transitions})));if(!d.some((function(e){return e.transitions.length>0})))return this.next(t,n);var f=ln(d.map((function(e){return e.entrySet}))),p=ln(Object.keys(o).map((function(e){return o[e].configuration})));return{transitions:h,entrySet:f,exitSet:ln(d.map((function(e){return e.exitSet}))),configuration:p,source:t,actions:ln(Object.keys(o).map((function(e){return o[e].actions})))}},e.prototype._transition=function(e,t,n){return kn(e)?this.transitionLeafNode(e,t,n):1===Object.keys(e).length?this.transitionCompoundNode(e,t,n):this.transitionParallelNode(e,t,n)},e.prototype.getTransitionData=function(e,t){return this._transition(e.value,e,Cn(t))},e.prototype.next=function(e,t){var n,r,i,o=this,a=t.name,s=[],u=[];try{for(var c=Kt(this.getCandidates(a)),l=c.next();!l.done;l=c.next()){var d=l.value,h=d.cond,f=d.in,p=e.context,y=!f||(kn(f)&&Nr(f)?e.matches(rn(this.getStateNodeById(f).path,this.delimiter)):en(rn(f,this.delimiter),un(this.path.slice(0,-2))(e.value))),v=!1;try{v=!h||Tn(this.machine,h,p,t,e)}catch(b){throw new Error("Unable to evaluate guard '".concat(h.name||h.type,"' in transition for event '").concat(a,"' in state node '").concat(this.id,"':\n").concat(b.message))}if(v&&y){void 0!==d.target&&(u=d.target),s.push.apply(s,At([],Pt(d.actions),!1)),i=d;break}}}catch(k){n={error:k}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}if(i){if(!u.length)return{transitions:[i],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:s};var g=ln(u.map((function(t){return o.getRelativeStateNodes(t,e.historyValue)}))),m=!!i.internal;return{transitions:[i],entrySet:m?[]:ln(g.map((function(e){return o.nodesFromChild(e)}))),exitSet:m?[]:[this],configuration:g,source:e,actions:s}}},e.prototype.nodesFromChild=function(e){if(e.escapes(this))return[];for(var t=[],n=e;n&&n!==this;)t.push(n),n=n.parent;return t.push(this),t},e.prototype.escapes=function(e){if(this===e)return!1;for(var t=this.parent;t;){if(t===e)return!1;t=t.parent}return!0},e.prototype.getActions=function(e,t,n,r){var i,o,a,s,u=ur([],r?this.getStateNodes(r.value):[this]),c=e.configuration.length?ur(u,e.configuration):u;try{for(var l=Kt(c),d=l.next();!d.done;d=l.next()){hr(u,p=d.value)||e.entrySet.push(p)}}catch(_){i={error:_}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}try{for(var h=Kt(u),f=h.next();!f.done;f=h.next()){var p;hr(c,p=f.value)&&!hr(e.exitSet,p.parent)||e.exitSet.push(p)}}catch(E){a={error:E}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}var y=ln(e.entrySet.map((function(r){var i=[];if("final"!==r.type)return i;var o=r.parent;if(!o.parent)return i;i.push(Xn(r.id,r.doneData),Xn(o.id,r.doneData?fn(r.doneData,t,n):void 0));var a=o.parent;return"parallel"===a.type&&ar(a).every((function(t){return fr(e.configuration,t)}))&&i.push(Xn(a.id)),i})));e.exitSet.sort((function(e,t){return t.order-e.order})),e.entrySet.sort((function(e,t){return e.order-t.order}));var v=new Set(e.entrySet),g=new Set(e.exitSet),m=Pt([ln(Array.from(v).map((function(e){return At(At([],Pt(e.activities.map((function(e){return Gn(e)}))),!1),Pt(e.onEntry),!1)}))).concat(y.map(Nn)),ln(Array.from(g).map((function(e){return At(At([],Pt(e.onExit),!1),Pt(e.activities.map((function(e){return zn(e)}))),!1)})))],2),b=m[0],k=m[1];return Mn(k.concat(e.actions).concat(b),this.machine.options.actions)},e.prototype.transition=function(e,t,n){void 0===e&&(e=this.initialState);var r,i,o=Cn(t);if(e instanceof vr)r=void 0===n?e:this.resolveState(vr.from(e,n));else{var a=kn(e)?this.resolve(on(this.getResolvedPath(e))):this.resolve(e),s=null!=n?n:this.machine.context;r=this.resolveState(vr.from(a,s))}if(this.strict&&!this.events.includes(o.name)&&(i=o.name,!/^(done|error)\./.test(i)))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(o.name,"'"));var u=this._transition(r.value,r,o)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:r,actions:[]},c=ur([],this.getStateNodes(r.value)),l=u.configuration.length?ur(c,u.configuration):c;return u.configuration=At([],Pt(l),!1),this.resolveTransition(u,r,r.context,o)},e.prototype.resolveRaisedTransition=function(e,t,n){var r,i=e.actions;return(e=this.transition(e,t))._event=n,e.event=n.data,(r=e.actions).unshift.apply(r,At([],Pt(i),!1)),e},e.prototype.resolveTransition=function(e,t,n,r){var i,o,a=this;void 0===r&&(r=An);var s=e.configuration,u=!t||e.transitions.length>0,c=u?dr(this.machine,s):void 0,l=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,d=this.getActions(e,n,r,t),h=t?Tt({},t.activities):{};try{for(var f=Kt(d),p=f.next();!p.done;p=f.next()){var y=p.value;y.type===Lt?h[y.activity.id||y.activity.type]=y:y.type===Mt&&(h[y.activity.id||y.activity.type]=!1)}}catch(L){i={error:L}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}var v,g,m=Pt(Yn(this,t,n,r,d,this.machine.config.preserveActionOrder),2),b=m[0],k=m[1],_=Pt(yn(b,(function(e){return e.type===jt||e.type===Nt&&e.to===xt.Internal})),2),E=_[0],S=_[1],w=b.filter((function(e){var t;return e.type===Lt&&(null===(t=e.activity)||void 0===t?void 0:t.type)===Gt})).reduce((function(e,t){return e[t.activity.id]=function(e,t,n,r){var i,o=In(e.src),a=null===(i=null==t?void 0:t.options.services)||void 0===i?void 0:i[o.type],s=e.data?fn(e.data,n,r):void 0,u=a?ir(a,e.id,s):rr(e.id);return u.meta=e,u}(t.activity,a.machine,k,r),e}),t?Tt({},t.children):{}),x=u?e.configuration:t?t.configuration:[],C=fr(x,this),O=new vr({value:c||t.value,context:k,_event:r,_sessionid:t?t._sessionid:null,historyValue:c?l?(v=l,g=c,{current:g,states:vn(v,g)}):void 0:t?t.historyValue:void 0,history:!c||e.source?t:void 0,actions:c?S:[],activities:c?h:t?t.activities:{},events:[],configuration:x,transitions:e.transitions,children:w,done:C,tags:pr(x),machine:this}),T=n!==k;O.changed=r.name===Jt||T;var I=O.history;I&&delete I.history;var K=!C&&(this._transient||s.some((function(e){return e._transient})));if(!(u||K&&""!==r.name))return O;var P=O;if(!C)for(K&&(P=this.resolveRaisedTransition(P,{type:Ft},r));E.length;){var A=E.shift();P=this.resolveRaisedTransition(P,A._event,r)}var R=P.changed||(I?!!P.actions.length||T||typeof I.value!=typeof P.value||!yr(P.value,I.value):void 0);return P.changed=R,P.history=I,P},e.prototype.getStateNode=function(e){if(Nr(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var t=this.states[e];if(!t)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return t},e.prototype.getStateNodeById=function(e){var t=Nr(e)?e.slice("#".length):e;if(t===this.id)return this;var n=this.machine.idMap[t];if(!n)throw new Error("Child state node '#".concat(t,"' does not exist on machine '").concat(this.id,"'"));return n},e.prototype.getStateNodeByPath=function(e){if("string"==typeof e&&Nr(e))try{return this.getStateNodeById(e.slice(1))}catch(i){}for(var t=nn(e,this.delimiter).slice(),n=this;t.length;){var r=t.shift();if(!r.length)break;n=n.getStateNode(r)}return n},e.prototype.resolve=function(e){var t,n=this;if(!e)return this.initialStateValue||jr;switch(this.type){case"parallel":return an(this.initialStateValue,(function(t,r){return t?n.getStateNode(r).resolve(e[r]||t):jr}));case"compound":if(kn(e)){var r=this.getStateNode(e);return"parallel"===r.type||"compound"===r.type?((t={})[e]=r.initialStateValue,t):e}return Object.keys(e).length?an(e,(function(e,t){return e?n.getStateNode(t).resolve(e):jr})):this.initialStateValue||{};default:return e||jr}},e.prototype.getResolvedPath=function(e){if(Nr(e)){var t=this.machine.idMap[e.slice("#".length)];if(!t)throw new Error("Unable to find state node '".concat(e,"'"));return t.path}return nn(e,this.delimiter)},Object.defineProperty(e.prototype,"initialStateValue",{get:function(){var e,t;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)t=sn(this.states,(function(e){return e.initialStateValue||jr}),(function(e){return!("history"===e.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));t=or(this.states[this.initial])?this.initial:((e={})[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(e,t){this._init();var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,entrySet:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=t?t:this.machine.context,void 0)},Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var e;if("history"===this.type){var t=this.config;e=kn(t.target)&&Nr(t.target)?on(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target}return e},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(e,t,n){return void 0===n&&(n=!0),n?"history"===e.type?e.resolveHistory(t):e.initialStateNodes:[e]},Object.defineProperty(e.prototype,"initialStateNodes",{get:function(){var e=this;return or(this)?[this]:"compound"!==this.type||this.initial?ln(cn(this.initialStateValue).map((function(t){return e.getFromRelativePath(t)}))):[this]},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=Pt(e),n=t[0],r=t.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var i=this.getStateNode(n);if("history"===i.type)return i.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(r)},e.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:sn(this.states,(function(t,n){if(!e)return t.historyValue();var r=kn(e)?void 0:e[n];return t.historyValue(r||t.initialStateValue)}),(function(e){return!e.history}))}},e.prototype.resolveHistory=function(e){var t=this;if("history"!==this.type)return[this];var n=this.parent;if(!e){var r=this.target;return r?ln(cn(r).map((function(e){return n.getFromRelativePath(e)}))):n.initialStateNodes}var i,o,a=(i=n.path,o="states",function(e){var t,n,r=e;try{for(var a=Kt(i),s=a.next();!s.done;s=a.next()){var u=s.value;r=r[o][u]}}catch(c){t={error:c}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r})(e).current;return kn(a)?[n.getStateNode(a)]:ln(cn(a).map((function(e){return"deep"===t.history?n.getFromRelativePath(e):[n.states[e[0]]]})))},Object.defineProperty(e.prototype,"stateIds",{get:function(){var e=this,t=ln(Object.keys(this.states).map((function(t){return e.states[t].stateIds})));return[this.id].concat(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){var e,t,n,r;if(this.__cache.events)return this.__cache.events;var i=this.states,o=new Set(this.ownEvents);if(i)try{for(var a=Kt(Object.keys(i)),s=a.next();!s.done;s=a.next()){var u=i[s.value];if(u.states)try{for(var c=(n=void 0,Kt(u.events)),l=c.next();!l.done;l=c.next()){var d=l.value;o.add("".concat(d))}}catch(h){n={error:h}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}}catch(f){e={error:f}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter((function(e){return!(!e.target&&!e.actions.length&&e.internal)})).map((function(e){return e.eventType})));return Array.from(e)},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(e){var t=this;if(void 0!==e)return e.map((function(e){if(!kn(e))return e;var n=e[0]===t.delimiter;if(n&&!t.parent)return t.getStateNodeByPath(e.slice(1));var r=n?t.key+e:e;if(!t.parent)return t.getStateNodeByPath(r);try{return t.parent.getStateNodeByPath(r)}catch(i){throw new Error("Invalid transition definition for state node '".concat(t.id,"':\n").concat(i.message))}}))},e.prototype.formatTransition=function(e){var t=this,n=function(e){if(void 0!==e&&""!==e)return hn(e)}(e.target),r="internal"in e?e.internal:!n||n.some((function(e){return kn(e)&&e[0]===t.delimiter})),i=this.machine.options.guards,o=this.resolveTarget(n),a=Tt(Tt({},e),{actions:Mn(hn(e.actions)),cond:_n(e.cond,i),target:o,source:this,internal:r,eventType:e.event,toJSON:function(){return Tt(Tt({},a),{target:a.target?a.target.map((function(e){return"#".concat(e.id)})):void 0,source:"#".concat(t.id)})}});return a},e.prototype.formatTransitions=function(){var e,t,n,r=this;if(this.config.on)if(Array.isArray(this.config.on))n=this.config.on;else{var i=this.config.on,o="*",a=i[o],s=void 0===a?[]:a,u=It(i,["*"]);n=ln(Object.keys(u).map((function(e){return On(e,u[e])})).concat(On("*",s)))}else n=[];var c=this.config.always?On("",this.config.always):[],l=this.config.onDone?On(String(Xn(this.id)),this.config.onDone):[],d=ln(this.invoke.map((function(e){var t=[];return e.onDone&&t.push.apply(t,At([],Pt(On(String(Qn(e.id)),e.onDone)),!1)),e.onError&&t.push.apply(t,At([],Pt(On(String(Zn(e.id)),e.onError)),!1)),t}))),h=this.after,f=ln(At(At(At(At([],Pt(l),!1),Pt(d),!1),Pt(n),!1),Pt(c),!1).map((function(e){return hn(e).map((function(e){return r.formatTransition(e)}))})));try{for(var p=Kt(h),y=p.next();!y.done;y=p.next()){var v=y.value;f.push(v)}}catch(g){e={error:g}}finally{try{y&&!y.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}return f},e}();function Fr(e,t,n){return void 0===n&&(n=e.context),new Dr(e,t,n)}var Hr,Ur,qr=Wn,Br=Fn,Vr=Un;(Ur=Hr||(Hr={}))[Ur.Effect=1]="Effect",Ur[Ur.LayoutEffect=2]="LayoutEffect";var Gr=f.exports.useLayoutEffect;function zr(e){var t=f.exports.useRef();return t.current||(t.current={v:e()}),t.current.v}function $r(e,t){var n,r,i=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}([[],[]],2),o=i[0],a=i[1];try{for(var s=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),u=s.next();!u.done;u=s.next()){var c=u.value;t(c)?o.push(c):a.push(c)}}catch(l){n={error:l}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return[o,a]}var Wr=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Jr=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Wr(arguments[t]));return e};function Xr(e,t){(0,e.exec)(t.context,t._event.data,{action:e,state:t,_event:t._event})()}var Qr=function(){return(Qr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Zr(e,t,n){void 0===t&&(t={});var r=zr((function(){return"function"==typeof e?e():e})),i=t.context,o=t.guards,a=t.actions,s=t.activities,u=t.services,c=t.delays,l=t.state,d=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["context","guards","actions","activities","services","delays","state"]),h=zr((function(){var e={context:i,guards:o,actions:a,activities:s,services:u,delays:c};return Rr(r.withConfig(e,Qr(Qr({},r.context),i)),Qr({deferEvents:!0},d))}));return Gr((function(){var e;return n&&(e=h.subscribe(function(e,t,n){if("object"==typeof e)return e;var r=function(){};return{next:e,error:t||r,complete:n||r}}(n))),function(){null==e||e.unsubscribe()}}),[n]),Gr((function(){return h.start(l?vr.create(l):void 0),function(){h.stop()}}),[]),Gr((function(){Object.assign(h.machine.options.actions,a)}),[a]),Gr((function(){Object.assign(h.machine.options.services,u)}),[u]),function(e){var t=f.exports.useRef([]),n=f.exports.useRef([]);Gr((function(){var r=e.subscribe((function(e){var r,i;if(e.actions.length){var o=e.actions.filter((function(e){return"function"==typeof e.exec&&"__effect"in e.exec})),a=Wr($r(o,(function(e){return e.exec.__effect===Hr.Effect})),2),s=a[0],u=a[1];(r=t.current).push.apply(r,Jr(s.map((function(t){return[t,e]})))),(i=n.current).push.apply(i,Jr(u.map((function(t){return[t,e]}))))}}));return function(){r.unsubscribe()}}),[]),Gr((function(){for(;n.current.length;){var e=Wr(n.current.shift(),2);Xr(e[0],e[1])}})),f.exports.useEffect((function(){for(;t.current.length;){var e=Wr(t.current.shift(),2);Xr(e[0],e[1])}}))}(h),h}var Yr=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};var ei=function(){};function ti(e,t){void 0===t&&(t=function(e){return function(e){return"state"in e}(e)?e.state:void 0});var n=f.exports.useRef(e),r=f.exports.useRef([]),i=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}(f.exports.useState((function(){return t(e)})),2),o=i[0],a=i[1],s=zr((function(){return function(e){var t=n.current;(function(e){return"deferred"in e})(t)&&t.deferred?r.current.push(e):t.send(e)}}));return Gr((function(){n.current=e,a(t(e));for(var i=e.subscribe({next:function(e){return a(e)},error:ei,complete:ei});r.current.length>0;){var o=r.current.shift();e.send(o)}return function(){i.unsubscribe()}}),[e]),[o,s]}function ni(e){return 0!==("status"in e?e.status:e._status)?e.state:e.machine.initialState}function ri(e){return[function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}(ti(e,ni),1)[0],e.send]}var ii={exports:{}};function oi(e){return(oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ai(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function si(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ui(e,t,n){return t&&si(e.prototype,t),n&&si(e,n),e}function ci(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function li(){return(li=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function di(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ci(e,t,n[t])}))}return e}function hi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pi(e,t)}function fi(e){return(fi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pi(e,t){return(pi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function vi(e,t,n){return(vi=yi()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&pi(i,n.prototype),i}).apply(null,arguments)}function gi(e){var t="function"==typeof Map?new Map:void 0;return(gi=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return vi(e,arguments,fi(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),pi(r,e)})(e)}function mi(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function bi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ki(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?bi(e):t}function _i(e,t,n){return(_i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fi(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Ei(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Si(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return e.reduce((function(e,n){return e[n]=t||{value:n},e}),{})}var wi={logLevel:"warn",defaultKeyEvent:"keydown",defaultComponent:"div",defaultTabIndex:"-1",ignoreTags:["input","select","textarea"],enableHardSequences:!1,ignoreKeymapAndHandlerChangesByDefault:!0,ignoreEventsCondition:function(e){var t=e.target;if(t&&t.tagName){var n=t.tagName.toLowerCase();return Ci.option("_ignoreTagsDict")[n]||t.isContentEditable}return!1},ignoreRepeatedEventsWhenKeyHeldDown:!0,simulateMissingKeyPressEvents:!0,stopEventPropagationAfterHandling:!0,stopEventPropagationAfterIgnoring:!0,allowCombinationSubmatches:!1,customKeyCodes:{}},xi=di({},wi);xi._ignoreTagsDict=Si(xi.ignoreTags,!0);var Ci=function(){function e(){ai(this,e)}return ui(e,null,[{key:"init",value:function(e){var t=this,n=e.ignoreTags,r=e.customKeyCodes;n&&(e._ignoreTagsDict=Si(e.ignoreTags)),r&&(e._customKeyNamesDict=Si(Object.values(e.customKeyCodes))),-1!==["verbose","debug","info"].indexOf(e.logLevel)&&console.warn("React HotKeys: You have requested log level '".concat(e.logLevel,"' but for performance reasons, logging below severity level 'warning' is disabled in production. Please use the development build for complete logs.")),Object.keys(e).forEach((function(n){t.set(n,e[n])}))}},{key:"set",value:function(e,t){xi[e]=t}},{key:"reset",value:function(e){xi[e]=wi[e]}},{key:"option",value:function(e){return xi[e]}}]),e}(),Oi=function(){function e(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"warn";ai(this,e),ci(this,"verbose",this.noop),ci(this,"debug",this.noop),ci(this,"info",this.noop),ci(this,"warn",this.noop),ci(this,"error",this.noop),this.logLevel=this.constructor.levels[n],this.logLevel>=this.constructor.levels.error&&(this.error=console.error,this.logLevel>=this.constructor.levels.warn&&(this.warn=console.warn,["info","debug","verbose"].some((function(e){return!(t.logLevel>=t.constructor.levels[e]&&(t[e]=console.log,1))}))))}return ui(e,[{key:"noop",value:function(){}}]),e}();ci(Oi,"logIcons",["","","",""]),ci(Oi,"componentIcons",["","","","",""]),ci(Oi,"eventIcons",["","","","","",""]),ci(Oi,"levels",{none:0,error:1,warn:2,info:3,debug:4,verbose:5});var Ti={keydown:0,keypress:1,keyup:2},Ii={Shift:["shiftKey"],Meta:["metaKey"],Control:["ctrlKey"],Alt:["altKey"]},Ki={"`":["~"],1:["!"],2:["@",'"'],3:["#",""],4:["$"],5:["%"],6:["^"],7:["&"],8:["*"],9:["("],0:[")"],"-":["_"],"=":["plus"],";":[":"],"'":['"',"@"],",":["<"],".":[">"],"/":["?"],"\\":["|"],"[":["{"],"]":["}"],"#":["~"]};function Pi(e){return Ki[e]||[1===e.length?e.toUpperCase():e]}function Ai(e,t){return e.hasOwnProperty(t)}function Ri(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce((function(n,r){var i=e[r];return i.forEach((function(e){Ai(n,e)||(n[e]=[]),n[e].push(r)})),t.includeOriginal&&(!Ai(n,r)&&(n[r]=[]),n[r]=[].concat(Ei(n[r]),Ei(i))),n}),{})}var Li=Ri(Ki);function Mi(e){return Li[e]||[1===e.length?e.toLowerCase():e]}var ji=Ri({},{includeOriginal:!0});function Ni(e){return"string"==typeof e}function Di(e){return Ni(e)?e.trim().replace(/\s+/g," "):e}var Fi={tab:"Tab",capslock:"CapsLock",shift:"Shift",meta:"Meta",alt:"Alt",ctrl:"Control",space:" ",spacebar:" ",escape:"Escape",esc:"Escape",left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown",return:"Enter",del:"Delete",command:"Meta",option:"Alt",enter:"Enter",backspace:"Backspace",ins:"Insert",pageup:"PageUp",pagedown:"PageDown",end:"End",home:"Home",contextmenu:"ContextMenu",numlock:"Clear"},Hi={cmd:"Meta"};function Ui(e){var t=e.toLowerCase();return Fi[t]||Hi[t]||(e.match(/^f\d+$/)?e.toUpperCase():e)}var qi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bi=Si(Object.values(qi),!0);function Vi(e){return!!Bi[e]}function Gi(e){return Vi(e)||String.fromCharCode(e.charCodeAt(0))===e||function(e){return Ci.option("_customKeyNamesDict")[e]}(e)}var zi=function(e){function t(){var e,n;ai(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return ci(bi(bi(n=ki(this,(e=fi(t)).call.apply(e,[this].concat(i))))),"name","InvalidKeyNameError"),n}return hi(t,gi(Error)),t}();function $i(e){return e.sort().join("+")}var Wi=function(){function e(){ai(this,e)}return ui(e,null,[{key:"parse",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=Di(e),r=n.split(" ");try{var i=r.slice(0,r.length-1),o=r[r.length-1],a=i.map((function(e){var n=Ji(e,t);return $i(Object.keys(n))})).join(" "),s=Ji(o,t),u=$i(Object.keys(s)),c={id:u,keyDictionary:s,keyEventType:t.keyEventType,size:Object.keys(s).length};return{sequence:{prefix:a,size:i.length+1},combination:c}}catch(l){return{sequence:null,combination:null}}}}]),e}();function Ji(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e.replace(/^\+|(\s|[^+]\+)\+/,"$1plus").split("+").reduce((function(e,n){var r=Ui(n);if(t.ensureValidKeys&&!Gi(r))throw new zi;return e[r]=!0,e}),{})}var Xi={"`":["`"],1:[""],2:[""],3:[""],4:[""],5:[""],6:[""],7:[""],8:[""],9:[""],0:[""],"-":[""],"=":[""],a:[""],b:[""],c:[""],d:[""],e:[""],f:[""],g:[""],h:[""],i:[""],j:[""],k:[""],l:[""],m:[""],n:[""],o:[""],p:[""],q:[""],r:[""],s:[""],t:[""],u:[""],v:[""],w:[""],x:[""],y:[""],z:[""],"[":[""],"]":[""],"\\":[""],"'":[""],";":[""],",":[""],".":[""],"/":[""]},Qi=Ri(Xi);function Zi(e){return Qi[e]||[e]}function Yi(e){return Xi[e]||[e]}var eo={"`":["`"],1:[""],2:[""],3:[""],4:[""],5:[""],6:[""],7:[""],8:[""],9:[""],0:[""],"-":[""],"=":[""],a:[""],b:[""],c:[""],d:[""],e:[""],f:[""],g:[""],h:[""],i:[""],j:[""],k:[""],l:[""],m:[""],n:[""],o:[""],p:[""],q:[""],r:[""],s:[""],t:[""],u:[""],v:[""],w:[""],x:[""],y:[""],z:[""],"[":[""],"]":[""],"\\":[""],"'":[""],";":[""],",":[""],".":[""]},to=Ri(eo);function no(e){return to[e]||Mi(e)}function ro(e){return eo[e]||[e]}var io=function(){function e(){ai(this,e)}return ui(e,null,[{key:"serialize",value:function(e){var t=e.Shift,n=e.Alt,r={};return Object.keys(e).sort().forEach((function(e){var i=[];if(t)if(n){var o=no(e),a=ro(e);i=[].concat(Ei(i),[e],Ei(o),Ei(a))}else{var s=Mi(e),u=Pi(e);i=[].concat(Ei(i),[e],Ei(s),Ei(u))}else if(n){var c=Zi(e),l=Yi(e);i=[].concat(Ei(i),[e],Ei(c),Ei(l))}else{i.push(e);var d=ji[e];d&&(i=[].concat(Ei(i),Ei(d)))}var h=Object.keys(r);0<h.length?h.forEach((function(e){i.forEach((function(t){r[e+"+".concat(t)]=di({},r[e],ci({},t,!0))})),delete r[e]})):i.forEach((function(e){r[e]=ci({},e,!0)}))})),Object.values(r).map((function(e){return Object.keys(e).sort().join("+")}))}},{key:"isValidKeySerialization",value:function(e){return!!(0<e.length)&&!!Wi.parse(e,{ensureValidKeys:!0}).combination}}]),e}(),oo=0,ao=1;function so(e){return void 0===e}var uo=0,co=1,lo=2,ho=function(){function e(){ai(this,e)}return ui(e,null,[{key:"newRecord",value:function(e,t){var n=[uo,uo,uo];if(!so(e))for(var r=0;r<=e;r++)n[r]=t;return n}},{key:"setBit",value:function(e,t,n){return e[t]=n,e}},{key:"clone",value:function(e){for(var t=this.newRecord(),n=0;n<e.length;n++)t[n]=e[n];return t}}]),e}();function fo(e){return!Array.isArray(e)&&"object"===oi(e)&&null!==e}function po(e){return fo(e)?0===Object.keys(e).length:!e||0===e.length}function yo(e){return fo(e)?Object.keys(e).length:e.length}var vo=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};ai(this,e),this._keys=t,this._includesKeyUp=!1,this._update()}return ui(e,[{key:"getIds",value:function(){return this._ids}},{key:"getKeyAliases",value:function(){return this._keyAliases}},{key:"getNormalizedKeyName",value:function(e){if(this._keys[e])return e;var t=this._keyAliases[e];return t||e}},{key:"getNumberOfKeys",value:function(){return yo(this._keys)}},{key:"any",value:function(){return 0<Object.keys(this._getKeyStates()).length}},{key:"isEnding",value:function(){return this._includesKeyUp}},{key:"hasEnded",value:function(){return po(this.keysStillPressedDict())}},{key:"addKey",value:function(e,t){this._setKeyState(e,[ho.newRecord(),ho.newRecord(Ti.keydown,t)])}},{key:"setKeyState",value:function(e,t,n){var r=this._getKeyState(e);if(this.isKeyIncluded(e)){var i=ho.clone(r[1]),o=ho.clone(i);ho.setBit(o,t,n),this._setKeyState(e,[i,o])}else this.addKey(e,n);t===Ti.keyup&&(this._includesKeyUp=!0)}},{key:"forEachKey",value:function(e){return Object.keys(this._keys).forEach(e)}},{key:"some",value:function(e){return Object.keys(this._keys).some(e)}},{key:"getKeyDictionary",value:function(){return Si(Object.keys(this._getKeyStates()),!0)}},{key:"keysStillPressedDict",value:function(){var e=this;return Object.keys(this._keys).reduce((function(t,n){return e.isKeyStillPressed(n)&&(t[n]=e._getKeyState(n)),t}),{})}},{key:"isKeyIncluded",value:function(e){return!!this._getKeyState(e)}},{key:"isKeyStillPressed",value:function(e){return this.isEventTriggered(e,Ti.keypress)&&!this.isKeyReleased(e)}},{key:"isKeyReleased",value:function(e){return this.isEventTriggered(e,Ti.keyup)}},{key:"isEventTriggered",value:function(e,t){return this._getKeyStateType(e,ao,t)}},{key:"wasEventPreviouslyTriggered",value:function(e,t){return this._getKeyStateType(e,oo,t)}},{key:"isKeyPressSimulated",value:function(e){return this._isKeyEventSimulated(e,Ti.keypress)}},{key:"isKeyUpSimulated",value:function(e){return this._isKeyEventSimulated(e,Ti.keyup)}},{key:"describe",value:function(){return this.getIds()[0]}},{key:"toJSON",value:function(){return{keys:this._getKeyStates(),ids:this.getIds(),keyAliases:this.getKeyAliases()}}},{key:"_getKeyStateType",value:function(e,t,n){var r=this._getKeyState(e);return r&&r[t][n]}},{key:"_update",value:function(){this._ids=io.serialize(this._keys),this._keyAliases=function(e){return Object.keys(e).reduce((function(t,n){return function(e){return ji[e]||[e]}(n).forEach((function(r){(function(e){if(e.Shift)return e.Alt?[ro,no]:[Pi,Mi];if(e.Alt)return[Yi,Zi];var t=function(e){return[e]};return[t,t]})(e).forEach((function(e){e(r).forEach((function(e){(e!==n||n!==r)&&(t[e]=n)}))}))})),t}),{})}(this._keys)}},{key:"_isKeyEventSimulated",value:function(e,t){return this.isEventTriggered(e,t)===lo}},{key:"_getKeyStates",value:function(){return this._keys}},{key:"_getKeyState",value:function(e){var t=this._keys[e];if(t)return t;var n=this._keyAliases[e];return n?this._keys[n]:void 0}},{key:"_setKeyState",value:function(e,t){var n=this.getNormalizedKeyName(e);this._keys[n]=t,this._update()}}]),e}();var go=function(){function e(t){var n=t.maxLength,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;ai(this,e),this._records=[],this._maxLength=n,r?this._push(r):this._push(new vo)}return ui(e,[{key:"getMostRecentCombinations",value:function(e){return this._records.slice(-e,-1)}},{key:"any",value:function(){return this._records.some((function(e){return e.any()}))}},{key:"getLength",value:function(){return this._records.length}},{key:"getCurrentCombination",value:function(){return this._records[this.getLength()-1]}},{key:"addKeyToCurrentCombination",value:function(e,t,n){this._ensureInitialKeyCombination(),this.getCurrentCombination().setKeyState(e,t,n)}},{key:"setMaxLength",value:function(e){this._maxLength=e,this._trimHistory()}},{key:"startNewKeyCombination",value:function(e,t){this._ensureInitialKeyCombination();var n=new vo(this.getCurrentCombination().keysStillPressedDict());n.addKey(e,t),this._push(n)}},{key:"toJSON",value:function(){return this._records.map((function(e){return e.toJSON()}))}},{key:"_ensureInitialKeyCombination",value:function(){0===this.getLength()&&this._push(new vo)}},{key:"_push",value:function(e){this._trimHistory(),this._records.push(e)}},{key:"_trimHistory",value:function(){for(;this.getLength()>this._maxLength;)this._shift()}},{key:"_shift",value:function(){this._records.shift()}}]),e}(),mo=function(){function e(){ai(this,e),this._registry={}}return ui(e,[{key:"get",value:function(e){return this._registry[e]}},{key:"set",value:function(e,t){this._registry[e]=t}},{key:"remove",value:function(e){delete this._registry[e]}},{key:"toJSON",value:function(){return this._registry}}]),e}();function bo(e){return Array.isArray(e)?e:e?[e]:[]}var ko=function(e){function t(){return ai(this,t),ki(this,fi(t).apply(this,arguments))}return hi(t,mo),ui(t,[{key:"add",value:function(e,n){_i(fi(t.prototype),"set",this).call(this,e,{childIds:[],parentId:null,keyMap:n})}},{key:"update",value:function(e,n){var r=_i(fi(t.prototype),"get",this).call(this,e);_i(fi(t.prototype),"set",this).call(this,e,di({},r,{keyMap:n}))}},{key:"setParent",value:function(e,t){this.get(e).parentId=t,this._addChildId(t,e)}},{key:"remove",value:function(e){var n=this._getParentId(e);this._removeChildId(n,e),_i(fi(t.prototype),"remove",this).call(this,e)}},{key:"_getParentId",value:function(e){var t=this.get(e);return t&&t.parentId}},{key:"_addChildId",value:function(e,t){this.get(e).childIds.push(t)}},{key:"_removeChildId",value:function(e,t){var n=this.get(e);n&&(n.childIds=function(e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=Si(bo(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[]));return Array.isArray(e)?e.reduce((function(e,r){return n[r]&&(t.stringifyFirst||n[r].value===r)||e.push(r),e}),[]):fo(e)?Object.keys(e).reduce((function(t,r){return n[r]||(t[r]=e[r]),t}),{}):e}(n.childIds,t))}}]),t}();var _o=function(){function e(t){ai(this,e),this._list=t,this._position=-1}return ui(e,[{key:"getPosition",value:function(){return this._position}},{key:"getComponent",value:function(){return this._list.getAtPosition(this.getPosition())}},{key:"next",value:function(){return this.getPosition()+1<this._list.getLength()?(this._position++,this.getComponent()):null}}]),e}(),Eo=function(){function e(){ai(this,e),this._list=[],this._idToIndex={},this._longestSequence=1,this._longestSequenceComponentId=null,this._keyMapEventRecord=ho.newRecord()}return ui(e,[{key:"getNewIterator",value:function(){return new _o(this)}},{key:"add",value:function(e,t,n,r){if(this.containsId(e))return this.update(e,t,n,r);var i=this._build(e,t,n,r);this._list.push(i);var o=this._getLastIndex();return this._idToIndex[e]=o}},{key:"containsId",value:function(e){return!!this.get(e)}},{key:"get",value:function(e){return this.getAtPosition(this.getIndexById(e))}},{key:"getIndexById",value:function(e){return this._idToIndex[e]}},{key:"update",value:function(e,t,n,r){var i=this._isUpdatingComponentWithLongestSequence(e),o=this.getLongestSequence(),a=this._build(e,t,n,r);i&&a.sequenceLength!==o&&(a.sequenceLength>o?this._longestSequence=a.sequenceLength:this._recalculateLongestSequence()),this._list[this.getIndexById(e)]=a}},{key:"remove",value:function(e){var t=this._isUpdatingComponentWithLongestSequence(e);this.removeAtPosition(this.getIndexById(e)),t&&this._recalculateLongestSequence()}},{key:"any",value:function(){return 0!==this.getLength()}},{key:"isRoot",value:function(e){return this.getIndexById(e)>=this.getLength()-1}},{key:"getLongestSequence",value:function(){return this._longestSequence}},{key:"anyActionsForEventType",value:function(e){return!!this._keyMapEventRecord[e]}},{key:"getLength",value:function(){return this._list.length}},{key:"getAtPosition",value:function(e){return this._list[e]}},{key:"removeAtPosition",value:function(e){this._list=function(e,t){return[].concat(Ei(e.slice(0,t)),Ei(e.slice(t+1)))}(this._list,e);for(var t=e;t<this.getLength();)this._idToIndex[this.getAtPosition(t).componentId]=t,t++}},{key:"toJSON",value:function(){return this._list}},{key:"_getLastIndex",value:function(){return this.getLength()-1}},{key:"_build",value:function(e,t,n,r){var i=this._applyHardSequences(t,n),o=i.keyMap,a=i.handlers;return{actions:this._buildActionDictionary(di({},t,o),r,e),handlers:a,componentId:e,options:r}}},{key:"_isUpdatingComponentWithLongestSequence",value:function(e){return e===this._getLongestSequenceComponentId()}},{key:"_getLongestSequenceComponentId",value:function(){return this._longestSequenceComponentId}},{key:"_recalculateLongestSequence",value:function(){for(var e=this.getNewIterator();e.next();){var t=e.getComponent(),n=t.longestSequence,r=t.componentId;n>this.getLongestSequence()&&(this._longestSequenceComponentId=r,this._longestSequence=n)}}},{key:"_applyHardSequences",value:function(e,t){return Ci.option("enableHardSequences")?Object.keys(t).reduce((function(n,r){return!!!e[r]&&io.isValidKeySerialization(r)&&(n.keyMap[r]=r),n.handlers[r]=t[r],n}),{keyMap:{},handlers:{}}):{keyMap:e,handlers:t}}},{key:"_buildActionDictionary",value:function(e,t,n){var r=this;return Object.keys(e).reduce((function(i,o){var a=e[o];return(fo(a)&&Ai(a,"sequences")?bo(a.sequences):bo(a)).forEach((function(e){var a=function(e,t){if(fo(e)){var n=e.sequence,r=e.action;return{keySequence:n,keyEventType:so(r)?Ti[t.defaultKeyEvent]:Ti[r]}}return{keySequence:e,keyEventType:Ti[t.defaultKeyEvent]}}(e,t),s=a.keySequence,u=a.keyEventType;r._addActionOptions(i,n,o,s,u)})),i}),{})}},{key:"_addActionOptions",value:function(e,t,n,r,i){var o=Wi.parse(r,{keyEventType:i}),a=o.sequence,s=o.combination;a.size>this.getLongestSequence()&&(this._longestSequence=a.size,this._longestSequenceComponentId=t),this._keyMapEventRecord[i]=co,e[n]||(e[n]=[]),e[n].push(di({prefix:a.prefix,actionName:n,sequenceLength:a.size},s))}}]),e}();function So(e,t){return e[e.length-(t+1)]}for(var wo={Enter:!0,Backspace:!0,ArrowRight:!0,ArrowLeft:!0,ArrowUp:!0,ArrowDown:!0,CapsLock:!0},xo=1;13>xo;xo++)wo["F".concat(xo)]=!0;function Co(e){return 1===e.length||Ai(wo,e)}var Oo=function(){function e(){ai(this,e),this._actionConfigs={},this._order=null}return ui(e,[{key:"addMatch",value:function(e,t){if(this._includesMatcherForCombination(e.id)){var n=e.keyEventType,r=e.actionName,i=e.id;this._addHandlerToActionConfig(i,{keyEventType:n,actionName:r,handler:t})}else this._addNewActionConfig(e,t)}},{key:"findMatch",value:function(e,t,n){this._order||this._setOrder();var r=!0,i=!1,o=void 0;try{for(var a,s=this._order[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=this._actionConfigs[u];if(this._matchesActionConfig(e,t,n,c))return c}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return null}},{key:"toJSON",value:function(){return{actionConfigs:this._actionConfigs,order:this._order}}},{key:"_matchesActionConfig",value:function(e,t,n,r){if(!function(e,t){var n=yo(t.keyDictionary);return Ci.option("allowCombinationSubmatches")||function(e){return!!e.isKeyStillPressed("Meta")&&e.some((function(e){return Co(e)}))}(e)?e.getNumberOfKeys()>=n:e.getNumberOfKeys()===n}(e,r))return!1;if(!r.events[n])return!1;var i=!1;return Object.keys(r.keyDictionary).every((function(r){return!!e.isEventTriggered(r,n)&&(t&&t===e.getNormalizedKeyName(r)&&(i=!e.wasEventPreviouslyTriggered(r,n)),!0)}))&&i}},{key:"_setOrder",value:function(){var e=Object.values(this._actionConfigs).reduce((function(e,t){var n=t.id,r=t.size;return e[r]||(e[r]=[]),e[r].push(n),e}),{});this._order=Object.keys(e).sort((function(e,t){return t-e})).reduce((function(t,n){return t.concat(e[n])}),[])}},{key:"_addNewActionConfig",value:function(e,t){var n=e.prefix,r=e.sequenceLength,i=e.id,o=e.keyDictionary,a=e.size,s=e.keyEventType,u=e.actionName;this._setCombinationMatcher(i,{prefix:n,sequenceLength:r,id:i,keyDictionary:o,size:a,events:{}}),this._addHandlerToActionConfig(i,{keyEventType:s,actionName:u,handler:t})}},{key:"_addHandlerToActionConfig",value:function(e,t){var n=t.keyEventType,r=t.actionName,i=t.handler,o=this._getCombinationMatcher(e);this._setCombinationMatcher(e,di({},o,{events:di({},o.events,ci({},n,{actionName:r,handler:i}))}))}},{key:"_setCombinationMatcher",value:function(e,t){this._actionConfigs[e]=t}},{key:"_getCombinationMatcher",value:function(e){return this._actionConfigs[e]}},{key:"_includesMatcherForCombination",value:function(e){return!!this._getCombinationMatcher(e)}}]),e}();var To=function(){function e(){ai(this,e),this._combinationMatchers={},this._eventRecord=ho.newRecord()}return ui(e,[{key:"addMatch",value:function(e,t){this._getOrCreateCombinationMatcher(e.prefix).addMatch(e,t),ho.setBit(this._eventRecord,e.keyEventType,co),(!this._longestSequence||this._longestSequence<e.sequenceLength)&&(this._longestSequence=e.sequenceLength)}},{key:"findMatch",value:function(e,t,n){var r=this._findCombinationMatcher(e);return r?r.findMatch(e.getCurrentCombination(),e.getCurrentCombination().getNormalizedKeyName(t),n):null}},{key:"hasMatchesForEventType",value:function(e){return!!this._eventRecord[e]}},{key:"getLongestSequence",value:function(){return this._longestSequence}},{key:"toJSON",value:function(){var e=this;return Object.keys(this._combinationMatchers).reduce((function(t,n){var r=e._combinationMatchers[n];return t[n]=r.toJSON(),t}),{})}},{key:"_getOrCreateCombinationMatcher",value:function(e){return this._combinationMatchers[e]||(this._combinationMatchers[e]=new Oo),this._combinationMatchers[e]}},{key:"_findCombinationMatcher",value:function(e){var t=e.getMostRecentCombinations(this.getLongestSequence());if(0===t.length)return this._combinationMatchers[""];for(var n=t.map((function(e){return e.getIds()})),r=n.map((function(e){return e.length})),i=Array(n.length).fill(0),o=!1;!o;){var a=i.map((function(e,t){return n[t][e]})).join(" ");if(this._combinationMatchers[a])return this._combinationMatchers[a];for(var s=0,u=!0;u&&s<i.length;){var c=(So(i,s)+1)%(So(r,s)||1);i[i.length-(s+1)]=c,(u=0==c)&&s++}o=s===i.length}}}]),e}(),Io=function(){function e(t){ai(this,e),this._keyMapMatchers=[],this._unmatchedHandlerStatus=[],this._handlersDictionary={},this._keySequencesDictionary={};for(var n=t.getNewIterator();n.next();){var r=n.getComponent().handlers;this._unmatchedHandlerStatus.push([Object.keys(r).length,{}]),this._keyMapMatchers.push(new To)}this._componentList=t,this._componentListIterator=t.getNewIterator()}return ui(e,[{key:"getKeyHistoryMatcher",value:function(e){if(this._componentHasUnmatchedHandlers(e))for(;this._componentListIterator.next();)this._addHandlersFromComponent(),this._addActionsFromComponent();return this._getKeyHistoryMatcher(e)}},{key:"componentHasActionsBoundToEventType",value:function(e,t){return this.getKeyHistoryMatcher(e).hasMatchesForEventType(t)}},{key:"findMatchingKeySequenceInComponent",value:function(e,t,n,r){return this.componentHasActionsBoundToEventType(e,r)?this.getKeyHistoryMatcher(e).findMatch(t,n,r):null}},{key:"_getKeyHistoryMatcher",value:function(e){return this._keyMapMatchers[e]}},{key:"_addActionsFromComponent",value:function(){var e=this,t=this._componentListIterator.getComponent().actions;Object.keys(t).forEach((function(n){var r=e._getHandlers(n);if(r){var i=r[0],o=e._componentList.getAtPosition(i).handlers[n],a=e._getKeyHistoryMatcher(i);t[n].forEach((function(t){var n=[t.prefix,t.id].join(" ");e._isClosestHandlerFound(n,t)||(a.addMatch(t,o),e._addKeySequence(n,[i,t.keyEventType]))})),r.forEach((function(t){var r=e._getUnmatchedHandlerStatus(t);r[1][n]||(r[1][n]=!0,r[0]--)}))}}))}},{key:"_getHandlers",value:function(e){return this._handlersDictionary[e]}},{key:"_addHandlersFromComponent",value:function(){var e=this,t=this._componentListIterator.getComponent().handlers;Object.keys(t).forEach((function(t){e._addHandler(t)}))}},{key:"_addHandler",value:function(e){this._handlersDictionary[e]||(this._handlersDictionary[e]=[]),this._handlersDictionary[e].push(this._componentListIterator.getPosition())}},{key:"_addKeySequence",value:function(e,t){this._keySequencesDictionary[e]||(this._keySequencesDictionary[e]=[]),this._keySequencesDictionary[e].push(t)}},{key:"_componentHasUnmatchedHandlers",value:function(e){return 0<this._getUnmatchedHandlerStatus(e)[0]}},{key:"_getUnmatchedHandlerStatus",value:function(e){return this._unmatchedHandlerStatus[e]}},{key:"_isClosestHandlerFound",value:function(e,t){return this._keySequencesDictionary[e]&&this._keySequencesDictionary[e].some((function(e){return e[1]===t.keyEventType}))}}]),e}();function Ko(e,t,n){return n.forEach((function(n){Ai(e,n)&&(t[n]=e[n])})),t}function Po(e){switch(parseInt(e,10)){case 0:return"keydown";case 1:return"keypress";default:return"keyup"}}function Ao(e){return e.simulated?lo:co}var Ro=["sequence","action"],Lo=["name","description","group"],Mo=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;ai(this,e),this.logger=t.logger||new Oi("warn"),this.componentId=-1,this.keyEventManager=n,this._componentTree=new ko,this.rootComponentId=null,this._reset(),this.resetKeyHistory()}return ui(e,[{key:"_reset",value:function(){this.componentList=new Eo,this._initHandlerResolutionState()}},{key:"_newKeyHistory",value:function(){return new go({maxLength:this.componentList.getLongestSequence()})}},{key:"getKeyHistory",value:function(){return this._keyHistory||(this._keyHistory=this._newKeyHistory()),this._keyHistory}},{key:"_initHandlerResolutionState",value:function(){this._actionResolver=null}},{key:"resetKeyHistory",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.keypressEventsToSimulate=[],this.keyupEventsToSimulate=[],this._keyHistory=this.getKeyHistory().any()&&!e.force?new go({maxLength:this.componentList.getLongestSequence()},new vo(this.getCurrentCombination().keysStillPressedDict())):this._newKeyHistory()}},{key:"getApplicationKeyMap",value:function(){return null===this.rootComponentId?{}:this._buildApplicationKeyMap([this.rootComponentId],{})}},{key:"_buildApplicationKeyMap",value:function(e,t){var n=this;return e.forEach((function(e){var r=n._componentTree.get(e),i=r.childIds,o=r.keyMap;o&&Object.keys(o).forEach((function(e){var r=o[e];t[e]={},fo(r)?Ai(r,"sequences")?(Ko(r,t[e],Lo),t[e].sequences=n._createSequenceFromConfig(r.sequences)):(Ko(r,t[e],Lo),t[e].sequences=[Ko(r,{},Ro)]):t[e].sequences=n._createSequenceFromConfig(r)})),n._buildApplicationKeyMap(i,t)})),t}},{key:"_createSequenceFromConfig",value:function(e){return bo(e).map((function(e){return fo(e)?Ko(e,{},Ro):{sequence:e}}))}},{key:"registerKeyMap",value:function(e){return this.componentId+=1,this._componentTree.add(this.componentId,e),this.componentId}},{key:"reregisterKeyMap",value:function(e,t){this._componentTree.update(e,t)}},{key:"registerComponentMount",value:function(e,t){so(t)?this.rootComponentId=e:this._componentTree.setParent(e,t)}},{key:"deregisterKeyMap",value:function(e){this._componentTree.remove(e),e===this.rootComponentId&&(this.rootComponentId=null)}},{key:"_addComponent",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0;this.componentList.add(e,t,n,r),this.getKeyHistory().setMaxLength(this.componentList.getLongestSequence())}},{key:"_allKeysAreReleased",value:function(){return this.getCurrentCombination().hasEnded()}},{key:"getCurrentCombination",value:function(){return this.getKeyHistory().getCurrentCombination()}},{key:"_shouldSimulate",value:function(e,t){var n=function(e){return!Vi(e)}(t),r=this.getCurrentCombination();return e===Ti.keypress?!n||n&&r.isKeyStillPressed("Meta"):e===Ti.keyup&&Co(t)&&r.isKeyReleased("Meta")}},{key:"_cloneAndMergeEvent",value:function(e,t){return di({},Object.keys(Ii).reduce((function(t,n){return t[n]=e[n],t}),{}),t)}},{key:"_callClosestMatchingHandler",value:function(e,t,n,r,i){for(this._actionResolver||(this._actionResolver=new Io(this.componentList));i<=r;){this._actionResolver.getKeyHistoryMatcher(i);var o=this._actionResolver.findMatchingKeySequenceInComponent(i,this.getKeyHistory(),t,n);if(this.getCurrentCombination(),o){var a=o.events[n];return Ci.option("allowCombinationSubmatches")&&io.serialize(o.keyDictionary),a.handler(e),this._stopEventPropagationAfterHandlingIfEnabled(e,i),!0}this._actionResolver.componentHasActionsBoundToEventType(i,n),i++}}},{key:"_stopEventPropagationAfterHandlingIfEnabled",value:function(e,t){return!!Ci.option("stopEventPropagationAfterHandling")&&(this._stopEventPropagation(e,t),!0)}},{key:"_stopEventPropagation",value:function(){throw new Error("_stopEventPropagation must be overridden by a subclass")}},{key:"_checkForModifierFlagDiscrepancies",value:function(e,t,n){var r=this;Object.keys(Ii).forEach((function(i){if(t!==i||n!==Ti.keyup){var o=r.getCurrentCombination(),a=o.isKeyStillPressed(i);Ii[i].forEach((function(t){!1===e[t]&&a&&o.setKeyState(i,Ti.keyup,Ao(e))}))}}))}},{key:"_logPrefix",value:function(){}}]),e}(),jo=function(){function e(){ai(this,e)}return ui(e,null,[{key:"getId",value:function(){return so(this._id)&&(this._id=0),this._id}},{key:"incrementId",value:function(){this._id=this.getId()+1}}]),e}();var No={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"};function Do(e){var t,n,r=(t=Ci.option("customKeyCodes"),n=e.keyCode||e.charCode,Ai(t,n)?t[n]:e.nativeEvent?e.key:function(e){if(e.key){var t=No[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"===e.type){var n=function(e){var t,n=e.keyCode;return"charCode"in e?0===(t=e.charCode)&&13===n&&(t=13):t=n,10===t&&(t=13),32<=t||13===t?t:0}(e);return 13===n?"Enter":String.fromCharCode(n)}return"keydown"===e.type||"keyup"===e.type?qi[e.keyCode]||"Unidentified":""}(e));return"+"===r?"plus":r}function Fo(e){return"Meta"===e}var Ho=0,Uo=1,qo=2,Bo=4,Vo=function(){function e(t,n){var r=n.logger,i=n.logPrefix;ai(this,e),this._componentList=t,this._previousPropagation=null,this.logger=r,this._logPrefix=i,this._reset()}return ui(e,[{key:"_reset",value:function(){this._previousPosition=-1,this._position=-1,this._actionHandled=!1,this._ignoreEvent=!1,this._observeIgnoredEvents=!1,this._stopping=!1,this._componentId=null,this._key=null,this._type=null}},{key:"isFirstPropagationStep",value:function(){var e=this.getPreviousPosition();return-1===e||e>=this._position}},{key:"isForKey",value:function(e){return this._key===e}},{key:"isForEventType",value:function(e){return this._type===e}},{key:"startNewPropagationStep",value:function(e,t,n,r){return this._position=this._componentList.getIndexById(e),this._componentId=e,this.isFirstPropagationStep()&&(jo.incrementId(),this._key=t.key,this._type=r),!(t.repeat&&Ci.option("ignoreRepeatedEventsWhenKeyHeldDown")&&(this.ignoreEvent(t),1))}},{key:"finishPropagationStep",value:function(){this.isStopped()||this._componentList.isRoot(this._componentId)?(this._previousPropagation=this._clone(),this._reset()):this._previousPosition=this._position}},{key:"getPreviousPropagation",value:function(){return this._previousPropagation||(this._previousPropagation=this._clone({copyState:!1})),this._previousPropagation}},{key:"getPreviousPosition",value:function(){return this._previousPosition}},{key:"observeIgnoredEvents",value:function(){this._observeIgnoredEvents=!0}},{key:"ignoreEvent",value:function(e){return this.setIgnoreEvent(!0),!(!this.isIgnoringEvent()||!Ci.option("stopEventPropagationAfterIgnoring")||(this.stop(e),this.finishPropagationStep(),0))}},{key:"setIgnoreEvent",value:function(e){this._ignoreEvent=e}},{key:"isIgnoringEvent",value:function(){return!this._observeIgnoredEvents&&this._ignoreEvent}},{key:"isStopped",value:function(){return this._stopping}},{key:"stop",value:function(e){return!this.isStopped()&&(this._stopping=!0,e.simulated||e.stopPropagation(),!0)}},{key:"isPendingPropagation",value:function(){var e=this.getPreviousPosition();return-1!==e&&e+1<this._position}},{key:"isHandled",value:function(){return this._actionHandled}},{key:"setHandled",value:function(){this._actionHandled=!0}},{key:"_clone",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.copyState,r=new e(this._componentList,{logger:this.logger,logPrefix:this._logPrefix});return(void 0===n||n)&&Object.assign(r,this),r}}]),e}(),Go=function(e){function t(){var e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0;return ai(this,t),(e=ki(this,fi(t).call(this,n,r))).focusTreeId=0,e}return hi(t,Mo),ui(t,[{key:"_reset",value:function(){_i(fi(t.prototype),"_reset",this).call(this),this.keypressEventsToSimulate=[],this.focusTreeId+=1,this.eventPropagator=new Vo(this.componentList,{logger:this.logger,logPrefix:this._logPrefix.bind(this)})}},{key:"enableHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0;if(this.resetOnNextFocus&&(this._reset(),this.resetOnNextFocus=!1),!this.componentList.containsId(e))return this._addComponent(e,t,n,r),this.focusTreeId}},{key:"updateEnabledHotKeys",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=4<arguments.length?arguments[4]:void 0;e===this.focusTreeId&&this.componentList.containsId(t)&&(this.componentList.update(t,n,r,i),this.getKeyHistory().setMaxLength(this.componentList.getLongestSequence()),this._initHandlerResolutionState())}},{key:"disableHotKeys",value:function(e,t){return this.resetOnNextFocus||(this.resetOnNextFocus=!0),this.eventPropagator.isPendingPropagation()}},{key:"handleKeydown",value:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=Do(e);if(t!==this.focusTreeId)return this.eventPropagator.ignoreEvent(e),!0;var o=this.eventPropagator.startNewPropagationStep(n,e,i,Ti.keydown);if(o){var a=this._howToHandleKeyEvent(e,t,n,i,r,Ti.keydown);if(a===Bo){var s=Ao(e),u=this.getCurrentCombination();u.isKeyIncluded(i)||u.isEnding()?this._startAndLogNewKeyCombination(i,t,n,s):this._addToAndLogCurrentKeyCombination(i,Ti.keydown,t,n,s),this._callHandlerIfActionNotHandled(e,i,Ti.keydown,n,t)}return this._simulateKeyPressForNonPrintableKeys(e,i,t,n,r),this.eventPropagator.finishPropagationStep(),!1}}},{key:"_howToHandleKeyEvent",value:function(e,t,n,r,i,o){if(this.eventPropagator.isFirstPropagationStep()){if(i.ignoreEventsCondition(e)&&this.eventPropagator.ignoreEvent(e))return this._eventIsToBeIgnored(e,n,r,o);this._checkForModifierFlagDiscrepancies(e,r,o)}else if(this.eventPropagator.isIgnoringEvent())return this._eventIsToBeIgnored(e,n,r,o);return Bo}},{key:"_eventIsToBeIgnored",value:function(e,t,n,r){return Uo}},{key:"handleKeyPress",value:function(e,t,n,r){var i=Do(e),o=this.getCurrentCombination();if(o.isKeyPressSimulated(i))return this.eventPropagator.ignoreEvent(e),!0;if(this.eventPropagator.startNewPropagationStep(n,e,i,Ti.keypress)){var a=t!==this.focusTreeId,s=this._howToHandleKeyEvent(e,t,n,i,r,Ti.keypress);return this.eventPropagator.isFirstPropagationStep(n)&&o.isKeyIncluded(i)&&this._addToAndLogCurrentKeyCombination(i,Ti.keypress,t,n,Ao(e)),s===Bo&&this._callHandlerIfActionNotHandled(e,i,Ti.keypress,n,t),this.eventPropagator.finishPropagationStep(),a}}},{key:"handleKeyUp",value:function(e,t,n,r){var i=Do(e),o=this.getCurrentCombination();if(o.isKeyUpSimulated(i))return this.eventPropagator.ignoreEvent(e),!0;if(this.eventPropagator.startNewPropagationStep(n,e,i,Ti.keyup)){var a=t!==this.focusTreeId,s=this._howToHandleKeyEvent(e,t,n,i,r,Ti.keyup);return this.eventPropagator.isFirstPropagationStep(n)&&o.isKeyIncluded(i)&&this._addToAndLogCurrentKeyCombination(i,Ti.keyup,t,n,Ao(e)),s===Bo&&this._callHandlerIfActionNotHandled(e,i,Ti.keyup,n,t),this._simulateKeyUpEventsHiddenByCmd(e,i,t,n,r),this.eventPropagator.finishPropagationStep(),a}}},{key:"closeHangingKeyCombination",value:function(e,t){var n=this.getCurrentCombination();n.isKeyIncluded(e)&&!n.isEventTriggered(e,t)&&n.setKeyState(e,t,lo)}},{key:"_simulateKeyPressForNonPrintableKeys",value:function(e,t,n,r,i){this._handleEventSimulation("keypressEventsToSimulate","simulatePendingKeyPressEvents",this._shouldSimulate(Ti.keypress,t),{event:e,key:t,focusTreeId:n,componentId:r,options:i})}},{key:"_simulateKeyUpEventsHiddenByCmd",value:function(e,t,n,r,i){var o=this;Fo(t)&&this.getCurrentCombination().forEachKey((function(t){Fo(t)||o._handleEventSimulation("keyupEventsToSimulate","simulatePendingKeyUpEvents",o._shouldSimulate(Ti.keyup,t),{event:e,key:t,focusTreeId:n,componentId:r,options:i})}))}},{key:"_stopEventPropagation",value:function(e,t){this.eventPropagator.stop(e)}},{key:"getEventPropagator",value:function(){return this.eventPropagator}},{key:"_startAndLogNewKeyCombination",value:function(e,t,n,r){this.getKeyHistory().startNewKeyCombination(e,r)}},{key:"_addToAndLogCurrentKeyCombination",value:function(e,t,n,r,i){this.getKeyHistory().addKeyToCurrentCombination(e,t,i)}},{key:"_handleEventSimulation",value:function(e,t,n,r){var i=r.event,o=r.key,a=r.focusTreeId,s=r.componentId,u=r.options;if(n&&Ci.option("simulateMissingKeyPressEvents")){var c=this._cloneAndMergeEvent(i,{key:o,simulated:!0});this[e].push({event:c,focusTreeId:a,componentId:s,options:u})}(this.componentList.isRoot(s)||this.eventPropagator.isStopped())&&!this.keyEventManager.isGlobalListenersBound()&&this[t]()}},{key:"simulatePendingKeyPressEvents",value:function(){this._simulatePendingKeyEvents("keypressEventsToSimulate","handleKeyPress")}},{key:"simulatePendingKeyUpEvents",value:function(){this._simulatePendingKeyEvents("keyupEventsToSimulate","handleKeyUp")}},{key:"_simulatePendingKeyEvents",value:function(e,t){var n=this;0<this[e].length&&jo.incrementId(),this[e].forEach((function(e){var r=e.event,i=e.focusTreeId,o=e.componentId,a=e.options;n[t](r,i,o,a)})),this[e]=[]}},{key:"_callHandlerIfActionNotHandled",value:function(e,t,n,r,i){if(this.getCurrentCombination().describe(),this.componentList.anyActionsForEventType(n))if(this.eventPropagator.isHandled());else{var o=this.eventPropagator.getPreviousPosition(),a=this.componentList.getIndexById(r);this._callClosestMatchingHandler(e,t,n,a,-1===o?0:o)&&this.eventPropagator.setHandled()}}},{key:"_logPrefix",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=Oi.logIcons,r=Oi.eventIcons,i=Oi.componentIcons,o="HotKeys (";if(!1!==t.focusTreeId){var a=so(t.focusTreeId)?this.focusTreeId:t.focusTreeId;o+="F".concat(a).concat(n[a%n.length],"-")}if(!1!==t.eventId){var s=so(t.eventId)?jo.getId():t.eventId;o+="E".concat(s).concat(r[s%r.length],"-")}o+="C".concat(e).concat(i[e%i.length]);var u=this.componentList.getIndexById(e);return so(u)||(o+="-P".concat(u).concat(i[u%i.length],":")),"".concat(o,")")}}]),t}();function zo(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Array.isArray(e)||Ni(e)?n.stringifyFirst?!so(e.find((function(e){return e.toString()===t.toString()}))):-1!==e.indexOf(t):fo(e)?Ai(e,t):n.stringifyFirst?e.toString()===t.toString():e===t}function $o(e){return e.replace(/\b\w/g,(function(e){return e.toUpperCase()}))}var Wo=function(e){function t(){var e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0;return ai(this,t),(e=ki(this,fi(t).call(this,n,r))).listenersBound=!1,e.eventOptions={ignoreEventsCondition:Ci.option("ignoreEventsCondition")},e.listeners={},e}return hi(t,Mo),ui(t,[{key:"enableHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;this.eventOptions=i,this._addComponent(e,t,n,r),this._updateDocumentHandlers(),this._initHandlerResolutionState()}},{key:"updateEnabledHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;this.eventOptions=i,this.componentList.update(e,t,n,r),this.getKeyHistory().setMaxLength(this.componentList.getLongestSequence()),this._updateDocumentHandlers(),this._initHandlerResolutionState()}},{key:"disableHotKeys",value:function(e){this.componentList.remove(e),this.getKeyHistory().setMaxLength(this.componentList.getLongestSequence()),this._updateDocumentHandlers(),this._initHandlerResolutionState()}},{key:"_updateDocumentHandlers",value:function(){var e=this,t=this._listenersShouldBeBound();!this.listenersBound&&t?(Object.values(Ti).forEach((function(t){var n=Po(t);document["on".concat(n)]=function(t){e.keyEventManager["handleGlobal".concat(function(e){return"".concat($o(e.slice(0,3))).concat($o(e.slice(3)))}(n))](t)}})),this.listenersBound=!0):this.listenersBound&&!t&&(Object.values(Ti).forEach((function(e){var t=Po(e);delete document["on".concat(t)]})),this.listenersBound=!1)}},{key:"_listenersShouldBeBound",value:function(){return this.componentList.any()||this.listeners.keyCombination}},{key:"handleKeydown",value:function(e){var t=Do(e);if(e.repeat&&Ci.option("ignoreRepeatedEventsWhenKeyHeldDown"))return!0;this._checkForModifierFlagDiscrepancies(e,t,Ti.keydown);var n=this._howReactAppRespondedTo(e,t,Ti.keydown);if(n!==Ho||!this.eventOptions.ignoreEventsCondition(e)){if(n!==Uo){var r=Ao(e),i=this.getCurrentCombination();i.isKeyIncluded(t)||i.isEnding()?this._startAndLogNewKeyCombination(t,r):this._addToAndLogCurrentKeyCombination(t,Ti.keydown,r)}zo([Uo,Bo],n)||this._callHandlerIfExists(e,t,Ti.keydown),this._simulateKeyPressForNonPrintableKeys(e,t)}}},{key:"_howReactAppRespondedTo",value:function(e,t,n){var r=this.keyEventManager.reactAppHistoryWithEvent(t,n);return r===Bo||r===Uo||r===qo||jo.incrementId(),r}},{key:"handleKeyPress",value:function(e){var t=Do(e);if(e.repeat&&Ci.option("ignoreRepeatedEventsWhenKeyHeldDown"))return!0;var n=this.getCurrentCombination();if(n.isKeyPressSimulated(t))return!0;var r=this._howReactAppRespondedTo(e,t,Ti.keypress);return n.isKeyIncluded(t)&&this._addToAndLogCurrentKeyCombination(t,Ti.keypress,Ao(e)),r===Ho&&(this.keyEventManager.closeHangingKeyCombination(t,Ti.keypress),this.eventOptions.ignoreEventsCondition(e))?void 0:void(!zo([Uo,Bo],r)&&this._callHandlerIfExists(e,t,Ti.keypress))}},{key:"handleKeyUp",value:function(e){var t=Do(e),n=this.getCurrentCombination();if(n.isKeyUpSimulated(t))return!0;var r=this._howReactAppRespondedTo(e,t,Ti.keyup);n.isKeyIncluded(t)&&this._addToAndLogCurrentKeyCombination(t,Ti.keyup,Ao(e)),r===Ho?(this.keyEventManager.closeHangingKeyCombination(t,Ti.keyup),this.eventOptions.ignoreEventsCondition(e)||!zo([Uo,Bo],r)&&this._callHandlerIfExists(e,t,Ti.keyup)):!zo([Uo,Bo],r)&&this._callHandlerIfExists(e,t,Ti.keyup),this._simulateKeyUpEventsHiddenByCmd(e,t),this.listeners.keyCombination&&this._allKeysAreReleased()&&this.listeners.keyCombination({keys:n.getKeyDictionary(),id:n.describe()})}},{key:"_simulateKeyPressForNonPrintableKeys",value:function(e,t){this.keyEventManager.simulatePendingKeyPressEvents(),this._handleEventSimulation("handleKeyPress",this._shouldSimulate(Ti.keypress,t),{event:e,key:t})}},{key:"_simulateKeyUpEventsHiddenByCmd",value:function(e,t){var n=this;Fo(t)&&(this.keyEventManager.simulatePendingKeyUpEvents(),this.getCurrentCombination().forEachKey((function(t){Fo(t)||n._handleEventSimulation("handleKeyUp",n._shouldSimulate(Ti.keyup,t),{event:e,key:t})})))}},{key:"_startAndLogNewKeyCombination",value:function(e,t){this.getKeyHistory().startNewKeyCombination(e,t)}},{key:"_addToAndLogCurrentKeyCombination",value:function(e,t,n){this.getKeyHistory().addKeyToCurrentCombination(e,t,n)}},{key:"_handleEventSimulation",value:function(e,t,n){var r=n.event,i=n.key;if(t&&Ci.option("simulateMissingKeyPressEvents")){var o=this._cloneAndMergeEvent(r,{key:i,simulated:!0});this[e](o)}}},{key:"_callHandlerIfExists",value:function(e,t,n){return this.getCurrentCombination().describe(),this.componentList.anyActionsForEventType(n)?void this._callClosestMatchingHandler(e,t,n):void 0}},{key:"_callClosestMatchingHandler",value:function(e,n,r){for(var i=this.componentList.getNewIterator();i.next();)if(_i(fi(t.prototype),"_callClosestMatchingHandler",this).call(this,e,n,r,i.getPosition(),0))return}},{key:"_stopEventPropagation",value:function(e,t){e.simulated||e.stopPropagation()}},{key:"addKeyCombinationListener",value:function(e){var t=this,n=function(){delete t.listeners.keyCombination};return this.listeners.keyCombination=function(t){e(t),n()},this._updateDocumentHandlers(),n}},{key:"_logPrefix",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=Oi.eventIcons,r=Oi.componentIcons,i="HotKeys (GLOBAL";if(!1!==t.eventId){var o=so(t.eventId)?jo.getId():t.eventId;i="".concat(i,"-E").concat(o).concat(n[o%n.length])}return so(e)?"".concat(i,"):"):"".concat(i,"-C").concat(e).concat(r[e%r.length],"):")}}]),t}();function Jo(e){return!so(e)}var Xo=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};ai(this,e),this.logger=t.logger||new Oi(Ci.option("logLevel")),this._focusOnlyEventStrategy=new Go({configuration:t,logger:this.logger},this),this._globalEventStrategy=new Wo({configuration:t,logger:this.logger},this),this.mountedComponentsCount=0}return ui(e,null,[{key:"getInstance",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.instance||(this.instance=new e(t)),this.instance}},{key:"clear",value:function(){delete this.instance}}]),ui(e,[{key:"getApplicationKeyMap",value:function(){return Object.assign(this._globalEventStrategy.getApplicationKeyMap(),this._focusOnlyEventStrategy.getApplicationKeyMap())}},{key:"registerKeyMap",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._focusOnlyEventStrategy.registerKeyMap(e)}},{key:"reregisterKeyMap",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this._focusOnlyEventStrategy.reregisterKeyMap(e,t)}},{key:"deregisterKeyMap",value:function(e){this._focusOnlyEventStrategy.deregisterKeyMap(e)}},{key:"registerComponentMount",value:function(e,t){return this._incrementComponentCount(),this._focusOnlyEventStrategy.registerComponentMount(e,t)}},{key:"registerComponentUnmount",value:function(){this._decrementComponentCount()}},{key:"_incrementComponentCount",value:function(){var e=this,t=this.mountedComponentsCount;this.mountedComponentsCount+=1,0===t&&1===this.mountedComponentsCount&&(window.onblur=function(){return e._clearKeyHistory()})}},{key:"_decrementComponentCount",value:function(){var e=this.mountedComponentsCount;this.mountedComponentsCount-=1,1===e&&0===this.mountedComponentsCount&&delete window.onblur}},{key:"_clearKeyHistory",value:function(){this._focusOnlyEventStrategy.resetKeyHistory({force:!0}),this._globalEventStrategy.resetKeyHistory({force:!0})}},{key:"registerGlobalKeyMap",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._globalEventStrategy.registerKeyMap(e)}},{key:"registerGlobalComponentUnmount",value:function(){this._decrementComponentCount()}},{key:"registerGlobalComponentMount",value:function(e,t){return this._incrementComponentCount(),this._globalEventStrategy.registerComponentMount(e,t)}},{key:"reregisterGlobalKeyMap",value:function(e,t){this._globalEventStrategy.reregisterKeyMap(e,t)}},{key:"deregisterGlobalKeyMap",value:function(e){this._globalEventStrategy.deregisterKeyMap(e)}},{key:"addKeyCombinationListener",value:function(e){return this._globalEventStrategy.addKeyCombinationListener(e)}},{key:"enableHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0;return this._focusOnlyEventStrategy.enableHotKeys(e,t,n,r)}},{key:"updateEnabledHotKeys",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=4<arguments.length?arguments[4]:void 0;return this._focusOnlyEventStrategy.updateEnabledHotKeys(e,t,n,r,i)}},{key:"disableHotKeys",value:function(e,t){return this._focusOnlyEventStrategy.disableHotKeys(e,t)}},{key:"handleKeydown",value:function(e,t,n,r){if(Jo(t))return this._focusOnlyEventStrategy.handleKeydown(e,t,n,r)}},{key:"handleKeyPress",value:function(e,t,n,r){if(Jo(t))return this._focusOnlyEventStrategy.handleKeyPress(e,t,n,r)}},{key:"handleKeyUp",value:function(e,t,n,r){if(Jo(t))return this._focusOnlyEventStrategy.handleKeyUp(e,t,n,r)}},{key:"enableGlobalHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;return this._globalEventStrategy.enableHotKeys(e,t,n,r,i)}},{key:"updateEnabledGlobalHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;return this._globalEventStrategy.updateEnabledHotKeys(e,t,n,r,i)}},{key:"disableGlobalHotKeys",value:function(e){return this._globalEventStrategy.disableHotKeys(e)}},{key:"handleGlobalKeyDown",value:function(e){return this._globalEventStrategy.handleKeydown(e)}},{key:"handleGlobalKeyPress",value:function(e){return this._globalEventStrategy.handleKeyPress(e)}},{key:"handleGlobalKeyUp",value:function(e){return this._globalEventStrategy.handleKeyUp(e)}},{key:"ignoreEvent",value:function(e){this._focusOnlyEventStrategy.getEventPropagator().ignoreEvent(e)}},{key:"observeIgnoredEvents",value:function(e){this._focusOnlyEventStrategy.getEventPropagator().observeIgnoredEvents(e)}},{key:"closeHangingKeyCombination",value:function(e,t){this._focusOnlyEventStrategy.closeHangingKeyCombination(e,t)}},{key:"reactAppHistoryWithEvent",value:function(e,t){var n=this._focusOnlyEventStrategy.eventPropagator.getPreviousPropagation();return n.isForKey(e)&&n.isForEventType(t)?n.isHandled()?Bo:n.isIgnoringEvent()?Uo:qo:Ho}},{key:"simulatePendingKeyPressEvents",value:function(){this._focusOnlyEventStrategy.simulatePendingKeyPressEvents()}},{key:"simulatePendingKeyUpEvents",value:function(){this._focusOnlyEventStrategy.simulatePendingKeyUpEvents()}},{key:"isGlobalListenersBound",value:function(){return this._globalEventStrategy.listenersBound}}]),e}();function Qo(e,t){var n=t.deprecatedAPI,r=n.contextTypes,i=n.childContextTypes,o=t.newAPI.contextType;if(void 0===d.createContext)e.contextTypes=r,e.childContextTypes=i,e.prototype.getChildContext=function(){return this._childContext};else{var a=d.createContext(o);e.contextType=a,e.prototype._originalRender=e.prototype.render,e.prototype.render=function(){var e=this._originalRender();return e?d.createElement(a.Provider,{value:this._childContext},e):null}}return e}function Zo(e){function t(e,t){return di({},i[e]||{},t[e]||{})}function n(e){return t("handlers",e)}function r(e){return t("keyMap",e)}var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=function(t){function i(e){var t;return ai(this,i),(t=ki(this,fi(i).call(this,e)))._handleFocus=t._handleFocus.bind(bi(bi(t))),t._handleBlur=t._handleBlur.bind(bi(bi(t))),t._handleKeyDown=t._handleKeyDown.bind(bi(bi(t))),t._handleKeyPress=t._handleKeyPress.bind(bi(bi(t))),t._handleKeyUp=t._handleKeyUp.bind(bi(bi(t))),t._componentIsFocused=t._componentIsFocused.bind(bi(bi(t))),t._id=Xo.getInstance().registerKeyMap(e.keyMap),t._childContext={hotKeysParentId:t._id},t}return hi(i,f.exports.PureComponent),ui(i,[{key:"render",value:function(){var t=this.props;t.keyMap,t.handlers,t.allowChanges,t.root;var n=mi(t,["keyMap","handlers","allowChanges","root"]),r={onFocus:this._wrapFunction("onFocus",this._handleFocus),onBlur:this._wrapFunction("onBlur",this._handleBlur),tabIndex:Ci.option("defaultTabIndex")};return this._shouldBindKeyListeners()&&(r.onKeyDown=this._handleKeyDown,r.onKeyPress=this._handleKeyPress,r.onKeyUp=this._handleKeyUp),d.createElement(e,li({hotKeys:r},n))}},{key:"_shouldBindKeyListeners",value:function(){var e=r(this.props);return!po(e)||this.props.root||Ci.option("enableHardSequences")&&this._handlersIncludeHardSequences(e,n(this.props))}},{key:"_handlersIncludeHardSequences",value:function(e,t){return Object.keys(t).some((function(t){return!e[t]&&io.isValidKeySerialization(t)}))}},{key:"_wrapFunction",value:function(e,t){var n=this;return"function"==typeof this.props[e]?function(r){n.props[e](r),t(r)}:t}},{key:"_focusTreeIdsPush",value:function(e){this._focusTreeIds||(this._focusTreeIds=[]),this._focusTreeIds.push(e)}},{key:"_focusTreeIdsShift",value:function(){this._focusTreeIds&&this._focusTreeIds.shift()}},{key:"_getFocusTreeId",value:function(){if(this._focusTreeIds)return this._focusTreeIds[0]}},{key:"componentDidUpdate",value:function(){var e=Xo.getInstance();if(e.reregisterKeyMap(this._id,this.props.keyMap),this._componentIsFocused()&&(this.props.allowChanges||!Ci.option("ignoreKeymapAndHandlerChangesByDefault"))){var t=this.props,n=t.keyMap,r=t.handlers;e.updateEnabledHotKeys(this._getFocusTreeId(),this._id,n,r,this._getComponentOptions())}}},{key:"_componentIsFocused",value:function(){return!0===this._focused}},{key:"componentDidMount",value:function(){var e=Xo.getInstance(),t=this.context.hotKeysParentId;e.registerComponentMount(this._id,t)}},{key:"_handleFocus",value:function(){var e;this.props.onFocus&&(e=this.props).onFocus.apply(e,arguments);var t=Xo.getInstance().enableHotKeys(this._id,r(this.props),n(this.props),this._getComponentOptions());so(t)||this._focusTreeIdsPush(t),this._focused=!0}},{key:"componentWillUnmount",value:function(){var e=Xo.getInstance();e.deregisterKeyMap(this._id),e.registerComponentUnmount(),this._handleBlur()}},{key:"_handleBlur",value:function(){var e;this.props.onBlur&&(e=this.props).onBlur.apply(e,arguments);var t=Xo.getInstance().disableHotKeys(this._getFocusTreeId(),this._id);t||this._focusTreeIdsShift(),this._focused=!1}},{key:"_handleKeyDown",value:function(e){Xo.getInstance().handleKeydown(e,this._getFocusTreeId(),this._id,this._getEventOptions())&&this._focusTreeIdsShift()}},{key:"_handleKeyPress",value:function(e){Xo.getInstance().handleKeyPress(e,this._getFocusTreeId(),this._id,this._getEventOptions())&&this._focusTreeIdsShift()}},{key:"_handleKeyUp",value:function(e){Xo.getInstance().handleKeyUp(e,this._getFocusTreeId(),this._id,this._getEventOptions())&&this._focusTreeIdsShift()}},{key:"_getComponentOptions",value:function(){return{defaultKeyEvent:Ci.option("defaultKeyEvent")}}},{key:"_getEventOptions",value:function(){return{ignoreEventsCondition:Ci.option("ignoreEventsCondition")}}}]),i}();return ci(o,"propTypes",{keyMap:p.object,handlers:p.object,onFocus:p.func,onBlur:p.func,allowChanges:p.bool,root:p.bool}),Qo(o,{deprecatedAPI:{contextTypes:{hotKeysParentId:p.number},childContextTypes:{hotKeysParentId:p.number}},newAPI:{contextType:{hotKeysParentId:void 0}}})}var Yo=Zo(function(e){function t(){return ai(this,t),ki(this,fi(t).apply(this,arguments))}return hi(t,f.exports.Component),ui(t,[{key:"render",value:function(){var e=this.props,t=e.hotKeys,n=e.innerRef,r=e.component,i=mi(e,["hotKeys","innerRef","component"]),o=r||Ci.option("defaultComponent");return d.createElement(o,di({},t,{ref:n},i))}}]),t}());Yo.propTypes={innerRef:p.oneOfType([p.object,p.func])};var ea=function(e){function t(e){var n;return ai(this,t),(n=ki(this,fi(t).call(this,e)))._id=Xo.getInstance().registerGlobalKeyMap(e.keyMap),n._childContext={globalHotKeysParentId:n._id},n}return hi(t,f.exports.Component),ui(t,[{key:"render",value:function(){return this.props.children||null}},{key:"componentDidUpdate",value:function(){var e=Xo.getInstance();if(e.reregisterGlobalKeyMap(this._id,this.props.keyMap),this.props.allowChanges||!Ci.option("ignoreKeymapAndHandlerChangesByDefault")){var t=this.props,n=t.keyMap,r=t.handlers;e.updateEnabledGlobalHotKeys(this._id,n,r,this._getComponentOptions(),this._getEventOptions())}}},{key:"componentDidMount",value:function(){var e=this.props,t=e.keyMap,n=e.handlers,r=this.context.globalHotKeysParentId,i=Xo.getInstance();i.registerGlobalComponentMount(this._id,r),i.enableGlobalHotKeys(this._id,t,n,this._getComponentOptions(),this._getEventOptions())}},{key:"componentWillUnmount",value:function(){var e=Xo.getInstance();e.deregisterGlobalKeyMap(this._id),e.disableGlobalHotKeys(this._id),e.registerGlobalComponentUnmount()}},{key:"_getComponentOptions",value:function(){return{defaultKeyEvent:Ci.option("defaultKeyEvent")}}},{key:"_getEventOptions",value:function(){return{ignoreEventsCondition:Ci.option("ignoreEventsCondition")}}}]),t}();ci(ea,"propTypes",{keyMap:p.object,handlers:p.object,allowChanges:p.bool});var ta=Qo(ea,{deprecatedAPI:{contextTypes:{globalHotKeysParentId:p.number},childContextTypes:{globalHotKeysParentId:p.number}},newAPI:{contextType:{globalHotKeysParentId:void 0}}});function na(e){var t,n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{only:[],except:[]},i=2<arguments.length?arguments[2]:void 0;return n=t=function(t){function n(e){var t;return ai(this,n),(t=ki(this,fi(n).call(this,e)))._handleKeyEvent=t._handleKeyEvent.bind(bi(bi(t))),t._reloadDictionaries=t._reloadDictionaries.bind(bi(bi(t))),t}return hi(n,f.exports.PureComponent),ui(n,[{key:"render",value:function(){var t=this.props;t.only,t.except;var n=mi(t,["only","except"]),r={onKeyDown:this._handleKeyEvent,onKeyPress:this._handleKeyEvent,onKeyUp:this._handleKeyEvent,onFocus:this._reloadDictionaries};return d.createElement(e,li({hotKeys:r},n))}},{key:"_reloadDictionaries",value:function(){var e=this.props,t=e.only,n=e.except;this._onlyDict=ra(t),this._exceptDict=ra(n)}},{key:"_shouldIgnoreEvent",value:function(e){var t=e.key;return po(this._onlyDict)?!!po(this._exceptDict)||!Ai(this._exceptDict,t):po(this._exceptDict)?Ai(this._onlyDict,t):Ai(this._onlyDict,t)&&!Ai(this._exceptDict,t)}},{key:"_handleKeyEvent",value:function(e){this._shouldIgnoreEvent(e)&&Xo.getInstance()[i](e)}}]),n}(),ci(t,"propTypes",{only:p.oneOfType([p.string,p.arrayOf(p.string)]),except:p.oneOfType([p.string,p.arrayOf(p.string)])}),ci(t,"defaultProps",r),n}function ra(e){return bo(e).reduce((function(e,t){var n=Ui(t);if(!Gi(n))throw new zi(t);return[ro,no,Pi,Mi,Yi,Zi].forEach((function(t){e[t(n)]=!0})),e}),{})}var ia=na(function(e){function t(){return ai(this,t),ki(this,fi(t).apply(this,arguments))}return hi(t,f.exports.Component),ui(t,[{key:"render",value:function(){var e=this.props,t=e.hotKeys,n=mi(e,["hotKeys"]),r=n.component||Ci.option("defaultComponent");return d.createElement(r,di({},t,n))}}]),t}(),{},"ignoreEvent"),oa=na(function(e){function t(){return ai(this,t),ki(this,fi(t).apply(this,arguments))}return hi(t,f.exports.Component),ui(t,[{key:"render",value:function(){var e=this.props,t=e.hotKeys,n=mi(e,["hotKeys"]),r=n.component||Ci.option("defaultComponent");return d.createElement(r,di({},t,n))}}]),t}(),{},"observeIgnoredEvents");var aa=y(Object.freeze(Object.defineProperty({__proto__:null,HotKeys:Yo,GlobalHotKeys:ta,IgnoreKeys:ia,ObserveKeys:oa,withHotKeys:Zo,withIgnoreKeys:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{only:[],except:[]};return na(e,t,"ignoreEvent")},withObserveKeys:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{only:[],except:[]};return na(e,t,"observeIgnoredEvents")},configure:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Ci.init(e)},getApplicationKeyMap:function(){return Xo.getInstance().getApplicationKeyMap()},recordKeyCombination:function(e){return Xo.getInstance().addKeyCombinationListener(e)}},Symbol.toStringTag,{value:"Module"})));ii.exports=aa;const sa=v.div`
  background-color: transparent;
  border: none;
  padding: 0.27rem 0.5rem 0.5rem 0;
  color: ${({theme:e})=>e.brand};
  height: 1rem;
  border: none;
  font-weight: bold;
`,ua=g(v.div`
  box-sizing: border-box;
  border-radius: 3px;
  background-color: ${({theme:e})=>e.backgroundDarker};
  box-shadow: 0 2px 25px 0 ${({theme:e})=>e.darkShadow};
  color: ${({theme:e})=>e.fontDark};
  border-radius: 2px;
  padding: 0.5rem;
  line-height: 1rem;
  margin-top: 2.5rem;
  font-weight: bold;
  position: fixed;
  width: auto;
  z-index: 802;
`),ca=v.div`
  color: ${({theme:e})=>e.font};
  display: flex;
  padding-bottom: 0.5rem;
`,la=d.memo((({barRef:e,followRef:t,serviceRef:n,style:r,machine:i})=>{const o=f.exports.useContext(m);let a,c;[a,c]=i||ri(n);const l=f.exports.useRef(),[h,p]=f.exports.useState(null),{error:y,errorId:v}=a.context,[g,E]=b((()=>{const e=t?{left:t.current.getBoundingClientRect().x,top:t.current.getBoundingClientRect().y}:{};return u(s({},e),{opacity:v?1:0,from:{opacity:0},config:k.stiff})}));return f.exports.useEffect((()=>{h&&clearTimeout(h),!v&&p(setTimeout((()=>c("CLEAR_ERROR")),1e3)),E({opacity:v?1:0})}),[v]),H(l,(()=>c("CLEAR_ERROR_ID"))),U(e,t,E),d.createElement(ua,{ref:l,style:s(u(s({},g),{display:y?"block":"none"}),r)},y?d.createElement(d.Fragment,null,d.createElement(ca,null,d.createElement(_,{style:{color:o.error,marginRight:"0.5rem"}}),d.createElement("div",{style:{marginTop:"0.25rem"}},`Invalid ${y.name}.`)),y.error):null)})),da=g(v.div`
  cursor: pointer;
  margin: 0.25rem 0.25rem;
  padding: 0.1rem 0.25rem;
  font-weight: bold;
  color: ${({theme:e})=>e.fontDark};
`),ha=d.memo((({result:e,isActive:t,send:n,highlight:r})=>{const i=f.exports.useRef(null),o=f.exports.useContext(m),[a,s]=b((()=>({backgroundColor:t?o.backgroundLight:o.backgroundDark,color:t?o.font:o.fontDark})));f.exports.useEffect((()=>{s({backgroundColor:t?o.backgroundLight:o.backgroundDark,color:t?o.font:o.fontDark}),t&&i.current&&i.current.scrollIntoView()}),[t,i.current]);return d.createElement(da,{ref:i,onClick:e=>n({type:"COMMIT",value:e.target.dataset.result,click:!0}),onMouseEnter:()=>s({backgroundColor:o.backgroundLight,color:o.font}),onMouseLeave:()=>!t&&s({backgroundColor:o.backgroundDark,color:o.fontDark}),style:a,"data-result":e},[null,void 0].includes(e)?d.createElement("code",{style:{color:r}},"None"):e)})),fa=g(v.div`
  background-color: ${({theme:e})=>e.backgroundDark};
  border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  border-radius: 2px;
  box-shadow: 0 2px 20px ${({theme:e})=>e.backgroundDark};
  box-sizing: border-box;
  margin-top: 2.5rem;
  position: fixed;
  width: auto;
  z-index: 801;
  max-height: 328px;
  overflow-y: scroll;
  scrollbar-width: none;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }
`),pa=d.memo((e=>{var t=e,{results:n,send:r,currentResult:i,barRef:o,followRef:a,bestMatch:l,highlight:h}=t,f=c(t,["results","send","currentResult","barRef","followRef","bestMatch","highlight"]);const[p,y]=b((()=>{const e=a?{left:a.current.getBoundingClientRect().x,top:a.current.getBoundingClientRect().y}:{};return u(s({},e),{opacity:1,from:{opacity:0},config:k.stiff})}));return U(o,a,y),n.length?d.createElement(fa,s({style:p,onMouseEnter:()=>r("MOUSEENTER"),onMouseLeave:()=>r("MOUSELEAVE")},f),n.map(((e,t)=>d.createElement(ha,{key:e,result:e,isActive:i===t||l===e,send:r,highlight:h})))):null})),ya=(e,t)=>{t=t||"";const n=e.filter((e=>e.toLowerCase().startsWith(t.toLowerCase())))[0];return n&&t.length?{placeholder:n.slice(t.length),value:n}:{placeholder:"",value:null}},va=(e,t)=>{const n=e.filter((e=>e.toLowerCase()===t.toLowerCase()));return 1===n.length?n[0]:null},{assign:ga}=er,ma=e=>"string"!=typeof e?String(e):e,ba=e=>e.includes("|")?["Union[",e.split("|").map((e=>ba(e))).join(", "),"]"].join(""):"list<str>"===e?"List[str]":"list<id>"===e?"List[id]":e,ka={bool:{castFrom:e=>e?"True":"False",castTo:e=>0===["true","false"].indexOf(e.toLowerCase()),parse:e=>e.toLowerCase().charAt(0).toUpperCase()+e.toLowerCase().slice(1),validate:e=>["true","false"].indexOf(ma(e).toLowerCase())>=0},float:{castFrom:e=>String(e),castTo:e=>+e,parse:e=>{const t=e.replace(/[\s]/g,""),[n,r]=t.split(".");return n.replace(/\B(?=(\d{3})+(?!\d))/g,",")+(r?"."+r:"")},validate:e=>{const t=ma(e).replace(/[\s]/g,"");return""!==t&&!isNaN(+t)}},field:{castFrom:e=>e,castTo:e=>e,parse:(e,t)=>t.filter((t=>t.toLowerCase()===e.toLowerCase()))[0],validate:(e,t)=>"string"==typeof e&&t.includes(e.toLowerCase())},dict:{castFrom:e=>JSON.stringify(e,null,2),castTo:e=>"string"==typeof e?JSON.parse(e):e,parse:e=>e,validate:e=>{try{return("string"==typeof e?JSON.parse(e):e)instanceof Object&&!Array.isArray(e)}catch{return!1}}},id:{castFrom:e=>e,castTo:e=>e,parse:e=>e,validate:e=>/[0-9A-Fa-f]{24}/g.test(e)},int:{castFrom:e=>String(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),castTo:e=>+e.replace(/[,\s]/g,""),parse:e=>String(+e.replace(/[,\s]/g,"")).replace(/\B(?=(\d{3})+(?!\d))/g,","),validate:e=>/^\d+$/.test(ma(e).replace(/[,\s]/g,""))},json:{castFrom:e=>JSON.stringify(e,null,2),castTo:e=>"string"==typeof e?JSON.parse(e):e,parse:e=>e,validate:e=>{try{return JSON.parse(e),!0}catch{return!1}}},"list<field>":{castFrom:e=>e.join(","),castTo:e=>e.split(","),parse:e=>e.replace(/[\s\'\"\[\]]/g,""),validate:(e,t)=>{const n=e.replace(/[\s]/g,"");let r=null;try{r=JSON.parse(n)}catch{r=n.split(",")}return Array.isArray(r)&&r.every((e=>ka.field.validate(e,t)))}},"list<id>":{castFrom:e=>e.join(","),castTo:e=>e.split(","),parse:e=>e.replace(/[\s\'\"\[\]]/g,""),validate:e=>{const t=e.replace(/[\s]/g,"");let n=null;try{n=JSON.parse(t)}catch{n=t.split(",")}return Array.isArray(n)&&n.every((e=>ka.id.validate(e)))}},"list<str>":{castFrom:e=>e.join(","),castTo:e=>e.split(","),parse:e=>e.replace(/[\s\'\"\[\]]/g,""),validate:e=>{const t=e.replace(/[\s]/g,"");let n=null;try{n=JSON.parse(t)}catch{n=t.split(",")}return Array.isArray(n)&&n.every((e=>ka.str.validate(e)))}},NoneType:{castFrom:e=>null===e?"None":e,castTo:()=>null,parse:()=>"None",validate:e=>[null,"None",""].some((t=>e===t))},str:{castFrom:e=>e,castTo:e=>e,parse:e=>e,validate:e=>{if("string"!=typeof e)return!1;try{return JSON.parse(e),!1}catch{return!0}}}};var _a=Fr({id:"viewStageParameter",initial:"decide",context:{id:void 0,defaultValue:void 0,parameter:void 0,stage:void 0,type:void 0,value:"",submitted:void 0,tail:void 0,focusOnInit:void 0,error:void 0,fieldNames:[]},states:{decide:{always:[{target:"editing",cond:e=>e.focusOnInit},{target:"reading.submitted",cond:e=>e.submitted},{target:"reading.pending"}]},reading:{initial:"pending",entry:"blurInput",states:{pending:{},submitted:{}},on:{EDIT:"editing"}},editing:{entry:[Vr("PARAMETER.EDIT"),ga({bestMatch:({fieldNames:e,value:t,type:n})=>"field"===n?ya(e,t):{},currentResult:null,prevValue:({value:e})=>e,focusOnInit:!1,results:({type:e,fieldNames:t,value:n})=>"field"===e?t.filter((e=>e.toLowerCase().startsWith(n.toLowerCase()))):[]}),"focusInput"],initial:"notHovering",states:{hovering:{on:{MOUSELEAVE:"notHovering"}},notHovering:{on:{MOUSEENTER:"hovering"}}},on:{CHANGE:{actions:[ga({bestMatch:({fieldNames:e,type:t},{value:n})=>"field"===t?ya(e,n):{},currentResult:null,value:(e,{value:t})=>t,errorId:void 0,results:({type:e,fieldNames:t},{value:n})=>"field"===e?t.filter((e=>e.toLowerCase().startsWith(n.toLowerCase()))):[]})]},COMMIT:[{target:"decide",actions:[ga({submitted:!0,value:({type:e,value:t,defaultValue:n,fieldNames:r,bestMatch:i},{value:o})=>{const a="field"===e?va(r,t):null;return t=o||t,""===(t=a||(i.value?i.value:t))&&n?n:e.split("|").reduce(((e,n)=>{if(void 0!==e)return e;const i=ka[n];return i.validate(t,r)?i.parse(t,r):e}),void 0)},errorId:void 0,bestMatch:{}}),"blurInput",Vr((e=>({type:"PARAMETER.COMMIT",parameter:e})))],cond:({type:e,fieldNames:t,value:n,defaultValue:r,bestMatch:i},{value:o})=>{n=o||n;const a="field"===e?va(t,n):null;return""===(n=a||(i.value?i.value:n))&&r||e.split("|").some((e=>ka[e].validate(n,t)))}},{actions:[ga({error:({type:e})=>({name:"value",error:`Expected type "${ba(e)}"`}),errorId:E()})]}],CANCEL:{target:"reading.pending",actions:[ga({value:({prevValue:e})=>e,errorId:void 0})]},NEXT_RESULT:{actions:ga({currentResult:({currentResult:e,results:t})=>null===e?0:Math.min(e+1,t.length-1),value:({currentResult:e,results:t})=>null===e?t[0]:t[Math.min(e+1,t.length-1)],bestMatch:{}})},PREVIOUS_RESULT:{actions:ga({currentResult:({currentResult:e})=>0===e||null===e?null:e-1,value:({currentResult:e,prevValue:t,results:n})=>0===e||null===e?t:n[e-1],bestMatch:{}})}}}},on:{BLUR:[{target:"reading.pending",cond:({submitted:e,prevValue:t})=>!e&&""!==t,actions:[ga({value:({prevValue:e})=>e})]},{target:"reading.submitted",cond:({submitted:e})=>e}],FOCUS:{actions:"focusInput"},CLEAR_ERROR:{actions:[ga({error:void 0})]},CLEAR_ERROR_ID:{actions:[ga({errorId:void 0})]},UPDATE:{actions:ga({active:(e,{active:t})=>t})}}},{actions:{blurInput:()=>{},focusInput:()=>{}}});const Ea=v.div`
  display: flex;
  overflow: visible;
  z-index: 800;
`,Sa=g(v.div`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  display: flex;
  overflow: visible;
  height: 100%;
`),wa=g(v(S)`
  & > input {
    background-color: transparent;
    border: none;
    padding: 0.5rem 0 0.5rem 0.5rem;
    color: ${({theme:e})=>e.font};
    height: 1rem;
    font-weight: bold;
  }

  & > input:focus {
    border: none;
    outline: none;
  }

  & ::placeholder {
    color: ${({theme:e})=>e.font};
  }
`),xa=g(v.div`
  font-weight: bold;
  position: fixed;
  line-height: 1rem;
  font-size: 14px;
  margin-left: -1px;
  overflow: visible;
  display: flex;
  border: 1px solid pink;
  border-style: solid;
  z-index: 800;
  will-change: transform;
  min-width: 2rem;
`),Ca=g(v.textarea`
  background-color: transparent;
  overflow: visible;
  line-height: 1rem;
  border: none;
  color: ${({theme:e})=>e.font};
  height: 100%;
  font-size: 14px;
  will-change: tranform;
  resize: none;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }

  &:focus {
    border: none;
    outline: none;
  }
`),Oa=g(v.button`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  color: ${({theme:e})=>e.font};
  background-color: ${({theme:e})=>e.backgroundLight};
  border-radius: 3px;
  position: relative;
  line-height: 1rem;
  cursor: pointer;
  font-weight: bold;
  position: absolute;
  bottom: 0.5rem;
  right: 0.5rem;

  :focus {
    outline: none;
  }
`),Ta=d.memo((({send:e})=>{const t=b({opacity:1,from:{opacity:0}});return d.createElement(Oa,{style:t,onClick:()=>e("COMMIT")},"Submit")})),Ia=({placeholder:e,parameter:t})=>void 0!==e?e:t;let Ka;const Pa=({barRef:e,parameterRef:t,followRef:n,inputRef:r,stageRef:i,onClose:o,hasExpansion:a})=>{const[u,c]=ri(t),[l]=ri(i),h=f.exports.useContext(m),p=f.exports.useRef(null),{active:y,value:v}=u.context,[k,_]=b((()=>({height:u.matches("editing")?200:36,position:u.matches("editing")?"fixed":"relative",backgroundColor:u.matches("editing")?h.backgroundDark:u.matches("reading.submitted")?h.backgroundLight:h.background,borderColor:y&&l.matches("focusedViewBar.yes")?h.brand:h.fontDarkest,opacity:1,from:{opacity:0}}))),E=b({width:u.matches("editing")?400:0});H(p,(e=>{c("BLUR"),o()})),f.exports.useEffect((()=>{_({position:u.matches("editing")?"fixed":"relative",backgroundColor:u.matches("editing")?h.backgroundDark:u.matches("reading.submitted")?h.backgroundLight:h.background,borderColor:y&&l.matches("focusedViewBar.yes")?h.brand:h.fontDarkest,height:u.matches("editing")?200:36,opacity:1})}),[u.matches("editing"),y,l.matches("focusedViewBar.yes")]);const S=()=>{Ka&&window.cancelAnimationFrame(Ka),Ka=window.requestAnimationFrame((()=>{const{x:t,y:r}=u.matches("editing")?n.current.getBoundingClientRect():{x:0,y:0};p.current.style.top=u.matches("editing")?`${r}px`:"unset",p.current.style.left=u.matches("editing")?`${t}px`:"unset";const{x:i,width:o}=e.current.getBoundingClientRect(),a=i+o;p.current.style.width=u.matches("editing")?`${Math.min(a-t,400)}px`:"auto"}))};return q(e.current?e.current:null,"scroll",S),q(window,"scroll",S),B(p?p.current:null,S),d.createElement(d.Fragment,null,u.matches("editing")&&d.createElement(g.div,{style:s({height:"100%"},E)}),d.createElement(xa,{style:k,onClick:()=>u.matches("reading")&&c("EDIT"),ref:p},u.matches("reading")?d.createElement("div",{style:{padding:"0.5em",whiteSpace:"nowrap"}},((e,t)=>ka.dict.validate(e)?"  . . .  ":""===e?t:e)(v,Ia(u.context))):d.createElement(d.Fragment,null,d.createElement(Ca,{key:"textarea",autoFocus:u.matches("editing"),style:E,onChange:e=>{c({type:"CHANGE",value:e.target.value.replace(/&#13/g,"\n")})},onKeyDown:e=>{["Escape","Tab"].includes(e.key)&&(c("COMMIT"),o())},value:v,ref:r}),a&&d.createElement(x,{style:{cursor:"pointer",color:h.font,marginTop:"0.2em",position:"absolute",right:"0.2rem"},onClick:o}),d.createElement(Ta,{key:"submit",send:c})),d.createElement(la,{key:"error",serviceRef:t,style:{marginTop:"12.5rem",marginLeft:0}})))},Aa=d.memo((({parameterRef:e,barRef:t,stageRef:n})=>{const r=f.exports.useContext(m),[i,o]=ri(e),[a]=ri(n),s=f.exports.useRef(),[u,c]=f.exports.useState({}),[l,h]=f.exports.useState(!1),{type:p,value:y,active:v,currentResult:g,results:k,bestMatch:_}=i.context,E=p.split("|").some((e=>["dict","json"].includes(e))),S="dict|str"===p,x=E&&(!S||l);let C=!1;try{const e=JSON.parse(y);C=!Array.isArray(e)&&"object"==typeof e}catch{}f.exports.useEffect((()=>{S&&!l&&C&&h(!0)}),[y]);const O=b({backgroundColor:i.matches("editing")?r.backgroundDark:i.matches("reading.submitted")?r.backgroundLight:r.background,borderStyle:"solid",borderColor:v&&a.matches("focusedViewBar.yes")?r.brand:r.fontDarkest,height:x&&i.matches("editing")?200:36,borderWidth:x?0:1,borderRightWidth:0,opacity:1,from:{opacity:0}}),T=i.matches("editing");return f.exports.useEffect((()=>{T&&s.current&&s.current.focus(),!T&&s.current&&s.current.blur()}),[T,s.current]),d.createElement(d.Fragment,null,d.createElement(Ea,{ref:e=>e&&e!==u.current&&c({current:e})},x?d.createElement(Pa,{parameterRef:e,barRef:t,followRef:u,inputRef:s,stageRef:n,onClose:()=>{S&&(h(!1),C&&o("BLUR"))},hasExpansion:S}):d.createElement(Sa,{style:O},d.createElement(wa,{placeholder:Ia(i.context),autoFocus:i.matches("editing"),value:C?". . .":i.matches("reading")&&y.length>24?y.slice(0,25)+"...":y,onFocus:()=>!T&&o({type:"EDIT"}),onBlur:()=>i.matches("editing.notHovering")&&o({type:"COMMIT"}),onChange:e=>{o({type:"CHANGE",value:e.target.value})},onKeyPress:e=>{"Enter"===e.key&&T&&o({type:"COMMIT"})},onKeyDown:e=>{switch(e.key){case"Tab":o("COMMIT");case"Escape":o("COMMIT");break;case"ArrowDown":o("NEXT_RESULT");break;case"ArrowUp":o("PREVIOUS_RESULT");break;case"ArrowRight":e.target.selectionStart===e.target.value.length&&_.value&&o({type:"CHANGE",value:_.value})}},ref:s}),d.createElement(sa,null,_?_.placeholder:""),S&&T&&d.createElement(w,{style:{cursor:"pointer",color:r.font,marginTop:"0.2em"},onMouseEnter:()=>o("MOUSEENTER"),onMouseLeave:()=>o("MOUSELEAVE"),onClick:()=>h(!0)}))),i.matches("editing")&&t.current&&u.current&&d.createElement(pa,{results:k,send:o,currentResult:g,bestMatch:_.value,followRef:u,barRef:t}),!E&&u.current&&d.createElement(la,{key:"error",serviceRef:e,barRef:t,followRef:u}))})),Ra=g(v.div`
  margin: 0.5rem 0.25rem;
  display: flex;
  position: relative;
`),La=g(v.div`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
  border-right-width: 0;
  position: relative;
  display: flex;
`),Ma=v(S)`
  & input {
    background-color: transparent;
    border: none;
    padding: 0.5rem;
    color: ${({theme:e})=>e.font};
    height: 1rem;
    border: none;
    font-weight: bold;
  }

  & input:focus {
    border: none;
    outline: none;
    font-weight: bold;
    padding-right: 0;
  }

  & ::placeholder {
    color: ${({theme:e})=>e.font};
    font-weight: bold;
  }
`,ja=g(v.div`
  box-sizing: border-box;
  border: 1px dashed ${({theme:e})=>e.fontDarkest};
  color: ${({theme:e})=>e.fontDarkest};
  border-radius: 3px;
  position: relative;
  margin: 0.5rem;
  cursor: pointer;
  font-weight: bold;

  padding: 0 0.25rem;

  :focus {
    outline: none;
  }
`),Na=v.div`
  width: 14px;
  height: 32px;
  display: block;
  position: relative;
  overflow: hidden;
`;g(v(C)`
  display: block;
  font-size: 14px;
`),g(v(O)`
  position: absolute;
`);const Da=d.memo((({send:e,index:t,active:n})=>{const r=f.exports.useContext(m),[i,o]=f.exports.useState(!1),[a,c]=b((()=>({background:r.background,color:n?r.font:r.fontDarkest,borderColor:n?r.brand:r.fontDarkest,top:n?-3:0,opacity:1,from:{opacity:0},config:k.stiff})));f.exports.useEffect((()=>{c({top:n?-3:0,color:n?r.font:r.fontDarkest,borderColor:n?r.brand:r.fontDarkest}),n?v():_()}),[n]);const[l,h]=b((()=>({marginTop:n?0:31}))),[p,y]=b((()=>({marginTop:n?-31:0}))),v=()=>{c({background:r.background}),h({marginTop:0}),y({marginTop:-31})},_=()=>{c({background:r.backgroundDark}),h({marginTop:31}),y({marginTop:0})};return f.exports.useEffect((()=>{(n||i)&&v(),!n&&!i&&_()}),[n,i]),d.createElement(ja,{style:a,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onClick:()=>e({type:"STAGE.ADD",index:t})},d.createElement(Na,null,d.createElement(g.div,{style:u(s({},p),{textAlign:"center",height:"100%",lineHeight:"2rem"})},">"),d.createElement(g.div,{style:u(s({},l),{textAlign:"center",height:"100%",lineHeight:"2rem"})},"+")))})),Fa=g(v.div`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  position: relative;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
  cursor: pointer;
`),Ha=g(v.button`
  background-color: ${({theme:e})=>e.backgroundLight};
  border: none;
  padding: 0.5rem;
  color: ${({theme:e})=>e.font};
  height: 1rem;
  display: block;
  height: 100%;
  border: none;
  cursor: pointer;
  font-weight: bold;
  margin: 0;

  :focus {
    outline: none;
  }
`),Ua=d.memo((({send:e,spring:t})=>d.createElement(Fa,{style:t,onClick:()=>e("STAGE.DELETE")},d.createElement(Ha,null,d.createElement(T,{style:{fontSize:"14px",display:"block"}}))))),qa=d.memo((({barRef:e,stageRef:t})=>{const n=f.exports.useContext(m),[r,i]=ri(t),o=f.exports.useRef(),[a,s]=f.exports.useState({}),{stage:u,stageInfo:c,parameters:l,results:h,currentResult:p,focusOnInit:y,active:v,bestMatch:g}=r.context,_=["input.reading.selected","input.reading.submitted"].some(r.matches),E=b({borderColor:v&&r.matches("focusedViewBar.yes")?n.brand:n.fontDarkest,opacity:1,from:{opacity:0}}),S=b({backgroundColor:_?n.backgroundLight:n.background,borderRightWidth:r.matches("delible.yes")&&l.length?0:1,borderColor:v&&r.matches("focusedViewBar.yes")?n.brand:n.fontDarkest,borderTopRightRadius:l.length?0:3,borderBottomRightRadius:l.length?0:3,opacity:1,from:{opacity:0}}),w=b({top:r.matches("focusedViewBar.yes")&&r.context.active?-3:0,config:k.stiff}),x=r.matches("input.editing");return f.exports.useEffect((()=>{x&&o.current&&o.current.focus(),!x&&o.current&&o.current.blur()}),[x,o.current]),d.createElement(d.Fragment,null,d.createElement(Ra,{style:w,ref:e=>e&&e!==a.current&&s({current:e})},d.createElement(La,{style:S},d.createElement(Ma,{placeholder:0===u.length?"+ add stage":"",value:u,autoFocus:y,onFocus:()=>!x&&i("EDIT"),onBlur:e=>{r.matches("input.editing.searchResults.notHovering")&&i("BLUR")},onChange:e=>i({type:"CHANGE",value:e.target.value}),onKeyPress:e=>{if("Enter"===e.key){const t=va(c.map((e=>e.name)),e.target.value);i({type:"COMMIT",value:t||(g.value?g.value:e.target.value)})}},onKeyDown:e=>{switch(e.key){case"Escape":i("BLUR");break;case"ArrowDown":i("NEXT_RESULT");break;case"ArrowUp":i("PREVIOUS_RESULT");break;case"ArrowRight":e.target.selectionStart===e.target.value.length&&g.value&&i({type:"CHANGE",value:g.value})}},style:{fontSize:"1rem"},ref:o}),r.matches("input.editing")?d.createElement(sa,null,g?g.placeholder:""):null,_&&d.createElement("div",{style:{width:"1rem",height:"1rem",margin:"0.4rem 0.5rem 0.5rem 0"}},d.createElement(V,{href:`https://voxel51.com/docs/fiftyone/api/fiftyone.core.stages.html#fiftyone.core.stages.${u}`,style:{maxHeight:"1rem",width:"1rem",display:"block"}},d.createElement(I,{style:{width:"1rem",height:"1rem"}})))),l.filter((e=>!e.parameter.startsWith("_"))).map((n=>d.createElement(Aa,{key:n.parameter,parameterRef:n.ref,barRef:e,stageRef:t}))),l.length?d.createElement(Ua,{spring:E,send:i}):null,r.matches("input.editing")&&e.current&&a.current&&d.createElement(pa,{results:h,send:i,currentResult:p,bestMatch:g.value,followRef:a,barRef:e}),a.current&&d.createElement(la,{serviceRef:t,followRef:a,barRef:e})))})),{choose:Ba}=er,Va=(e,t,n,r,i,o,a,s,u,c,l)=>({id:E(),defaultValue:i,parameter:n,type:r,stage:t,value:o||"",submitted:a,focusOnInit:s,inputRef:{},tail:u,currentResult:null,results:[],active:c,placeholder:l,fieldNames:e}),Ga=Fr({id:"viewStage",context:{id:void 0,stage:void 0,parameters:[],prevStage:"",stageInfo:void 0,index:void 0,focusOnInit:void 0,length:void 0,inputRef:{},fieldNames:[]},type:"parallel",states:{input:{initial:"decide",states:{hist:{type:"history"},decide:{always:[{target:"initializing",cond:e=>e.parameters.length&&!e.parameters[0].ref},{target:"waiting",cond:e=>!e.inputRef},{target:"editing",cond:({focusOnInit:e})=>e},{target:"reading"}]},initializing:{entry:qr({parameters:e=>e.parameters.map((e=>u(s({},e),{ref:Ar(_a.withContext(e))})))}),always:"decide"},waiting:{on:{FOCUS:{target:"decide",actions:qr({inputRef:(e,{inputRef:t})=>t})}}},reading:{entry:"blurInput",initial:"decide",states:{decide:{always:[{target:"pending",cond:e=>{return t=e.stageInfo,n=e.stage,!t.map((e=>e.name)).some((e=>e.toLowerCase()===n.toLowerCase()));var t,n}},{target:"selected"}]},hist:{type:"history"},pending:{},selected:{},submitted:{}},on:{EDIT:{target:"editing",actions:Vr((({index:e})=>({type:"STAGE.EDIT",index:e})))},DELETE:{target:"deleted"}}},editing:{entry:[qr({prevStage:e=>e.stage,prevSubmitted:e=>e.submitted,results:({stageInfo:e,stage:t})=>e.map((e=>e.name)).filter((e=>e.toLowerCase().startsWith(t.toLowerCase()))),currentResult:null,focusOnInit:!0,bestMatch:({stageInfo:e,stage:t})=>ya(e.map((e=>e.name)),t)})],type:"parallel",states:{input:{initial:"focused",states:{focused:{entry:"focusInput",on:{UNFOCUS_INPUT:"unfocused"}},unfocused:{on:{FOCUS_INPUT:"focused"}}}},searchResults:{initial:"notHovering",states:{hovering:{on:{MOUSELEAVE:"notHovering"}},notHovering:{on:{MOUSEENTER:"hovering"}}}}},on:{CHANGE:{actions:qr({stage:(e,t)=>t.value,results:({stageInfo:e},t)=>e.map((e=>e.name)).filter((e=>e.toLowerCase().startsWith(t.value.toLowerCase()))),currentResult:null,errorId:void 0,bestMatch:({stageInfo:e},{value:t})=>ya(e.map((e=>e.name)),t)})},COMMIT:[{target:"reading.selected",actions:[qr({focusOnInit:!1,stage:(e,{value:t})=>e.stageInfo.filter((e=>e.name.toLowerCase().startsWith(t.toLowerCase())))[0].name,parameters:(e,{value:t})=>{const n=e.stageInfo.filter((e=>e.name.toLowerCase().startsWith(t.toLowerCase())))[0].params;return n.map(((r,i)=>Va(e.fieldNames,t,r.name,r.type,r.default,r.name.startsWith("_")?r.default:"",r.name.startsWith("_"),0===i,i===n.length-1,e.active,r.placeholder))).map((e=>u(s({},e),{ref:Ar(_a.withContext(e))})))},errorId:void 0}),Br("UPDATE_DELIBLE"),"blurInput"],cond:({stageInfo:e},{value:t})=>va(e.map((e=>e.name)),t)},{actions:[qr({submitted:()=>!1,error:(e,{value:t})=>({name:"stage",error:`${""===t?'""':t} is not a valid stage`}),errorId:E()})]}],BLUR:[{target:"deleted",cond:e=>0===e.parameters.length},{target:"reading.pending",actions:[qr({focusOnInit:!1}),"blurInput"]}]}},deleted:{onEntry:[qr({stage:"",submitted:!1,parameters:[]}),Vr((e=>({type:"STAGE.DELETE",stage:e})))],always:"reading.pending"}}},delible:{initial:"decide",states:{decide:{always:[{target:"yes",cond:e=>e.length>1||e.submitted||""!==e.stage},{target:"no"}]},yes:{},no:{}}},draggable:{initial:"decide",states:{decide:{always:[{target:"yes",cond:e=>1===e.length},{target:"no"}]},yes:{},no:{}}},focusedViewBar:{initial:"decide",states:{decide:{always:[{target:"yes",cond:e=>e.focusOnInit},{target:"no"}]},yes:{},no:{}}}},on:{CLEAR_ERROR:{actions:[qr({error:void 0})]},CLEAR_ERROR_ID:{actions:[qr({errorId:void 0})]},NEXT_RESULT:{actions:qr({currentResult:({currentResult:e,results:t})=>null===e?0:Math.min(e+1,t.length-1),stage:({currentResult:e,results:t})=>null===e?t[0]:t[Math.min(e+1,t.length-1)],bestMatch:{}})},PREVIOUS_RESULT:{actions:qr({currentResult:({currentResult:e})=>0===e||null===e?null:e-1,stage:({currentResult:e,prevStage:t,results:n})=>0===e||null===e?t:n[e-1],bestMatch:{}})},BAR_FOCUS:"focusedViewBar.yes",BAR_BLUR:"focusedViewBar.no",UPDATE_DELIBLE:"delible","STAGE.UPDATE":{target:["draggable","delible","input"],actions:[qr({index:(e,{index:t})=>t,length:(e,{length:t})=>t,active:(e,{active:t})=>t,fieldNames:(e,{fieldNames:t})=>t}),(e,{active:t})=>{e.parameters.forEach((e=>e.ref.send({type:"UPDATE",active:t})))}]},"STAGE.DELETE":[{target:"input.deleted"}],"PARAMETER.COMMIT":{target:"input",actions:[qr({parameters:(e,t)=>e.parameters.map((e=>e.id===t.parameter.id?u(s({},t.parameter),{ref:e.ref}):e))}),Ba([{cond:e=>e.parameters.reduce(((e,t)=>t.submitted?e:e+1),0)>0,actions:Br("EDIT",{to:(e,t)=>{const n=e.parameters.reduce(((e,n,r)=>n.id===t.parameter.id?r:e),void 0);let r=n+1;for(;r<e.parameters.length;){if(!e.parameters[r].submitted)return e.parameters[r].ref;r+=1}for(r=n-1;r>=0;){if(!e.parameters[r].submitted)return e.parameters[r].ref;r-=1}}})},{cond:e=>0===e.parameters.reduce(((e,t)=>t.submitted?e:e+1),0),actions:[qr({submitted:!0,focusOnInit:!1,active:!1}),e=>{e.parameters.forEach((e=>e.ref.send({type:"UPDATE",active:!1})))},Vr((e=>({type:"STAGE.COMMIT",stage:e})))]}])]},"PARAMETER.EDIT":{actions:[Vr((e=>({type:"STAGE.EDIT",index:e.index})))]}}},{actions:{focusInput:()=>{},blurInput:()=>{}}}),{choose:za}=er,$a=(e,t,n,r,i,o,a,s,u,c,l)=>({id:t||E(),stage:n,parameters:u,stageInfo:i,index:r,focusOnInit:o,length:a,active:s,inputRef:{},submitted:c,loaded:l,fieldNames:e});function Wa(e,t,n,r=!0,i){return e.split("|").reduce(((e,o)=>{if(void 0!==e)return e;const a=ka[o];return a.validate(r?n:a.castFrom(n,i),i)?a[t](n,i):e}),void 0)}function Ja(e,t,n){return 1===e.length&&""===e[0].stage?[]:e.map((e=>function(e,t,n){return{kwargs:e.parameters.map(((r,i)=>[r.parameter,Wa(t[e.stage][i].type,"castTo",r.value,!0,n)])),_uuid:e.id,_cls:`fiftyone.core.stages.${e.stage}`}}(e,t,n)))}function Xa(e,t){const n=$a(e,null,"",0,t,!1,1,!0,[],!1);return[u(s({},n),{ref:Ar(Ga.withContext(n))})]}function Qa(e,t){const n=e.view,r=Object.fromEntries(t.map((e=>[e.name,e.params])));return G(n,Ja(e.stages,r,e.fieldNames))?e.stages:0===n.length?Xa(e.fieldNames,t):n.map(((r,i)=>{let o=r._cls.split(".");o=o[o.length-1];const a=$a(e.fieldNames,r._uuid,o,i,t,!1,e.stages.length,i===Math.min(n.length-1,e.activeStage),r.kwargs.map(((r,a)=>{const s=t.filter((e=>e.name===o))[0];return Va(e.fieldNames,o,r[0],s.params[a].type,s.params[a].default,Wa(s.params[a].type,"castFrom",r[1],!1,e.fieldNames),!0,!1,a===s.params.length-1,i===Math.min(n.length-1,e.activeStage),s.params[a].placeholder)})),!0,!0);return u(s({},a),{ref:Ar(Ga.withContext(a))})}))}const Za=Fr({id:"stages",context:{stages:[],stageInfo:void 0,activeStage:0,view:void 0,setView:void 0,http:void 0,fieldNames:[]},initial:"initializing",states:{decide:{always:[{target:"running.hist",cond:e=>e.stageInfo&&e.view,actions:[qr({stages:e=>Qa(e,e.stageInfo)})]},{target:"loading"}]},initializing:{},loading:{invoke:{src:function(e){return z()("GET","/stages")},onDone:{target:"running",actions:qr({stageInfo:(e,t)=>t.data.stages,stages:(e,t)=>0===e.view.length?Xa(e.fieldNames,t.data.stages):Qa(e,t.data.stages)})}}},running:{type:"parallel",states:{focus:{initial:"blurred",states:{focused:{entry:[({stages:e})=>e.forEach((e=>e.ref.send({type:"BAR_FOCUS"})))],exit:[({stages:e})=>e.forEach((e=>e.ref.send({type:"BAR_BLUR"})))],on:{TOGGLE_FOCUS:{target:"blurred"},NEXT:{actions:[qr({activeStage:({stages:e,activeStage:t})=>{const n=t;return n===e.length-.5?n:n%1!=0?Math.ceil(n):e[n].submitted&&(n===e.length-1||e[n+1].submitted)?n+.5:Math.min(e.length-1,n+1)}}),"sendStagesUpdate"]},PREVIOUS:{actions:[qr({activeStage:({stages:e,activeStage:t})=>{const n=t;return-.5===n?n:n%1!=0?Math.floor(n):e[n].submitted&&(0===n||e[n-1].submitted)?n-.5:Math.max(0,n-1)}}),"sendStagesUpdate"]},NEXT_STAGE:{actions:[qr({activeStage:({stages:e,activeStage:t})=>Math.min(Math.floor(t+1),e.length-1)}),"sendStagesUpdate"]},PREVIOUS_STAGE:{actions:[qr({activeStage:({stages:e,activeStage:t})=>Math.max(Math.ceil(t-1),0)}),"sendStagesUpdate"]},NEXT_RESULT:{actions:Br((({stages:e,activeStage:t})=>({type:"NEXT_RESULT",to:e[t].ref})))},PREVIOUS_RESULT:{actions:Br((({stages:e,activeStage:t})=>({type:"PREVIOUS_RESULT",to:e[t].ref})))},DELETE_ACTIVE_STAGE:{actions:Br((({activeStage:e,stages:t})=>({type:"STAGE.DELETE",stage:t[e]})))},ENTER:{actions:[za([{actions:Br((({activeStage:e})=>({type:"STAGE.ADD",index:Math.ceil(e)}))),cond:({activeStage:e})=>.5===Math.abs(e%1)},{actions:Br((({stages:e,activeStage:t})=>{e[t].ref.send({type:"EDIT"})}))}])]}}},blurred:{on:{TOGGLE_FOCUS:{target:"focused"}}}}},hovering:{initial:"no",states:{yes:{on:{MOUSELEAVE:"no"}},no:{on:{MOUSEENTER:"yes"}}}},hist:{type:"history",history:"deep"}}}},on:{"STAGE.EDIT":{actions:[qr({activeStage:(e,t)=>t.index}),"sendStagesUpdate"]},"STAGE.ADD":{actions:[qr({activeStage:(e,{index:t})=>t,stages:(e,{index:t})=>{const n=$a(e.fieldNames,null,"",t,e.stageInfo,!0,e.stages.length+1,!0,[],!1);return n.added=!0,[...e.stages.slice(0,t),u(s({},n),{ref:Ar(Ga.withContext(n))}),...e.stages.slice(t)].map(((t,n)=>u(s({},t),{index:n,active:n==n,length:e.stages.length+1})))}}),"sendStagesUpdate"]},"STAGE.COMMIT":{actions:[qr({stages:({stages:e},t)=>(e[t.stage.index]=u(s({},t.stage),{ref:e[t.stage.index].ref}),e),activeStage:({activeStage:e})=>e+.5}),"submit"]},CLEAR:{actions:[qr({stages:e=>{const t=$a(e.fieldNames,null,"",0,e.stageInfo,!1,0,!0,[],!1);return[u(s({},t),{ref:Ar(Ga.withContext(t))})]}}),"submit"]},"STAGE.DELETE":{actions:[qr({activeStage:({activeStage:e})=>Math.max(e-1,0),stages:({fieldNames:e,stages:t,stageInfo:n},r)=>{if(1===t.length&&t[0].id===r.stage.id){const t=$a(e,null,"",0,n,!1,0,!0,[],!1);return[u(s({},t),{ref:Ar(Ga.withContext(t))})]}return t.filter((e=>e.id!==r.stage.id||1===t.length)).map(((e,n)=>{const i=e.id===r.stage.id?r.stage:e;return i.index=n,i.length=Math.max(t.length-1,1),i}))}}),"submit"]},UPDATE:{target:"decide",actions:[qr({http:(e,{http:t})=>t,view:(e,{view:t})=>t,setView:(e,{setView:t})=>t,fieldNames:(e,{fieldNames:t})=>t}),"sendStagesUpdate"]}}},{actions:{sendStagesUpdate:e=>{e.stages.forEach((t=>t.ref.send({type:"STAGE.UPDATE",index:t.index,length:e.stages.length,active:t.index===e.activeStage,stage:t.stage,fieldNames:e.fieldNames})))},submit:({stages:e,stageInfo:t,fieldNames:n,setView:r,view:i})=>{const o=Ja(e,Object.fromEntries(t.map((e=>[e.name,e.params]))),n);G(o,i)||r(o)}}}),Ya=v.div`
  position: relative;
  background-color: ${({theme:e})=>e.backgroundDark};
  border-radius: 3px;
  border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  box-sizing: border-box;
  height: 52px;
  width: 100%;
  display: flex;
  overflow-x: scroll;
  scrollbar-width: none;
  min-width: 200px;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }
`,es=v.div`
  display: flex;
  align-items: center;
  position: absolute;
  z-index: 1;
  height: 100%;
  border-radius: 3px;
  top 0;
  height: 52px;
  right: 0;
  background-image: linear-gradient(
    to right,
    rgba(0, 0, 0, 0),
    30%,
    ${({theme:e})=>e.backgroundDark}
  );
  column-gap: 0.5rem;
  padding: 0 0.5rem;
  z-index: 801;
`,ts={VIEW_BAR_NEXT:"right",VIEW_BAR_PREVIOUS:"left",VIEW_BAR_NEXT_STAGE:"shift+right",VIEW_BAR_PREVIOUS_STAGE:"shift+left",VIEW_BAR_DELETE:["del","backspace"],VIEW_BAR_ENTER:"enter"},ns=d.memo((()=>{const[e,t]=function(e,t){void 0===t&&(t={});var n=f.exports.useCallback((function(e){var t=void 0===e.changed&&Object.keys(e.children).length;(e.changed||t)&&a(e)}),[]),r=Zr(e,t,n),i=Yr(f.exports.useState((function(){var e=r.machine.initialState;return t.state?vr.create(t.state):e})),2),o=i[0],a=i[1];return[o,r.send,r]}(Za),n=K($),r=W(),i=K(J({}));f.exports.useEffect((()=>{t({type:"UPDATE",view:n,setView:r,fieldNames:i})}),[n]);const{stages:o,activeStage:a}=e.context,s=f.exports.useRef(null),u={VIEW_BAR_NEXT:f.exports.useCallback((()=>t("NEXT")),[]),VIEW_BAR_PREVIOUS:f.exports.useCallback((()=>t("PREVIOUS")),[]),VIEW_BAR_NEXT_STAGE:f.exports.useCallback((()=>t("NEXT_STAGE")),[]),VIEW_BAR_PREVIOUS_STAGE:f.exports.useCallback((()=>t("PREVIOUS_STAGE")),[]),VIEW_BAR_DELETE:f.exports.useCallback((()=>t("DELETE_ACTIVE_STAGE")),[]),VIEW_BAR_ENTER:f.exports.useCallback((e=>{e.preventDefault(),t("ENTER")}),[])};return H(s,(()=>e.matches("running.focus.focused")&&t("TOGGLE_FOCUS"))),d.createElement("div",{style:{position:"relative",flex:"1",marginRight:"0.5rem",overflow:"hidden"}},d.createElement(ii.exports.GlobalHotKeys,{handlers:u,keyMap:ts}),d.createElement(Ya,{onClick:()=>e.matches("running.focus.blurred")&&t("TOGGLE_FOCUS"),ref:s},e.matches("running")?o.map(((n,r)=>d.createElement(d.Fragment,{key:n.id},n.submitted&&(0===r||o[r-1].submitted)?d.createElement(Da,{key:`insert-button-${n.id}`,send:t,index:r,active:a===r-.5&&e.matches("running.focus.focused")}):null,d.createElement(qa,{key:n.id,stageRef:n.ref,barRef:s})))):null,e.matches("running")&&o[o.length-1].submitted?d.createElement(Da,{key:"insert-button-tail",send:t,index:o.length,active:a===o.length-.5&&e.matches("running.focus.focused")}):null,d.createElement("div",{style:{display:"block",minWidth:64,maxWidth:64,height:"100%"}})),d.createElement(es,null,d.createElement(T,{onClick:()=>t("CLEAR"),style:{cursor:"pointer"}}),d.createElement(V,{href:"https://voxel51.com/docs/fiftyone/user_guide/app.html#using-the-view-bar",style:{display:"flex"}},d.createElement(I,null))))})),rs=function(){var e=[{alias:null,args:null,kind:"ScalarField",name:"storeTeamsSubmission",storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"TeamsStoreTeamsSubmissionMutation",selections:e,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"TeamsStoreTeamsSubmissionMutation",selections:e},params:{cacheID:"65a385a73975d2daf14d156ff5b7ed6a",id:null,metadata:{},name:"TeamsStoreTeamsSubmissionMutation",operationKind:"mutation",text:"mutation TeamsStoreTeamsSubmissionMutation {\n  storeTeamsSubmission\n}\n"}}}();rs.hash="75deb5f0c490b3073749a77128b435e4";const is="_form_1rpft_1",os="_text_1rpft_27";const as=()=>{var e,t,n,r,i,o,a,c;const[l,h]=f.exports.useState({email:"",firstname:"",lastname:"",company:"",role:""}),[p,y]=f.exports.useState("Submit"),[v,g]=P(X),m=A(Q),[b]=R.useMutation(rs),k=e=>t=>h(u(s({},l),{[e]:t.target.value}));return d.createElement("div",{className:is},d.createElement("div",{className:"_header_1rpft_20"},d.createElement("h3",null,"Get FiftyOne for your team"),d.createElement(le,{onClick:()=>m(!1),style:{display:"flex",alignItems:"center",padding:0}},d.createElement(T,null))),d.createElement("div",{className:os},"FiftyOne is and will always be open source software that is freely available to individual users, all 35,000 and counting. However, if youre part of a team, you may need more. Thats why weve begun deploying team-based versions of FiftyOne with multi-user collaboration features to early adopters.",d.createElement("br",null),d.createElement("br",null),"Are you interested in a team-based deployment of FiftyOne? Let us know how to contact you and our founders will reach out to make it happen!"),d.createElement("input",{key:"firstname",placeholder:"First name*",value:null!=(e=l.firstname)?e:"",maxLength:40,onChange:k("firstname")}),d.createElement("input",{key:"lastname",placeholder:"Last name*",value:null!=(t=l.lastname)?t:"",maxLength:40,onChange:k("lastname")}),d.createElement("input",{key:"email",placeholder:"Email*",type:"email",value:null!=(n=l.email)?n:"",onChange:k("email")}),d.createElement("input",{key:"company",placeholder:"Company",value:null!=(r=l.company)?r:"",maxLength:100,onChange:k("company")}),d.createElement("input",{key:"role",placeholder:"Role",value:null!=(i=l.role)?i:"",maxLength:100,onChange:k("role")}),d.createElement(le,{key:"submit",onClick:()=>{y("Submitting...");const e=new Headers;e.append("Content-Type","application/json"),fetch("https://api.hsforms.com/submissions/v3/integration/submit/4972700/87aa5367-a8f1-4ed4-9e23-1fdf8448d807",{method:"post",headers:e,mode:"cors",body:JSON.stringify({submittedAt:Date.now(),fields:[{name:"firstname",value:l.firstname},{name:"lastname",value:l.lastname},{name:"email",value:l.email},{name:"company",value:l.company},{name:"role",value:l.role}],context:{pageName:"FiftyOne App"}})}).then((e=>{if(200!==e.status)throw new Error("Failed submission");return e.json()})).then((()=>{y("Submitted. Thank you!"),g((e=>u(s({},e),{submitted:!0}))),b({variables:{}}),setTimeout((()=>m(!1)),2e3)})).catch((e=>{y("Something went wrong")}))},disabled:!((null==(o=l.email)?void 0:o.length)&&(null==(a=l.firstname)?void 0:a.length)&&(null==(c=l.lastname)?void 0:c.length))||v.submitted},p))},ss=l,us=({className:e,value:t})=>d.createElement(de,{title:t,className:e},t),cs=({prepared:e})=>{(e=>{const t=R.usePreloadedQuery(ss,e),n=R.useFragment(ye,t);f.exports.useEffect((()=>{if(n.doNotTrack)return;const e=n.dev,t=e?"dev":"prod";_t.initialize(Et.app_ids[t],{debug:e,gaOptions:{storage:"none",cookieDomain:"none",clientId:n.uid}}),_t.set({userId:n.uid,checkProtocolTask:null,[Et.dimensions.dev]:t,[Et.dimensions.version]:`${n.version}`,[Et.dimensions.context]:n.context+(ce()?"-DESKTOP":"")}),_t.pageview("/")}),[])})(e);const t=(e=>{const t=K(ue);return n=>{const r=R.usePreloadedQuery(ss,e),{data:i,refetch:o}=R.usePaginationFragment(ge,r);return L((()=>{o({search:n})}),200,[n,t]),f.exports.useMemo((()=>({total:i.datasets.total,values:i.datasets.edges.map((e=>e.node.name))})),[i])}})(e),n=R.usePreloadedQuery(ss,e),{teamsSubmission:r}=R.useFragment(pe,n),[i,o]=P(Q),a=ee(),s=te(),u=f.exports.useContext(F),c=ne(u);return d.createElement(d.Fragment,null,d.createElement(re,{title:"FiftyOne",onRefresh:()=>{a()},datasetSelectorProps:{component:us,onSelect:e=>{e!==c&&s(e)},placeholder:"Select dataset",useSearch:t,value:c||""}},c&&d.createElement(ns,null),!c&&d.createElement("div",{style:{flex:1}}),d.createElement("div",{className:ie},!r&&d.createElement(le,{onClick:()=>{o(!0)}},"Have a Team?"),d.createElement(oe,null),d.createElement(ae,null),d.createElement(se,null))),M.createPortal(d.createElement(j,null,i&&d.createElement(N.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},key:"teams"},d.createElement(as,null))),document.getElementById("teams")))};var ls=({children:e,prepared:t})=>{const n=R.usePreloadedQuery(ss,t),r=R.useFragment(he,n),i=Z();return f.exports.useEffect((()=>{i({colorscale:Y(r.colorscale),config:Y(r.config)})}),[r]),d.createElement(d.Fragment,null,d.createElement(cs,{prepared:t}),d.createElement("div",{className:Ot},d.createElement(f.exports.Suspense,{fallback:null},e)))};export{ls as default};
