<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>PCAP Next Generation Dump File Format</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="PCAP Next Generation Dump File Format">
<meta name="keywords" content="Internet-Draft, Libpcap, dump file format">
<meta name="generator" content="xml2rfc v1.33 (http://xml.resource.org/)">
<style type="text/css"><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tbody><tr><td class="header">Network Working Group</td><td class="header">L. Degioanni</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">CACE Technologies</td></tr>
<tr><td class="header">Expires: September 2, 2004</td><td class="header">F. Risso</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Politecnico di Torino</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">G. Varenni</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">CACE Technologies</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 2004</td></tr>
</tbody></table></td></tr></tbody></table>
<h1><br>PCAP Next Generation Dump File Format<br>PCAP-DumpFileFormat</h1>

<h3>Status of this Memo</h3>
<p>
This document is an Internet-Draft and is
in full conformance with all provisions of Section&nbsp;10 of RFC&nbsp;2026.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as “work in progress.”</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href="http://www.ietf.org/ietf/1id-abstracts.txt">http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href="http://www.ietf.org/shadow.html">http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 2, 2004.</p>

<h3>Copyright Notice</h3>
<p>
Copyright © The Internet Society (2004). All Rights Reserved.</p>

<h3>Abstract</h3>

<p>This document describes a format to dump captured packets on a file.
This format is extensible and it is currently proposed for
implementation in the libpcap/WinPcap packet capture library.
</p>
<h3>Updates</h3>

<ul class="text">
<li>[27 Jul 2009] Guy Harris: added some missing reserved block types in Appendix B.
</li>
<li>[27 Jul 2009] Guy Harris: fixed a typo in Appendix B. The range of standardized blocks are in the range 0x00000000-0x7FFFFFFF.
</li>
<li>[ 8 Feb 2008] Gianluca Varenni: better documentation for the format
of the timestamps. Renamed the if_tsaccur option into if_tsresol.
</li>
<li>[22 Oct 2007] Gianluca Varenni: added a note related to 64-bit
alignment. Specified that the option length field is the length without
padding. typos here and there. Added some option examples.
</li>
<li>[17 Oct 2007] Ulf Lamping: Major review: "Interface ID" in "ISB" now
 32 bits. isb_starttime/isb_endtime depends on if_tsaccur. Lot's of
other editing ...
</li>
<li>[ 8 Oct 2007] Ulf Lamping: Fixed several typos. Grouped the block types into mandatory, optional, experimental, obsolete.
</li>
<li>[14 Sep 2006] Gianluca Varenni: Added the block type code for Arinc 429 in AFDX Encapsulation Information Block
</li>
<li>[23 May 2006] Gianluca Varenni: Added the block type code for IRIG Timestamp Block
</li>
<li>[23 Apr 2006] Gianluca Varenni: Cleaned up Appendix C a bit: we
should use the LINKTYPE_xxx values from libpcap, not the DLT_xxx ones.
Fixed the introduction to the appendix and added some comments.
</li>
<li>[21 Mar 2006] Gianluca Varenni: Added a preliminary version of Appendix C, detailing the Standardized Link Types.
</li>
<li>[21 Mar 2006] Gianluca Varenni: Added a preliminary version of Appendix B, detailing the Standardized Block Type codes.
</li>
<li>[21 Mar 2006] Gianluca Varenni: Added the Enhanced Packet Block in
section 2.2. Fixed a typo in the list: it's Interface Statistics Block,
and not Capture Statistics Block.
</li>
<li>[21 Mar 2006] Gianluca Varenni: Fixed some minor typos in the document.
</li>
<li>[21 Mar 2006] Gianluca Varenni: Fixed an error in Packet Block: option pack_hash should have code 3.
</li>
<li>[21 Mar 2006] Gianluca Varenni: Added the definition of the Enhanced Packet Block.
</li>
<li>[12 Mar 2006] Gianluca Varenni: Added option if_tsoffset in the Interface Description Block.
</li>
</ul><a name="toc"></a><br><hr>
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Objectives<br>
<a href="#anchor2">2.</a>&nbsp;
General File Structure<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sectionblock">2.1.</a>&nbsp;
General Block Structure<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.2.</a>&nbsp;
Block Types<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.3.</a>&nbsp;
Logical Block Hierarchy<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.4.</a>&nbsp;
Physical File Layout<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sectionopt">2.5.</a>&nbsp;
Options<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.6.</a>&nbsp;
Data format<br>
<a href="#anchor7">3.</a>&nbsp;
Block Definition<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sectionshb">3.1.</a>&nbsp;
Section Header Block (mandatory)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sectionidb">3.2.</a>&nbsp;
Interface Description Block (mandatory)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sectionepb">3.3.</a>&nbsp;
Enhanced Packet Block (optional)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sectionpbs">3.4.</a>&nbsp;
Simple Packet Block (optional)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sectionpb">3.5.</a>&nbsp;
Packet Block (obsolete!)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sectionnrb">3.6.</a>&nbsp;
Name Resolution Block (optional)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sectionisb">3.7.</a>&nbsp;
Interface Statistics Block (optional)<br>
<a href="#anchor8">4.</a>&nbsp;
Experimental Blocks (deserved to a further investigation)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.1.</a>&nbsp;
Alternative Packet Blocks (experimental)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.2.</a>&nbsp;
Compression Block (experimental)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.3.</a>&nbsp;
Encryption Block (experimental)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.4.</a>&nbsp;
Fixed Length Block (experimental)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.5.</a>&nbsp;
Directory Block (experimental)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.6.</a>&nbsp;
Traffic Statistics and Monitoring Blocks (experimental)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.7.</a>&nbsp;
Event/Security Block (experimental)<br>
<a href="#anchor16">5.</a>&nbsp;
Recommended File Name Extension: .pcapng<br>
<a href="#anchor17">6.</a>&nbsp;
How to add Vendor / Domain specific extensions<br>
<a href="#anchor18">7.</a>&nbsp;
Conclusions<br>
<a href="#appendixPBFM">Appendix&nbsp;A.</a>&nbsp;
Packet Block Flags Word<br>
<a href="#appendixBlockCodes">Appendix&nbsp;B.</a>&nbsp;
Standardized Block Type Codes<br>
<a href="#appendixLinkTypes">Appendix&nbsp;C.</a>&nbsp;
Standardized Link Type Codes<br>
<a href="#appendixLinkHeaders">Appendix&nbsp;D.</a>&nbsp;
Link Layer Headers<br>
<a href="#rfc.authors">§</a>&nbsp;
Authors' Addresses<br>
<a href="#rfc.copyright">§</a>&nbsp;
Intellectual Property and Copyright Statements<br>
</p>
<br clear="all">

<a name="anchor1"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Objectives</h3>

<p>The problem of exchanging packet traces becomes more and more
critical every day; unfortunately, no standard solutions exist for this
task right now. One of the most accepted packet interchange formats is
the one defined by libpcap, which is rather old and does not fit for
some of the nowadays applications particularly from the extensibility
point of view.
</p>
<p>This document proposes a new format for dumping packet traces. The following goals are being pursued:
</p>
<ul class="text">
<li>Extensibility: aside of some common functionalities, third parties
should be able to enrich the information embedded in the file with
proprietary extensions, which will be ignored by tools that are not able
 to understand them.
</li>
<li>Portability: a capture trace must contain all the information needed
 to read data independently from network, hardware and operating system
of the machine that made the capture.
</li>
<li>Merge/Append data: it should be possible to add data at the end of a given file, and the resulting file must still be readable.
</li>
</ul>
<a name="anchor2"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
General File Structure</h3>

<a name="sectionblock"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
General Block Structure</h3>

<p>A capture file is organized in blocks, that are appended one to
another to form the file. All the blocks share a common format, which is
 shown in <a class="info" href="#formatblock">Figure&nbsp;1<span> (</span><span class="info">Basic block structure.</span><span>)</span></a>.
</p><br><hr class="insert">
<a name="formatblock"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Block Type                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Block Total Length                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                          Block Body                           /
/          /* variable length, aligned to 32 bits */            /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Block Total Length                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Basic block structure.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The fields have the following meaning:
</p>
<ul class="text">
<li>Block Type (32 bits): unique value that identifies the block. Values
 whose Most Significant Bit (MSB) is equal to 1 are reserved for local
use. They allow to save private data to the file and to extend the file
format. The list of currently defined types can be found in <a class="info" href="#appendixBlockCodes">Appendix&nbsp;B<span> (</span><span class="info">Standardized Block Type Codes</span><span>)</span></a>
</li>
<li>Block Total Length: total size of this block, in bytes. For instance, the length of a block that does not have body is 12 bytes.
</li>
<li>Block Body: content of the block.
</li>
<li>Block Total Length: total size of this block, in bytes. This field is duplicated for permitting backward file navigation.
</li>
</ul>
<p>This structure, shared among all blocks, makes it easy to process a
file and to skip unneeded or unknown blocks. Some blocks can contain
other blocks inside (nested blocks). Some of the blocks are mandatory,
i.e. a dump file is not valid if they are not present, other are
optional.
</p>
<p>The General Block Structure allows defining other blocks if needed. A
 parser that does non understand them can simply ignore their content.
</p>
<a name="anchor3"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Block Types</h3>

<p>The currently standardized Block Type codes are specified in <a class="info" href="#appendixBlockCodes">Appendix&nbsp;B<span> (</span><span class="info">Standardized Block Type Codes</span><span>)</span></a>, they have been grouped in the following four categories:
</p>
<p>MANDATORY blocks must appear at least once in each file:
</p>
<ul class="text">
<li><a class="info" href="#sectionshb">Section Header Block<span> (</span><span class="info">Section Header Block (mandatory)</span><span>)</span></a>: it defines the most important characteristics of the capture file.
</li>
<li><a class="info" href="#sectionidb">Interface Description Block<span> (</span><span class="info">Interface Description Block (mandatory)</span><span>)</span></a>: it defines the most important characteristics of the interface(s) used for capturing traffic.
</li>
</ul>
<p>OPTIONAL blocks can appear in a file:
</p>
<ul class="text">
<li><a class="info" href="#sectionepb">Enhanced Packet Block<span> (</span><span class="info">Enhanced Packet Block (optional)</span><span>)</span></a>: it contains a single captured packet, or a portion of it. It represents an evolution of the original <a class="info" href="#sectionpb">Packet Block<span> (</span><span class="info">Packet Block (obsolete!)</span><span>)</span></a>.
</li>
<li><a class="info" href="#sectionpbs">Simple Packet Block<span> (</span><span class="info">Simple Packet Block (optional)</span><span>)</span></a>: it contains a single captured packet, or a portion of it, with only a minimal set of information about it.
</li>
<li><a class="info" href="#sectionnrb">Name Resolution Block<span> (</span><span class="info">Name Resolution Block (optional)</span><span>)</span></a>: it defines the mapping from numeric addresses present in the packet dump and the canonical name counterpart.
</li>
<li><a class="info" href="#sectionisb">Interface Statistics Block<span> (</span><span class="info">Interface Statistics Block (optional)</span><span>)</span></a>:
 it defines how to store some statistical data (e.g. packet dropped,
etc) which can be useful to undestand the conditions in which the
capture has been made.
</li>
</ul>
<p>OBSOLETE blocks should not appear in newly written files (but left here for reference):
</p>
<ul class="text">
<li><a class="info" href="#sectionpb">Packet Block<span> (</span><span class="info">Packet Block (obsolete!)</span><span>)</span></a>: it contains a single captured packet, or a portion of it. It should be considered OBSOLETE, and superseded by the <a class="info" href="#sectionepb">Enhanced Packet Block<span> (</span><span class="info">Enhanced Packet Block (optional)</span><span>)</span></a>.
</li>
</ul>
<p>EXPERIMENTAL blocks are considered interesting but the authors
believe that they deserve more in-depth discussion before being defined:
</p>
<ul class="text">
<li>Alternative Packet Blocks
</li>
<li>Compression Block
</li>
<li>Encryption Block
</li>
<li>Fixed Length Block
</li>
<li>Directory Block
</li>
<li>Traffic Statistics and Monitoring Blocks
</li>
<li>Event/Security Blocks
</li>
</ul>
<a name="anchor4"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Logical Block Hierarchy</h3>

<p>The blocks build a logical hierarchy as they refer to each other. <a class="info" href="#block-hierarchy">Figure&nbsp;2<span> (</span><span class="info">Logical block Hierarchy of a pcapng file.</span><span>)</span></a> shows the logical hierarchy of the currently defined blocks in the form of a "tree view":
</p><br><hr class="insert">
<a name="block-hierarchy"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>Section Header
|
+- Interface Description
|  +- Simple Packet
|  +- Enhanced Packet
|  +- Interface Statistics
|
+- Name Resolution
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Logical block Hierarchy of a pcapng file.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>For example: each captured packet refers to a specific capture interface, the interface itself refers to a specific section.
</p>
<a name="anchor5"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Physical File Layout</h3>

<p>The file must begin with a Section Header Block. However, more than
one Section Header Block can be present on the dump, each one covering
the data following it till the next one (or the end of file). A Section
includes the data delimited by two Section Header Blocks (or by a
Section Header Block and the end of the file), including the first
Section Header Block.
</p>
<p>In case an application cannot read a Section because of different
version number, it must skip everything until the next Section Header
Block. Note that, in order to properly skip the blocks until the next
section, all blocks must have the fields Type and Length at the
beginning. This is a mandatory requirement that must be maintained in
future versions of the block format.
</p>
<p><a class="info" href="#fssample-SHB">Figure&nbsp;3<span> (</span><span class="info">File structure example: Typical configuration with a single Section Header Block.</span><span>)</span></a> shows a typical file configuration, with a single Section Header that covers the whole file.
</p><br><hr class="insert">
<a name="fssample-SHB"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SHB v1.0  |                      Data                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: File structure example: Typical configuration with a single Section Header Block.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p><a class="info" href="#fssample-SHB3">Figure&nbsp;4<span> (</span><span class="info">File structure example: three Section Header Blocks in a single file.</span><span>)</span></a>
 shows a file that contains three headers, and is normally the result of
 file concatenation. An application that understands only version 1.0 of
 the file format skips the intermediate section and restart processing
the packets after the third Section Header.
</p><br><hr class="insert">
<a name="fssample-SHB3"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>|--   1st Section   --|--   2nd Section   --|--  3rd Section  --|
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SHB v1.0  |  Data   | SHB V1.1  |  Data   | SHB V1.0  |  Data |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: File structure example: three Section Header Blocks in a single file.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p><a class="info" href="#fssample-minimum">Figure&nbsp;5<span> (</span><span class="info">File structure example: a pcapng file similar to a classical libpcap file.</span><span>)</span></a>
 shows a file comparable to a "classic libpcap" file - the minimum for a
 useful capture file. It contains a single Section Header Block (SHB), a
 single Interface Description Block (IDB) and a few Enhanced Packet
Blocks (EPB).
</p><br><hr class="insert">
<a name="fssample-minimum"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SHB | IDB | EPB | EPB |    ...    | EPB |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: File structure example: a pcapng file similar to a classical libpcap file.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p><a class="info" href="#fssample-full">Figure&nbsp;6<span> (</span><span class="info">File structure example: more complex pcapng file.</span><span>)</span></a>
 shows a complex example file. In addition to the minimum file above, it
 contains packets captured from three interfaces, and also includes some
 Name Resolution Blocks (NRB) and an Interface Statistics Block (ISB).
</p><br><hr class="insert">
<a name="fssample-full"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SHB | IDB | IDB | IDB | EPB | EPB | NRB |    ...    | EPB | ISB | NRB | EPB | EPB |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: File structure example: more complex pcapng file.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The last example should make it obvious, that the block structure
makes the file format very flexible compared to the classical libpcap
format.
</p>
<a name="sectionopt"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Options</h3>

<p>All the block bodies have the possibility to embed optional fields.
Optional fields can be used to insert some information that may be
useful when reading data, but that is not really needed for packet
processing. Therefore, each tool can either read the content of the
optional fields (if any), or skip some of them or even all at once.
</p>
<p>Skipping all the optional fields at once is straightforward because
most of the blocks are made of a first part with fixed format, and a
second optional part. Therefore, the Block Length field (present in the
General Block Structure, see <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>) can be used to skip everything till the next block.
</p>
<p>Options are a list of Type - Length - Value fields, each one containing a single value:
</p>
<ul class="text">
<li>Option Type (2 bytes): it contains the code that specifies the type
of the current TLV record. Option types whose Most Significant Bit is
equal to one are reserved for local use; therefore, there is no
guarantee that the code used is unique among all capture files
(generated by other applications). In case of vendor-specific extensions
 that have to be identified uniquely, vendors must request an Option
Code whose MSB is equal to zero.
</li>
<li>Option Length (2 bytes): it contains the actual length of the following 'Option Value' field without the padding bytes.
</li>
<li>Option Value (variable length): it contains the value of the given
option, aligned to a 32-bit boundary. The actual length of this field
(i.e. without the padding bytes) is specified by the Option Length
field.
</li>
</ul>
<p>Options may be repeated several times (e.g. an interface that has
several IP addresses associated to it) TODO: mention for each option, if
 it can/shouldn't appear more than one time. The option list is
terminated by a Option which uses the special 'End of Option' code
(opt_endofopt).
</p>
<p>The format of the optional fields is shown in <a class="info" href="#formatopt">Figure&nbsp;7<span> (</span><span class="info">Options format.</span><span>)</span></a>.
</p><br><hr class="insert">
<a name="formatopt"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Option Code              |         Option Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                       Option Value                            /
/          /* variable length, aligned to 32 bits */            /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                                                               /
/                 . . . other options . . .                     /
/                                                               /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Option Code == opt_endofopt  |  Option Length == 0          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: Options format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The following codes can always be present in any optional field:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Name</th><th align="left">Code</th><th align="left">Length</th><th align="left">Description</th><th align="left">Example(s)</th></tr>
<tr>
<td align="left">opt_endofopt</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">It delimits the end of the optional fields. This block cannot be repeated within a given list of options.</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">opt_comment</td>
<td align="left">1</td>
<td align="left">variable</td>
<td align="left">A UTF-8 string containing a comment that is associated to the current block.</td>
<td align="left">"This packet is the beginning of all of our problems" /
 "Packets 17-23 showing a bogus TCP retransmission, as reported in
bugzilla entry 1486!" / "Captured at the southern plant" / "I've checked
 again, now it's working ok" / ...</td>
</tr>
</tbody></table>
<br clear="all">

<a name="anchor6"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.6"></a><h3>2.6.&nbsp;
Data format</h3>

<p>Endianess
</p>
<p>Data contained in each section will always be saved according to the
characteristics (little endian / big endian) of the dumping machine.
This refers to all the fields that are saved as numbers and that span
over two or more bytes.
</p>
<p>The approach of having each section saved in the native format of the
 generating host is more efficient because it avoids translation of data
 when reading / writing on the host itself, which is the most common
case when generating/processing capture dumps.
</p>
<p>Please note: The endianess is indicated by the <a class="info" href="#sectionshb">Section Header Block<span> (</span><span class="info">Section Header Block (mandatory)</span><span>)</span></a>. As this block can appear several times in a pcapng file, a single file can contain both endianess variants!
</p>
<p>Alignment
</p>
<p>Most (all?) fields of this specification uses proper alignment for
16- and 32-bit values. This makes it easier and faster to read/write
file contents if using techniques like memory mapped files.
</p>
<p>The alignment bytes (marked in this document e.g. with "aligned to 32
 bits") should be filled with zero bytes (TODO: is this requirement a
good idea for the sake of performance / do we want to allow bogus bytes
here?).
</p>
<p>Please note: 64-bit values are not aligned to 64-bit boundaries. This
 is because the file is naturally aligned to 32-bit boundaries only.
Special care should be taken when reading and writing such values. TODO:
 the spec is not too consistent wrt how 64-bit values are saved. in the
Packet blocks we clearly specify where the low and high 32-bits of a
64-bit timestamp should be saved. In the SHB we do use the endianess of
the machine when we save the section length.
</p>
<p>TODO - Maybe we have to specify something more here. Is what we're saying enough to avoid any kind of ambiguity?.
</p>
<a name="anchor7"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Block Definition</h3>

<p>This section details the format of the body of the blocks currently defined.
</p>
<a name="sectionshb"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Section Header Block (mandatory)</h3>

<p>The Section Header Block is mandatory. It identifies the beginning of
 a section of the capture dump file. The Section Header Block does not
contain data but it rather identifies a list of blocks (interfaces,
packets) that are logically correlated. Its format is shown in <a class="info" href="#formatSHB">Figure&nbsp;8<span> (</span><span class="info">Section Header Block format.</span><span>)</span></a>.
</p><br><hr class="insert">
<a name="formatSHB"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
 0 |                   Block Type = 0x0A0D0D0A                     |
   +---------------------------------------------------------------+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                      Byte-Order Magic                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |          Major Version        |         Minor Version         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
16 |                                                               |
   |                          Section Length                       |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
24 /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +---------------------------------------------------------------+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: Section Header Block format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The meaning of the fields is:
</p>
<ul class="text">
<li>Block Type: The block type of the Section Header Block is the
integer corresponding to the 4-char string "\r\n\n\r" (0x0A0D0D0A). This
 particular value is used for 2 reasons:

<ol class="text">
<li>This number is used to detect if a file has been transferred via FTP
 or HTTP from a machine to another with an inappropriate ASCII
conversion. In this case, the value of this field will differ from the
standard one ("\r\n\n\r") and the reader can detect a possibly corrupted
 file.
</li>
<li>This value is palindromic, so that the reader is able to recognize
the Section Header Block regardless of the endianess of the section. The
 endianess is recognized by reading the Byte Order Magic, that is
located 8 bytes after the Block Type.
</li>
</ol>

</li>
<li>Block Total Length: total size of this block, as described in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>.
</li>
<li>Byte-Order Magic: magic number, whose value is the hexadecimal
number 0x1A2B3C4D. This number can be used to distinguish sections that
have been saved on little-endian machines from the ones saved on
big-endian machines.
</li>
<li>Major Version: number of the current mayor version of the format.
Current value is 1. This value should change if the format changes in
such a way that tools that can read the new format could not read the
old format (i.e., the code would have to check the version number to be
able to read both formats).
</li>
<li>Minor Version: number of the current minor version of the format.
Current value is 0. This value should change if the format changes in
such a way that tools that can read the new format can still
automatically read the new format but code that can only read the old
format cannot read the new format.
</li>
<li>Section Length: 64-bit value specifying the length in bytes of the
following section, excluding the Section Header Block itself. This field
 can be used to skip the section, for faster navigation inside large
files. Section Length equal -1 (0xFFFFFFFFFFFFFFFF) means that the size
of the section is not specified, and the only way to skip the section is
 to parse the blocks that it contains. Please note that if this field is
 valid (i.e. not -1), its value is always aligned to 32 bits, as all the
 blocks are aligned to 32-bit boundaries. Also, special care should be
taken in accessing this field: since the alignment of all the blocks in
the file is 32-bit, this field is not guaranteed to be aligned to a
64-bit boundary. This could be a problem on 64-bit workstations.
</li>
<li>Options: optionally, a list of options (formatted according to the rules defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>) can be present.
</li>
</ul>
<p>Adding new block types or options would not necessarily require that
either Major or Minor numbers be changed, as code that does not know
about the block type or option could just skip it; only if skipping a
block or option does not work should the minor version number be
changed.
</p>
<p>Aside from the options defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>, the following options are valid within this block:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Name</th><th align="left">Code</th><th align="left">Length</th><th align="left">Description</th><th align="left">Example(s)</th></tr>
<tr>
<td align="left">shb_hardware</td>
<td align="left">2</td>
<td align="left">variable</td>
<td align="left">An UTF-8 string containing the description of the hardware used to create this section.</td>
<td align="left">"x86 Personal Computer" / "Sun Sparc Workstation" / ...</td>
</tr>
<tr>
<td align="left">shb_os</td>
<td align="left">3</td>
<td align="left">variable</td>
<td align="left">An UTF-8 string containing the name of the operating system used to create this section.</td>
<td align="left">"Windows XP SP2" / "openSUSE 10.2" / ...</td>
</tr>
<tr>
<td align="left">shb_userappl</td>
<td align="left">4</td>
<td align="left">variable</td>
<td align="left">An UTF-8 string containing the name of the application used to create this section.</td>
<td align="left">"dumpcap V0.99.7" / ...</td>
</tr>
</tbody></table>
<br clear="all">

<a name="sectionidb"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Interface Description Block (mandatory)</h3>

<p>The Interface Description Block is mandatory. This block is needed to
 specify the characteristics of the network interface on which the
capture has been made. In order to properly associate the captured data
to the corresponding interface, the Interface Description Block must be
defined before any other block that uses it; therefore, this block is
usually placed immediately after the Section Header Block.
</p>
<p>An Interface Description Block is valid only inside the section which
 it belongs to. The structure of a Interface Description Block is shown
in <a class="info" href="#formatidb">Figure&nbsp;9<span> (</span><span class="info">Interface Description Block format.</span><span>)</span></a>.
</p><br><hr class="insert">
<a name="formatidb"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
 0 |                    Block Type = 0x00000001                    |
   +---------------------------------------------------------------+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |           LinkType            |           Reserved            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                            SnapLen                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
16 /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +---------------------------------------------------------------+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;9: Interface Description Block format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The meaning of the fields is:
</p>
<ul class="text">
<li>Block Type: The block type of the Interface Description Block is 1.
</li>
<li>Block Total Length: total size of this block, as described in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>.
</li>
<li>LinkType: a value that defines the link layer type of this
interface. The list of Standardized Link Layer Type codes is available
in <a class="info" href="#appendixLinkTypes">Appendix&nbsp;C<span> (</span><span class="info">Standardized Link Type Codes</span><span>)</span></a>.
</li>
<li>SnapLen: maximum number of bytes dumped from each packet. The
portion of each packet that exceeds this value will not be stored in the
 file. (TODO: Is there a need to signal "no limit"?)
</li>
<li>Options: optionally, a list of options (formatted according to the rules defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>) can be present.
</li>
</ul>
<p>Interface ID: Tools that write / read the capture file associate a
progressive 16-bit number (starting from '0') to each Interface
Definition Block. This number is unique within each Section and uniquely
 identifies the interface (inside the current section); therefore, two
Sections can have interfaces identified by the same identifiers. This
unique identifier is referenced by other blocks (e.g. Packet Block) to
point out the interface the block refers to (e.g. the interface that was
 used to capture the packet). (TODO - It would be nice, to have a
"invalid Interface ID" defined, e.g. 0xFFFFFFFF)
</p>
<p>In addition to the options defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>, the following options are valid within this block:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Name</th><th align="left">Code</th><th align="left">Length</th><th align="left">Description</th><th align="left">Example(s)</th></tr>
<tr>
<td align="left">if_name</td>
<td align="left">2</td>
<td align="left">Variable</td>
<td align="left">A UTF-8 string containing the name of the device used to capture data.</td>
<td align="left">"eth0" / "\Device\NPF_{AD1CE675-96D0-47C5-ADD0-2504B9126B68}" / ...</td>
</tr>
<tr>
<td align="left">if_description</td>
<td align="left">3</td>
<td align="left">Variable</td>
<td align="left">A UTF-8 string containing the description of the device used to capture data.</td>
<td align="left">"Broadcom NetXtreme" / "First Ethernet Interface" / ...</td>
</tr>
<tr>
<td align="left">if_IPv4addr</td>
<td align="left">4</td>
<td align="left">8</td>
<td align="left">Interface network address and netmask. This option can
be repeated multiple times within the same Interface Description Block
when multiple IPv4 addresses are assigned to the interface.</td>
<td align="left">192 168 1 1 255 255 255 0</td>
</tr>
<tr>
<td align="left">if_IPv6addr</td>
<td align="left">5</td>
<td align="left">17</td>
<td align="left">Interface network address and prefix length (stored in
the last byte). This option can be repeated multiple times within the
same Interface Description Block when multiple IPv6 addresses are
assigned to the interface.</td>
<td align="left">2001:0db8:85a3:08d3:1319:8a2e:0370:7344/64 is written (in hex) as "20 01 0d b8 85 a3 08 d3 13 19 8a 2e 03 70 73 44 40"</td>
</tr>
<tr>
<td align="left">if_MACaddr</td>
<td align="left">6</td>
<td align="left">6</td>
<td align="left">Interface Hardware MAC address (48 bits).</td>
<td align="left">00 01 02 03 04 05</td>
</tr>
<tr>
<td align="left">if_EUIaddr</td>
<td align="left">7</td>
<td align="left">8</td>
<td align="left">Interface Hardware EUI address (64 bits), if available.</td>
<td align="left">TODO: give a good example</td>
</tr>
<tr>
<td align="left">if_speed</td>
<td align="left">8</td>
<td align="left">8</td>
<td align="left">Interface speed (in bps).</td>
<td align="left">100000000 for 100Mbps</td>
</tr>
<tr>
<td align="left">if_tsresol</td>
<td align="left">9</td>
<td align="left">1</td>
<td align="left">Resolution of timestamps. If the Most Significant Bit
is equal to zero, the remaining bits indicates the resolution of the
timestamp as as a negative power of 10 (e.g. 6 means microsecond
resolution, timestamps are the number of microseconds since 1/1/1970).
If the Most Significant Bit is equal to one, the remaining bits
indicates the resolution as as negative power of 2 (e.g. 10 means 1/1024
 of second). If this option is not present, a resolution of 10^-6 is
assumed (i.e. timestamps have the same resolution of the standard
'libpcap' timestamps).</td>
<td align="left">6</td>
</tr>
<tr>
<td align="left">if_tzone</td>
<td align="left">10</td>
<td align="left">4</td>
<td align="left">Time zone for GMT support (TODO: specify better).</td>
<td align="left">TODO: give a good example</td>
</tr>
<tr>
<td align="left">if_filter</td>
<td align="left">11</td>
<td align="left">variable</td>
<td align="left">The filter (e.g. "capture only TCP traffic") used to
capture traffic. The first byte of the Option Data keeps a code of the
filter used (e.g. if this is a libpcap string, or BPF bytecode, and
more). More details about this format will be presented in Appendix XXX
(TODO). (TODO: better use different options for different fields? e.g.
if_filter_pcap, if_filter_bpf, ...)</td>
<td align="left">00 "tcp port 23 and host 10.0.0.5"</td>
</tr>
<tr>
<td align="left">if_os</td>
<td align="left">12</td>
<td align="left">variable</td>
<td align="left">A UTF-8 string containing the name of the operating
system of the machine in which this interface is installed. This can be
different from the same information that can be contained by the Section
 Header Block (<a class="info" href="#sectionshb">Section&nbsp;3.1<span> (</span><span class="info">Section Header Block (mandatory)</span><span>)</span></a>) because the capture can have been done on a remote machine.</td>
<td align="left">"Windows XP SP2" / "openSUSE 10.2" / ...</td>
</tr>
<tr>
<td align="left">if_fcslen</td>
<td align="left">13</td>
<td align="left">1</td>
<td align="left">An integer value that specified the length of the Frame
 Check Sequence (in bits) for this interface. For link layers whose FCS
length can change during time, the Packet Block Flags Word can be used
(see <a class="info" href="#appendixPBFM">Appendix&nbsp;A<span> (</span><span class="info">Packet Block Flags Word</span><span>)</span></a>).</td>
<td align="left">4</td>
</tr>
<tr>
<td align="left">if_tsoffset</td>
<td align="left">14</td>
<td align="left">8</td>
<td align="left">A 64 bits integer value that specifies an offset (in
seconds) that must be added to the timestamp of each packet to obtain
the absolute timestamp of a packet. If the option is missing, the
timestamps stored in the packet must be considered absolute timestamps.
The time zone of the offset can be specified with the option if_tzone.
TODO: won't a if_tsoffset_low for fractional second offsets be useful
for highly syncronized capture systems?</td>
<td align="left">1234</td>
</tr>
</tbody></table>
<br clear="all">

<a name="sectionepb"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Enhanced Packet Block (optional)</h3>

<p>An Enhanced Packet Block is the standard container for storing the
packets coming from the network. The Enhanced Packet Block is optional
because packets can be stored either by means of this block or the
Simple Packet Block, which can be used to speed up dump generation. The
format of an Enhanced Packet Block is shown in <a class="info" href="#formatepb">Figure&nbsp;10<span> (</span><span class="info">Enhanced Packet Block format.</span><span>)</span></a>.
</p>
<p>The Enhanced Packet Block is an improvement over the original <a class="info" href="#sectionpb">Packet Block<span> (</span><span class="info">Packet Block (obsolete!)</span><span>)</span></a>:
</p>
<ul class="text">
<li>it stores the Interface Identifier as a 32bit integer value. This is
 a requirement when a capture stores packets coming from a large number
of interfaces
</li>
<li>differently from the <a class="info" href="#sectionpb">Packet Block<span> (</span><span class="info">Packet Block (obsolete!)</span><span>)</span></a>,
 the number of packets dropped by the capture system between this packet
 and the previous one is not stored in the header, but rather in an
option of the block itself.
</li>
</ul><br><hr class="insert">
<a name="formatepb"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
 0 |                    Block Type = 0x00000006                    |
   +---------------------------------------------------------------+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                         Interface ID                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                        Timestamp (High)                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
16 |                        Timestamp (Low)                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
20 |                         Captured Len                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
24 |                          Packet Len                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
28 /                                                               /
   /                          Packet Data                          /
   /          /* variable length, aligned to 32 bits */            /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +---------------------------------------------------------------+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;10: Enhanced Packet Block format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The Enhanced Packet Block has the following fields:
</p>
<ul class="text">
<li>Block Type: The block type of the Enhanced Packet Block is 6.
</li>
<li>Block Total Length: total size of this block, as described in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>.
</li>
<li>Interface ID: it specifies the interface this packet comes from; the
 correct interface will be the one whose Interface Description Block
(within the current Section of the file) is identified by the same
number (see <a class="info" href="#sectionidb">Section&nbsp;3.2<span> (</span><span class="info">Interface Description Block (mandatory)</span><span>)</span></a>) of this field.
</li>
<li>Timestamp (High) and Timestamp (Low): high and low 32-bits of a
64-bit quantity representing the timestamp. The timestamp is a single
64-bit unsigned integer representing the number of units since 1/1/1970.

The way to interpret this field is specified by the 'if_tsresol' option
(see <a class="info" href="#formatidb">Figure&nbsp;9<span> (</span><span class="info">Interface Description Block format.</span><span>)</span></a>)
 of the Interface Description block referenced by this packet. Please
note that differently from the libpcap file format, timestamps are not
saved as two 32-bit values accounting for the seconds and microseconds
since 1/1/1970. They are saved as a single 64-bit quantity saved as two
32-bit words.
</li>
<li>Captured Len: number of bytes captured from the packet (i.e. the
length of the Packet Data field). It will be the minimum value among the
 actual Packet Length and the snapshot length (defined in <a class="info" href="#formatidb">Figure&nbsp;9<span> (</span><span class="info">Interface Description Block format.</span><span>)</span></a>).
 The value of this field does not include the padding bytes added at the
 end of the Packet Data field to align the Packet Data Field to a 32-bit
 boundary
</li>
<li>Packet Len: actual length of the packet when it was transmitted on
the network. It can be different from Captured Len if the user wants
only a snapshot of the packet.
</li>
<li>Packet Data: the data coming from the network, including link-layer
headers. The actual length of this field is Captured Len. The format of
the link-layer headers depends on the LinkType field specified in the
Interface Description Block (see <a class="info" href="#sectionidb">Section&nbsp;3.2<span> (</span><span class="info">Interface Description Block (mandatory)</span><span>)</span></a>) and it is specified in <a class="info" href="#appendixLinkHeaders">Appendix&nbsp;D<span> (</span><span class="info">Link Layer Headers</span><span>)</span></a>.
</li>
<li>Options: optionally, a list of options (formatted according to the rules defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>) can be present.
</li>
</ul>
<p>In addition to the options defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a> and in the <a class="info" href="#optionspb">Packet Block</a>, the following options are valid within this block:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Name</th><th align="left">Code</th><th align="left">Length</th><th align="left">Description</th><th align="left">Example(s)</th></tr>
<tr>
<td align="left">epb_flags</td>
<td align="left">2</td>
<td align="left">4</td>
<td align="left">A flags word containing link-layer information. A complete specification of the allowed flags can be found in <a class="info" href="#appendixPBFM">Appendix&nbsp;A<span> (</span><span class="info">Packet Block Flags Word</span><span>)</span></a>.</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">epb_hash</td>
<td align="left">3</td>
<td align="left">variable</td>
<td align="left">This option contains a hash of the packet. The first
byte specifies the hashing algorithm, while the following bytes contain
the actual hash, whose size depends on the hashing algorithm, and hence
from the value in the first bit. The hashing algorithm can be: 2s
complement (algorithm byte = 0, size=XXX), XOR (algorithm byte = 1,
size=XXX), CRC32 (algorithm byte = 2, size = 4), MD-5 (algorithm byte =
3, size=XXX), SHA-1 (algorithm byte = 4, size=XXX). The hash covers only
 the packet, not the header added by the capture driver: this gives the
possibility to calculate it inside the network card. The hash allows
easier comparison/merging of different capture files, and reliable data
transfer between the data acquisition system and the capture library.
(TODO: the text above uses "first bit", but shouldn't this be "first
byte"?!?) </td>
<td align="left">TODO: give a good example</td>
</tr>
<tr>
<td align="left">epb_dropcount</td>
<td align="left">4</td>
<td align="left">8</td>
<td align="left">A 64bit integer value specifying the number of packets
lost (by the interface and the operating system) between this packet and
 the preceding one.</td>
<td align="left">0</td>
</tr>
</tbody></table>
<br clear="all">

<a name="sectionpbs"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Simple Packet Block (optional)</h3>

<p>The Simple Packet Block is a lightweight container for storing the packets coming from the network. Its presence is optional.
</p>
<p>A Simple Packet Block is similar to a Packet Block (see <a class="info" href="#sectionpb">Section&nbsp;3.5<span> (</span><span class="info">Packet Block (obsolete!)</span><span>)</span></a>),
 but it is smaller, simpler to process and contains only a minimal set
of information. This block is preferred to the standard Packet Block
when performance or space occupation are critical factors, such as in
sustained traffic dump applications. A capture file can contain both
Packet Blocks and Simple Packet Blocks: for example, a capture tool
could switch from Packet Blocks to Simple Packet Blocks when the
hardware resources become critical.
</p>
<p>The Simple Packet Block does not contain the Interface ID field.
Therefore, it must be assumed that all the Simple Packet Blocks have
been captured on the interface previously specified in the first
Interface Description Block.
</p>
<p><a class="info" href="#formatpbs">Figure&nbsp;11<span> (</span><span class="info">Simple Packet Block format.</span><span>)</span></a> shows the format of the Simple Packet Block.
</p><br><hr class="insert">
<a name="formatpbs"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
 0 |                    Block Type = 0x00000003                    |
   +---------------------------------------------------------------+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                          Packet Len                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 /                                                               /
   /                          Packet Data                          /
   /          /* variable length, aligned to 32 bits */            /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +---------------------------------------------------------------+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;11: Simple Packet Block format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The Simple Packet Block has the following fields:
</p>
<ul class="text">
<li>Block Type: The block type of the Simple Packet Block is 3.
</li>
<li>Block Total Length: total size of this block, as described in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>.
</li>
<li>Packet Len: actual length of the packet when it was transmitted on
the network. Can be different from captured len if the packet has been
truncated by the capture process.
</li>
<li>Packet Data: the data coming from the network, including link-layers
 headers. The length of this field can be derived from the field Block
Total Length, present in the Block Header, and it is the minimum value
among the SnapLen (present in the Interface Description Block) and the
Packet Len (present in this header).
</li>
</ul>
<p>The Simple Packet Block does not contain the timestamp because this
is often one of the most costly operations on PCs. Additionally, there
are applications that do not require it; e.g. an Intrusion Detection
System is interested in packets, not in their timestamp.
</p>
<p>A Simple Packet Block cannot be present in a Section that has more
than one interface because of the impossibility to refer to the correct
one (it does not contain any Interface ID field).
</p>
<p>The Simple Packet Block is very efficient in term of disk space: a
snapshot whose length is 100 bytes requires only 16 bytes of overhead,
which corresponds to an efficiency of more than 86%.
</p>
<a name="sectionpb"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Packet Block (obsolete!)</h3>

<p>The Packet Block is marked obsolete, better use the Enhanced Packet Block instead!
</p>
<p>A Packet Block is the standard container for storing the packets
coming from the network. The Packet Block is optional because packets
can be stored either by means of this block or the Simple Packet Block,
which can be used to speed up dump generation. The format of a packet
block is shown in <a class="info" href="#formatpb">Figure&nbsp;12<span> (</span><span class="info">Packet Block format.</span><span>)</span></a>.
</p><br><hr class="insert">
<a name="formatpb"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
 0 |                    Block Type = 0x00000002                    |
   +---------------------------------------------------------------+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |         Interface ID          |          Drops Count          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                        Timestamp (High)                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
16 |                        Timestamp (Low)                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
20 |                         Captured Len                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
24 |                          Packet Len                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
28 /                                                               /
   /                          Packet Data                          /
   /          /* variable length, aligned to 32 bits */            /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +---------------------------------------------------------------+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;12: Packet Block format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The Packet Block has the following fields:
</p>
<ul class="text">
<li>Block Type: The block type of the Packet Block is 2.
</li>
<li>Block Total Length: total size of this block, as described in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>.
</li>
<li>Interface ID: it specifies the interface this packet comes from; the
 correct interface will be the one whose Interface Description Block
(within the current Section of the file) is identified by the same
number (see <a class="info" href="#sectionidb">Section&nbsp;3.2<span> (</span><span class="info">Interface Description Block (mandatory)</span><span>)</span></a>) of this field.
</li>
<li>Drops Count: a local drop counter. It specifies the number of
packets lost (by the interface and the operating system) between this
packet and the preceding one. The value xFFFF (in hexadecimal) is
reserved for those systems in which this information is not available.
</li>
<li>Timestamp (High) and Timestamp (Low): timestamp of the packet. The
format of the timestamp is the same already defined in the Enhanced
Packet Block (<a class="info" href="#sectionepb">Section&nbsp;3.3<span> (</span><span class="info">Enhanced Packet Block (optional)</span><span>)</span></a>).
</li>
<li>Captured Len: number of bytes captured from the packet (i.e. the
length of the Packet Data field). It will be the minimum value among the
 actual Packet Length and the snapshot length (SnapLen defined in <a class="info" href="#formatidb">Figure&nbsp;9<span> (</span><span class="info">Interface Description Block format.</span><span>)</span></a>).
 The value of this field does not include the padding bytes added at the
 end of the Packet Data field to align the Packet Data Field to a 32-bit
 boundary
</li>
<li>Packet Len: actual length of the packet when it was transmitted on
the network. Can be different from Captured Len if the user wants only a
 snapshot of the packet.
</li>
<li>Packet Data: the data coming from the network, including link-layer
headers. The format of the link-layer headers depends on the LinkType
field specified in the Interface Description Block (see <a class="info" href="#sectionidb">Section&nbsp;3.2<span> (</span><span class="info">Interface Description Block (mandatory)</span><span>)</span></a>) and it is specified in <a class="info" href="#appendixLinkHeaders">Appendix&nbsp;D<span> (</span><span class="info">Link Layer Headers</span><span>)</span></a>. The actual length of this field is Captured Len.
</li>
<li>Options: optionally, a list of options (formatted according to the rules defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>) can be present.
</li>
</ul>
<p>In addition to the options defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>, the following options are valid within this block:
</p><br><hr class="insert">
<a name="optionspb"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Name</th><th align="left">Code</th><th align="left">Length</th><th align="left">Description</th><th align="left">Example(s)</th></tr>
<tr>
<td align="left">pack_flags</td>
<td align="left">2</td>
<td align="left">4</td>
<td align="left">Same as epb_flags of the enhanced packet block.</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">pack_hash</td>
<td align="left">3</td>
<td align="left">variable</td>
<td align="left">Same as epb_hash of the enhanced packet block.</td>
<td align="left">TODO: give a good example</td>
</tr>
</tbody></table>
<br clear="all">
<table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<a name="sectionnrb"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Name Resolution Block (optional)</h3>

<p>The Name Resolution Block is used to support the correlation of
numeric addresses (present in the captured packets) and their
corresponding canonical names and it is optional. Having the literal
names saved in the file, this prevents the need of a name resolution in a
 delayed time, when the association between names and addresses can be
different from the one in use at capture time. Moreover, the Name
Resolution Block avoids the need of issuing a lot of DNS requests every
time the trace capture is opened, and allows to have name resolution
also when reading the capture with a machine not connected to the
network.
</p>
<p>A Name Resolution Block is normally placed at the beginning of the
file, but no assumptions can be taken about its position. Name
Resolution Blocks can be added in a second time by tools that process
the file, like network analyzers.
</p>
<p>The format of the Name Resolution Block is shown in <a class="info" href="#formatnrb">Figure&nbsp;13<span> (</span><span class="info">Name Resolution Block format.</span><span>)</span></a>.
</p><br><hr class="insert">
<a name="formatnrb"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
 0 |                    Block Type = 0x00000004                    |
   +---------------------------------------------------------------+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |      Record Type              |         Record Length         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 /                       Record Value                            /
   /          /* variable length, aligned to 32 bits */            /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   .                                                               .
   .                  . . . other records . . .                    .
   .                                                               .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Record Type == end_of_recs   |  Record Length == 00          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +---------------------------------------------------------------+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;13: Name Resolution Block format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The Name Resolution Block has the following fields:
</p>
<ul class="text">
<li>Block Type: The block type of the Name Resolution Block is 4.
</li>
<li>Block Total Length: total size of this block, as described in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>.
</li>
</ul>
<p>This is followed by a zero-terminated list of records (in the TLV
format), each of which contains an association between a network address
 and a name. There are three possible types of records:
</p><br><hr class="insert">
<a name="nrrecords"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Name</th><th align="left">Code</th><th align="left">Length</th><th align="left">Description</th><th align="left">Example(s)</th></tr>
<tr>
<td align="left">nres_endofrecord</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">It delimits the end of name resolution records. This
record is needed to determine when the list of name resolution records
has ended and some options (if any) begin.</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">nres_ip4record</td>
<td align="left">1</td>
<td align="left">Variable</td>
<td align="left">Specifies an IPv4 address (contained in the first 4
bytes), followed by one or more zero-terminated strings containing the
DNS entries for that address.</td>
<td align="left">127 0 0 1 "localhost"</td>
</tr>
<tr>
<td align="left">nres_ip6record</td>
<td align="left">2</td>
<td align="left">Variable</td>
<td align="left">Specifies an IPv6 address (contained in the first 16
bytes), followed by one or more zero-terminated strings containing the
DNS entries for that address.</td>
<td align="left">TODO: give a good example</td>
</tr>
</tbody></table>
<br clear="all">
<table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>Each Record Value is aligned to a 32-bit boundary. The corresponding
Record Length reflects the actual length of the Record Value.
</p>
<p>After the list of Name Resolution Records, optionally, a list of options (formatted according to the rules defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>) can be present.
</p>
<p>In addiction to the options defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>, the following options are valid within this block:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Name</th><th align="left">Code</th><th align="left">Length</th><th align="left">Description</th><th align="left">Example(s)</th></tr>
<tr>
<td align="left">ns_dnsname</td>
<td align="left">2</td>
<td align="left">Variable</td>
<td align="left">A UTF-8 string containing the name of the machine (DNS server) used to perform the name resolution.</td>
<td align="left">"our_nameserver"</td>
</tr>
<tr>
<td align="left">ns_dnsIP4addr</td>
<td align="left">3</td>
<td align="left">4</td>
<td align="left">The IPv4 address of the DNS server.</td>
<td align="left">192 168 0 1</td>
</tr>
<tr>
<td align="left">ns_dnsIP6addr</td>
<td align="left">4</td>
<td align="left">16</td>
<td align="left">The IPv6 address of the DNS server.</td>
<td align="left">TODO: give a good example</td>
</tr>
</tbody></table>
<br clear="all">

<p>TODO: Add an "Interface ID" option, if the name resolution is only valid for a specific interface?
</p>
<p>TODO: Does it make sense to have two "optional mechanisms" (records vs. options) here?
</p>
<a name="sectionisb"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Interface Statistics Block (optional)</h3>

<p>The Interface Statistics Block contains the capture statistics for a
given interface and it is optional. The statistics are referred to the
interface defined in the current Section identified by the Interface ID
field. An Interface Statistics Block is normally placed at the end of
the file, but no assumptions can be taken about its position - it can
even appear multiple times for the same interface.
</p>
<p>The format of the Interface Statistics Block is shown in <a class="info" href="#formatisb">Figure&nbsp;14<span> (</span><span class="info">Interface Statistics Block format.</span><span>)</span></a>.
</p><br><hr class="insert">
<a name="formatisb"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
 0 |                   Block Type = 0x00000005                     |
   +---------------------------------------------------------------+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                         Interface ID                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                        Timestamp (High)                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
16 |                        Timestamp (Low)                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
20 /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +---------------------------------------------------------------+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;14: Interface Statistics Block format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The fields have the following meaning:
</p>
<ul class="text">
<li>Block Type: The block type of the Interface Statistics Block is 5.
</li>
<li>Block Total Length: total size of this block, as described in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>.
</li>
<li>Interface ID: it specifies the interface these statistics refers to;
 the correct interface will be the one whose Interface Description Block
 (within the current Section of the file) is identified by same number
(see <a class="info" href="#sectionidb">Section&nbsp;3.2<span> (</span><span class="info">Interface Description Block (mandatory)</span><span>)</span></a>)
 of this field. Please note: in former versions of this document, this
field was 16 bits only. As this differs from its usage in other places
of this doc and as this block was not used "in the wild" before (as to
the knowledge of the authors), it seems reasonable to change it to 32
bits!
</li>
<li>Timestamp: time this statistics refers to. The format of the
timestamp is the same already defined in the Enhanced Packet Block (<a class="info" href="#sectionepb">Section&nbsp;3.3<span> (</span><span class="info">Enhanced Packet Block (optional)</span><span>)</span></a>).
</li>
<li>Options: optionally, a list of options (formatted according to the rules defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>) can be present.
</li>
</ul>
<p>All the statistic fields are defined as options in order to deal with
 systems that do not have a complete set of statistics. Therefore, In
addiction to the options defined in <a class="info" href="#sectionopt">Section&nbsp;2.5<span> (</span><span class="info">Options</span><span>)</span></a>, the following options are valid within this block:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Name</th><th align="left">Code</th><th align="left">Length</th><th align="left">Description</th><th align="left">TODO: give a good example</th></tr>
<tr>
<td align="left">isb_starttime</td>
<td align="left">2</td>
<td align="left">8</td>
<td align="left">Time in which the capture started; time will be stored
in two blocks of four bytes each. The format of the timestamp is the
same already defined in the Enhanced Packet Block (<a class="info" href="#sectionepb">Section&nbsp;3.3<span> (</span><span class="info">Enhanced Packet Block (optional)</span><span>)</span></a>).</td>
<td align="left">TODO: give a good example</td>
</tr>
<tr>
<td align="left">isb_endtime</td>
<td align="left">3</td>
<td align="left">8</td>
<td align="left">Time in which the capture ended; ; time will be stored
in two blocks of four bytes each. The format of the timestamp is the
same already defined in the Enhanced Packet Block (<a class="info" href="#sectionepb">Section&nbsp;3.3<span> (</span><span class="info">Enhanced Packet Block (optional)</span><span>)</span></a>).</td>
<td align="left">TODO: give a good example</td>
</tr>
<tr>
<td align="left">isb_ifrecv</td>
<td align="left">4</td>
<td align="left">8</td>
<td align="left">Number of packets received from the physical interface starting from the beginning of the capture.</td>
<td align="left">100</td>
</tr>
<tr>
<td align="left">isb_ifdrop</td>
<td align="left">5</td>
<td align="left">8</td>
<td align="left">Number of packets dropped by the interface due to lack of resources starting from the beginning of the capture.</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">isb_filteraccept</td>
<td align="left">6</td>
<td align="left">8</td>
<td align="left">Number of packets accepted by filter starting from the beginning of the capture.</td>
<td align="left">100</td>
</tr>
<tr>
<td align="left">isb_osdrop</td>
<td align="left">7</td>
<td align="left">8</td>
<td align="left">Number of packets dropped by the operating system starting from the beginning of the capture.</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">isb_usrdeliv</td>
<td align="left">8</td>
<td align="left">8</td>
<td align="left">Number of packets delivered to the user starting from
the beginning of the capture. The value contained in this field can be
different from the value 'isb_filteraccept - isb_osdrop' because some
packets could still lay in the OS buffers when the capture ended.</td>
<td align="left">0</td>
</tr>
</tbody></table>
<br clear="all">

<p>All the fields that refer to packet counters are 64-bit values,
represented with the byte order of the current section. Special care
must be taken in accessing these fields: since all the blocks are
aligned to a 32-bit boundary, such fields are not guaranteed to be
aligned on a 64-bit boundary.
</p>
<a name="anchor8"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Experimental Blocks (deserved to a further investigation)</h3>

<a name="anchor9"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Alternative Packet Blocks (experimental)</h3>

<p>Can some other packet blocks (besides the ones described in the previous paragraphs) be useful?
</p>
<a name="anchor10"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Compression Block (experimental)</h3>

<p>The Compression Block is optional. A file can contain an arbitrary
number of these blocks. A Compression Block, as the name says, is used
to store compressed data. Its format is shown in <a class="info" href="#formatcb">Figure&nbsp;15<span> (</span><span class="info">Compression Block format.</span><span>)</span></a>.
</p><br><hr class="insert">
<a name="formatcb"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------------------------------------------------------+
|                        Block Type = ?                         |
+---------------------------------------------------------------+
|                      Block Total Length                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Compr. Type  |                                               |
+-+-+-+-+-+-+-+-+                                               |
|                                                               |
|                       Compressed Data                         |
|                                                               |
|              /* variable length, byte-aligned */              |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Block Total Length                       |
+---------------------------------------------------------------+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;15: Compression Block format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The fields have the following meaning:
</p>
<ul class="text">
<li>Block Type: The block type of the Compression Block is not yet assigned.
</li>
<li>Block Total Length: total size of this block, as described in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>.
</li>
<li>Compression Type: specifies the compression algorithm. Possible
values for this field are 0 (uncompressed), 1 (Lempel Ziv), 2 (Gzip),
other?? Probably some kind of dumb and fast compression algorithm could
be effective with some types of traffic (for example web), but which?
</li>
<li>Compressed Data: data of this block. Once decompressed, it is made of other blocks.
</li>
</ul>
<a name="anchor11"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Encryption Block (experimental)</h3>

<p>The Encryption Block is optional. A file can contain an arbitrary
number of these blocks. An Encryption Block is used to store encrypted
data. Its format is shown in <a class="info" href="#formateb">Figure&nbsp;16<span> (</span><span class="info">Encryption Block format.</span><span>)</span></a>.
</p><br><hr class="insert">
<a name="formateb"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------------------------------------------------------+
|                        Block Type = ?                         |
+---------------------------------------------------------------+
|                      Block Total Length                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Encr. Type  |                                               |
+-+-+-+-+-+-+-+-+                                               |
|                                                               |
|                       Encrypted Data                          |
|                                                               |
|              /* variable length, byte-aligned */              |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Block Total Length                       |
+---------------------------------------------------------------+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;16: Encryption Block format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The fields have the following meaning:
</p>
<ul class="text">
<li>Block Type: The block type of the Encryption Block is not yet assigned.
</li>
<li>Block Total Length: total size of this block, as described in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>.
</li>
<li>Encryption Type: specifies the encryption algorithm. Possible values
 for this field are ??? (TODO) NOTE: this block should probably contain
other fields, depending on the encryption algorithm. To be defined
precisely.
</li>
<li>Encrypted Data: data of this block. Once decripted, it originates other blocks.
</li>
</ul>
<a name="anchor12"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Fixed Length Block (experimental)</h3>

<p>The Fixed Length Block is optional. A file can contain an arbitrary
number of these blocks. A Fixed Length Block can be used to optimize the
 access to the file. Its format is shown in <a class="info" href="#formatflm">Figure&nbsp;17<span> (</span><span class="info">Fixed Length Block format.</span><span>)</span></a>.
A Fixed Length Block stores records with constant size. It contains a
set of Blocks (normally Packet Blocks or Simple Packet Blocks), of
wihich it specifies the size. Knowing this size a priori helps to scan
the file and to load some portions of it without truncating a block, and
 is particularly useful with cell-based networks like ATM.
</p><br><hr class="insert">
<a name="formatflm"></a>
<div style="display: table; width: 0; margin-left: 3em; margin-right: auto"><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------------------------------------------------------+
|                        Block Type = ?                         |
+---------------------------------------------------------------+
|                      Block Total Length                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Cell Size            |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
|                                                               |
|                        Fixed Size Data                        |
|                                                               |
|              /* variable length, byte-aligned */              |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Block Total Length                       |
+---------------------------------------------------------------+
</pre></div><table align="center" border="0" cellpadding="0" cellspacing="2"><tbody><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;17: Fixed Length Block format.&nbsp;</b></font><br></td></tr></tbody></table><hr class="insert">

<p>The fields have the following meaning:
</p>
<ul class="text">
<li>Block Type: The block type of the Fixed Length Block is not yet assigned.
</li>
<li>Block Total Length: total size of this block, as described in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>.
</li>
<li>Cell size: the size of the blocks contained in the data field.
</li>
<li>Fixed Size Data: data of this block.
</li>
</ul>
<a name="anchor13"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Directory Block (experimental)</h3>

<p>If present, this block contains the following information:
</p>
<ul class="text">
<li>number of indexed packets (N)
</li>
<li>table with position and length of any indexed packet (N entries)
</li>
</ul>
<p>A directory block must be followed by at least N packets, otherwise
it must be considered invalid. It can be used to efficiently load
portions of the file to memory and to support operations on memory
mapped files. This block can be added by tools like network analyzers as
 a consequence of file processing.
</p>
<a name="anchor14"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Traffic Statistics and Monitoring Blocks (experimental)</h3>

<p>One or more blocks could be defined to contain network statistics or
traffic monitoring information. They could be use to store data
collected from RMON or Netflow probes, or from other network monitoring
tools.
</p>
<a name="anchor15"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
Event/Security Block (experimental)</h3>

<p>This block could be used to store events. Events could contain
generic information (for example network load over 50%, server down...)
or security alerts. An event could be:
</p>
<ul class="text">
<li>skipped, if the application doesn't know how to do with it
</li>
<li>processed independently by the packets. In other words, the applications skips the packets and processes only the alerts
</li>
<li>processed in relation to packets: for example, a security tool could
 load only the packets of the file that are near a security alert; a
monitoring tool could skip the packets captured while the server was
down.
</li>
</ul>
<a name="anchor16"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Recommended File Name Extension: .pcapng</h3>

<p>The recommended file name extension for the "PCAP Next Generation Dump File Format" specified in this document is ".pcapng".
</p>
<p>At least in the "Windows world", files are distinguished by an
extension to their filename. Such an extension is technically not
actually required, as applications should be able to automatically
detect the pcapng file format through the "magic bytes" at the beginning
 of the file. However, using name extensions makes it easier to work
with files (e.g. visually distinguish file formats) so it is recommended
 - though not required - to use .pcapng as the name extension for files
following this specification.
</p>
<p>Please note: To avoid confusion (like the current usage of .cap for a
 pletora of different capture file formats) other file name extensions
than .pcapng should be avoided!
</p>
<a name="anchor17"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
How to add Vendor / Domain specific extensions</h3>

<p>TODO - explain the preferred way to add new block types and new options for existing blocks in more detail.
</p>
<a name="anchor18"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Conclusions</h3>

<p>The file format proposed in this document should be very versatile
and satisfy a wide range of applications.
In the simplest case, it can contain a raw dump of the network data,
made of a series of Simple Packet Blocks.
In the most complex case, it can be used as a repository for
heterogeneous information.
In every case, the file remains easy to parse and an application can
always skip the data it is not interested in; at the same time,
different applications can share the file, and each of them can benefit
of the information produced by the others.
Two or more files can be concatenated obtaining another valid file.
</p>
<a name="appendixPBFM"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Packet Block Flags Word</h3>

<p>The Packet Block Flags Word is a 32-bit value that contains link-layer information about the packet.
</p>
<p>The meaning of the bits is the following:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Bit Number</th><th align="left">Description</th></tr>
<tr>
<td align="left">0-1</td>
<td align="left">Inbound / Outbound packet (00 = information not available, 01 = inbound, 10 = outbound)</td>
</tr>
<tr>
<td align="left">2-4</td>
<td align="left">Reception type (000 = not specified, 001 = unicast, 010 = multicast, 011 = broadcast, 100 = promiscuous).</td>
</tr>
<tr>
<td align="left">5-8</td>
<td align="left">FCS length, in bytes (0000 if this information is not
available). This value overrides the if_fcslen option of the Interface
Description Block, and is used with those link layers (e.g. PPP) where
the length of the FCS can change during time.</td>
</tr>
<tr>
<td align="left">9-15</td>
<td align="left">Reserved (must be set to zero).</td>
</tr>
<tr>
<td align="left">16-31</td>
<td align="left">link-layer-dependent errors (Bit 31 = symbol error, Bit
 30 = preamble error, Bit 29 = Start Frame Delimiter error, Bit 28 =
unaligned frame error, Bit 27 = wrong Inter Frame Gap error, Bit 26 =
packet too short error, Bit 25 = packet too long error, Bit 24 = CRC
error, other?? are 16 bit enough?).</td>
</tr>
</tbody></table>
<br clear="all">

<a name="appendixBlockCodes"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Standardized Block Type Codes</h3>

<p>Every Block is uniquely identified by a 32 bit integer value, stored in the Block Header.
</p>
<p>As pointed out in <a class="info" href="#sectionblock">Section&nbsp;2.1<span> (</span><span class="info">General Block Structure</span><span>)</span></a>, Block Types codes whose Most Significant Bit (bit 31) is set to 1 are reserved for local use by the application.
</p>
<p>All the remaining Block Type codes (0x00000000 to 0x7FFFFFFF) are
standardized by this document. A request should be sent to the authors
of this document to add a new Standard Block Type code to the
specification.
</p>
<p>Here is a list of the Standardized Block Type Codes.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Block Type Code</th><th align="left">Description</th></tr>
<tr>
<td align="left">0x00000000</td>
<td align="left">Reserved ???</td>
</tr>
<tr>
<td align="left">0x00000001</td>
<td align="left"><a class="info" href="#sectionidb">Interface Description Block<span> (</span><span class="info">Interface Description Block (mandatory)</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">0x00000002</td>
<td align="left"><a class="info" href="#sectionpb">Packet Block<span> (</span><span class="info">Packet Block (obsolete!)</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">0x00000003</td>
<td align="left"><a class="info" href="#sectionpbs">Simple Packet Block<span> (</span><span class="info">Simple Packet Block (optional)</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">0x00000004</td>
<td align="left"><a class="info" href="#sectionnrb">Name Resolution Block<span> (</span><span class="info">Name Resolution Block (optional)</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">0x00000005</td>
<td align="left"><a class="info" href="#sectionisb">Interface Statistics Block<span> (</span><span class="info">Interface Statistics Block (optional)</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">0x00000006</td>
<td align="left"><a class="info" href="#sectionepb">Enhanced Packet Block<span> (</span><span class="info">Enhanced Packet Block (optional)</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">0x00000007</td>
<td align="left">IRIG Timestamp Block (requested by Gianluca Varenni &lt;gianluca.varenni@cacetech.com<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;, CACE Technologies LLC)</td>
</tr>
<tr>
<td align="left">0x00000008</td>
<td align="left">Arinc 429 in AFDX Encapsulation Information Block (requested by Gianluca Varenni &lt;gianluca.varenni@cacetech.com<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;, CACE Technologies LLC)</td>
</tr>
<tr>
<td align="left">0x0A0D0D0A</td>
<td align="left"><a class="info" href="#sectionshb">Section Header Block<span> (</span><span class="info">Section Header Block (mandatory)</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">0x0A0D0A00-0x0A0D0AFF</td>
<td align="left">Reserved. Used to detect trace files corrupted because of file transfers using the HTTP protocol in text mode.</td>
</tr>
<tr>
<td align="left">0x000A0D0A-0xFF0A0D0A</td>
<td align="left">Reserved. Used to detect trace files corrupted because of file transfers using the HTTP protocol in text mode.</td>
</tr>
<tr>
<td align="left">0x000A0D0D-0xFF0A0D0D</td>
<td align="left">Reserved. Used to detect trace files corrupted because of file transfers using the HTTP protocol in text mode.</td>
</tr>
<tr>
<td align="left">0x0D0D0A00-0x0D0D0AFF</td>
<td align="left">Reserved. Used to detect trace files corrupted because of file transfers using the FTP protocol in text mode.</td>
</tr>
</tbody></table>
<br clear="all">

<a name="appendixLinkTypes"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Standardized Link Type Codes</h3>

<p>NOTE: we should decide if we want to have this list here or in a
separate document. It may make sense to have this list in a separate
document and describe the format of a frame for each different linktype,
 or specify that the frame format is proprietary of a company and not
public. There are a large number of encapsulations that are really vague
 and unspecified at all (even the name does not make any sense).
Moreover, we should decide if we want to have *all* the linktypes
(LINKTYPE_XXX) defined by libpcap, or just a subset of them, thus trying
 to remove the big mess and confusion of similar headers.
</p>
<p>
</p>
<p>Here is a list of the Standardized Link Type Codes.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<colgroup><col align="left"><col align="left"><col align="left">
</colgroup><tbody><tr><th align="left">Link Type Name</th><th align="left">Link Type Code</th><th align="left">Description</th></tr>
<tr>
<td align="left">LINKTYPE_NULL</td>
<td align="left">0</td>
<td align="left">No link layer information. A packet saved with this
link layer contains a raw L3 packet preceded by a 32-bit host-byte-order
 AF_ value indicating the specific L3 type.</td>
</tr>
<tr>
<td align="left">LINKTYPE_ETHERNET</td>
<td align="left">1</td>
<td align="left">D/I/X and 802.3 Ethernet</td>
</tr>
<tr>
<td align="left">LINKTYPE_EXP_ETHERNET</td>
<td align="left">2</td>
<td align="left">Experimental Ethernet (3Mb)</td>
</tr>
<tr>
<td align="left">LINKTYPE_AX25</td>
<td align="left">3</td>
<td align="left">Amateur Radio AX.25</td>
</tr>
<tr>
<td align="left">LINKTYPE_PRONET</td>
<td align="left">4</td>
<td align="left">Proteon ProNET Token Ring</td>
</tr>
<tr>
<td align="left">LINKTYPE_CHAOS</td>
<td align="left">5</td>
<td align="left">Chaos</td>
</tr>
<tr>
<td align="left">LINKTYPE_TOKEN_RING</td>
<td align="left">6</td>
<td align="left">IEEE 802 Networks</td>
</tr>
<tr>
<td align="left">LINKTYPE_ARCNET</td>
<td align="left">7</td>
<td align="left">ARCNET, with BSD-style header</td>
</tr>
<tr>
<td align="left">LINKTYPE_SLIP</td>
<td align="left">8</td>
<td align="left">Serial Line IP</td>
</tr>
<tr>
<td align="left">LINKTYPE_PPP</td>
<td align="left">9</td>
<td align="left">Point-to-point Protocol</td>
</tr>
<tr>
<td align="left">LINKTYPE_FDDI</td>
<td align="left">10</td>
<td align="left">FDDI</td>
</tr>
<tr>
<td align="left">LINKTYPE_PPP_HDLC</td>
<td align="left">50</td>
<td align="left">PPP in HDLC-like framing</td>
</tr>
<tr>
<td align="left">LINKTYPE_PPP_ETHER</td>
<td align="left">51</td>
<td align="left">NetBSD PPP-over-Ethernet</td>
</tr>
<tr>
<td align="left">LINKTYPE_SYMANTEC_FIREWALL</td>
<td align="left">99</td>
<td align="left">Symantec Enterprise Firewall</td>
</tr>
<tr>
<td align="left">LINKTYPE_ATM_RFC1483</td>
<td align="left">100</td>
<td align="left">LLC/SNAP-encapsulated ATM</td>
</tr>
<tr>
<td align="left">LINKTYPE_RAW</td>
<td align="left">101</td>
<td align="left">Raw IP</td>
</tr>
<tr>
<td align="left">LINKTYPE_SLIP_BSDOS</td>
<td align="left">102</td>
<td align="left">BSD/OS SLIP BPF header</td>
</tr>
<tr>
<td align="left">LINKTYPE_PPP_BSDOS</td>
<td align="left">103</td>
<td align="left">BSD/OS PPP BPF header</td>
</tr>
<tr>
<td align="left">LINKTYPE_C_HDLC</td>
<td align="left">104</td>
<td align="left">Cisco HDLC</td>
</tr>
<tr>
<td align="left">LINKTYPE_IEEE802_11</td>
<td align="left">105</td>
<td align="left">IEEE 802.11 (wireless)</td>
</tr>
<tr>
<td align="left">LINKTYPE_ATM_CLIP</td>
<td align="left">106</td>
<td align="left">Linux Classical IP over ATM</td>
</tr>
<tr>
<td align="left">LINKTYPE_FRELAY</td>
<td align="left">107</td>
<td align="left">Frame Relay</td>
</tr>
<tr>
<td align="left">LINKTYPE_LOOP</td>
<td align="left">108</td>
<td align="left">OpenBSD loopback</td>
</tr>
<tr>
<td align="left">LINKTYPE_ENC</td>
<td align="left">109</td>
<td align="left">OpenBSD IPSEC enc</td>
</tr>
<tr>
<td align="left">LINKTYPE_LANE8023</td>
<td align="left">110</td>
<td align="left">ATM LANE + 802.3 (Reserved for future use)</td>
</tr>
<tr>
<td align="left">LINKTYPE_HIPPI</td>
<td align="left">111</td>
<td align="left">NetBSD HIPPI (Reserved for future use)</td>
</tr>
<tr>
<td align="left">LINKTYPE_HDLC</td>
<td align="left">112</td>
<td align="left">NetBSD HDLC framing (Reserved for future use)</td>
</tr>
<tr>
<td align="left">LINKTYPE_LINUX_SLL</td>
<td align="left">113</td>
<td align="left">Linux cooked socket capture</td>
</tr>
<tr>
<td align="left">LINKTYPE_LTALK</td>
<td align="left">114</td>
<td align="left">Apple LocalTalk hardware</td>
</tr>
<tr>
<td align="left">LINKTYPE_ECONET</td>
<td align="left">115</td>
<td align="left">Acorn Econet</td>
</tr>
<tr>
<td align="left">LINKTYPE_IPFILTER</td>
<td align="left">116</td>
<td align="left">Reserved for use with OpenBSD ipfilter</td>
</tr>
<tr>
<td align="left">LINKTYPE_PFLOG</td>
<td align="left">117</td>
<td align="left">OpenBSD DLT_PFLOG</td>
</tr>
<tr>
<td align="left">LINKTYPE_CISCO_IOS</td>
<td align="left">118</td>
<td align="left">For Cisco-internal use</td>
</tr>
<tr>
<td align="left">LINKTYPE_PRISM_HEADER</td>
<td align="left">119</td>
<td align="left">802.11+Prism II monitor mode</td>
</tr>
<tr>
<td align="left">LINKTYPE_AIRONET_HEADER</td>
<td align="left">120</td>
<td align="left">FreeBSD Aironet driver stuff</td>
</tr>
<tr>
<td align="left">LINKTYPE_HHDLC</td>
<td align="left">121</td>
<td align="left">Reserved for Siemens HiPath HDLC</td>
</tr>
<tr>
<td align="left">LINKTYPE_IP_OVER_FC</td>
<td align="left">122</td>
<td align="left">RFC 2625 IP-over-Fibre Channel</td>
</tr>
<tr>
<td align="left">LINKTYPE_SUNATM</td>
<td align="left">123</td>
<td align="left">Solaris+SunATM</td>
</tr>
<tr>
<td align="left">LINKTYPE_RIO</td>
<td align="left">124</td>
<td align="left">RapidIO - Reserved as per request from Kent Dahlgren &lt;kent@praesum.com<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt; for private use.</td>
</tr>
<tr>
<td align="left">LINKTYPE_PCI_EXP</td>
<td align="left">125</td>
<td align="left">PCI Express - Reserved as per request from Kent Dahlgren &lt;kent@praesum.com<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt; for private use.</td>
</tr>
<tr>
<td align="left">LINKTYPE_AURORA</td>
<td align="left">126</td>
<td align="left">Xilinx Aurora link layer - Reserved as per request from Kent Dahlgren &lt;kent@praesum.com<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt; for private use.</td>
</tr>
<tr>
<td align="left">LINKTYPE_IEEE802_11_RADIO</td>
<td align="left">127</td>
<td align="left">802.11 plus BSD radio header</td>
</tr>
<tr>
<td align="left">LINKTYPE_TZSP</td>
<td align="left">128</td>
<td align="left">Tazmen Sniffer Protocol - Reserved for the TZSP encapsulation, as per request from Chris Waters &lt;chris.waters@networkchemistry.com<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;
 TZSP is a generic encapsulation for any other link type, which includes
 a means to include meta-information with the packet, e.g. signal
strength and channel for 802.11 packets.</td>
</tr>
<tr>
<td align="left">LINKTYPE_ARCNET_LINUX</td>
<td align="left">129</td>
<td align="left">Linux-style headers</td>
</tr>
<tr>
<td align="left">LINKTYPE_JUNIPER_MLPPP</td>
<td align="left">130</td>
<td align="left">Juniper-private data link type, as per request from Hannes Gredler &lt;hannes@juniper.net<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;.  The corresponding DLT_s are used for passing on chassis-internal metainformation such as QOS profiles, etc..</td>
</tr>
<tr>
<td align="left">LINKTYPE_JUNIPER_MLFR</td>
<td align="left">131</td>
<td align="left">Juniper-private data link type, as per request from Hannes Gredler &lt;hannes@juniper.net<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;.  The corresponding DLT_s are used for passing on chassis-internal metainformation such as QOS profiles, etc..</td>
</tr>
<tr>
<td align="left">LINKTYPE_JUNIPER_ES</td>
<td align="left">132</td>
<td align="left">Juniper-private data link type, as per request from Hannes Gredler &lt;hannes@juniper.net<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;.  The corresponding DLT_s are used for passing on chassis-internal metainformation such as QOS profiles, etc..</td>
</tr>
<tr>
<td align="left">LINKTYPE_JUNIPER_GGSN</td>
<td align="left">133</td>
<td align="left">Juniper-private data link type, as per request from Hannes Gredler &lt;hannes@juniper.net<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;.  The corresponding DLT_s are used for passing on chassis-internal metainformation such as QOS profiles, etc..</td>
</tr>
<tr>
<td align="left">LINKTYPE_JUNIPER_MFR</td>
<td align="left">134</td>
<td align="left">Juniper-private data link type, as per request from Hannes Gredler &lt;hannes@juniper.net<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;.  The corresponding DLT_s are used for passing on chassis-internal metainformation such as QOS profiles, etc..</td>
</tr>
<tr>
<td align="left">LINKTYPE_JUNIPER_ATM2</td>
<td align="left">135</td>
<td align="left">Juniper-private data link type, as per request from Hannes Gredler &lt;hannes@juniper.net<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;.  The corresponding DLT_s are used for passing on chassis-internal metainformation such as QOS profiles, etc..</td>
</tr>
<tr>
<td align="left">LINKTYPE_JUNIPER_SERVICES</td>
<td align="left">136</td>
<td align="left">Juniper-private data link type, as per request from Hannes Gredler &lt;hannes@juniper.net<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;.  The corresponding DLT_s are used for passing on chassis-internal metainformation such as QOS profiles, etc..</td>
</tr>
<tr>
<td align="left">LINKTYPE_JUNIPER_ATM1</td>
<td align="left">137</td>
<td align="left">Juniper-private data link type, as per request from Hannes Gredler &lt;hannes@juniper.net<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>&gt;.  The corresponding DLT_s are used for passing on chassis-internal metainformation such as QOS profiles, etc..</td>
</tr>
<tr>
<td align="left">LINKTYPE_APPLE_IP_OVER_IEEE1394</td>
<td align="left">138</td>
<td align="left">Apple IP-over-IEEE 1394 cooked header</td>
</tr>
<tr>
<td align="left">LINKTYPE_MTP2_WITH_PHDR</td>
<td align="left">139</td>
<td align="left">???</td>
</tr>
<tr>
<td align="left">LINKTYPE_MTP2</td>
<td align="left">140</td>
<td align="left">???</td>
</tr>
<tr>
<td align="left">LINKTYPE_MTP3</td>
<td align="left">141</td>
<td align="left">???</td>
</tr>
<tr>
<td align="left">LINKTYPE_SCCP</td>
<td align="left">142</td>
<td align="left">???</td>
</tr>
<tr>
<td align="left">LINKTYPE_DOCSIS</td>
<td align="left">143</td>
<td align="left">DOCSIS MAC frames</td>
</tr>
<tr>
<td align="left">LINKTYPE_LINUX_IRDA</td>
<td align="left">144</td>
<td align="left">Linux-IrDA</td>
</tr>
<tr>
<td align="left">LINKTYPE_IBM_SP</td>
<td align="left">145</td>
<td align="left">Reserved for IBM SP switch and IBM Next Federation switch.</td>
</tr>
<tr>
<td align="left">LINKTYPE_IBM_SN</td>
<td align="left">146</td>
<td align="left">Reserved for IBM SP switch and IBM Next Federation switch.</td>
</tr>
</tbody></table>
<br clear="all">

<a name="appendixLinkHeaders"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Link Layer Headers</h3>

<p>The Packet Data field of the Packet Blocks won't start with the
actual network data captured, but with some link type specific "meta
data". The format of this meta data depends on the link type used. TODO:
 mention example code in libpcap that lists these link headers.
</p>
<a name="rfc.authors"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td class="author-text">&nbsp;</td>
<td class="author-text">Loris Degioanni</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CACE Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1949 Fifth Street #103</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Davis, CA  95616</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">United States</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 530 758 2790</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:loris.degioanni@cacetech.com">loris.degioanni@cacetech.com<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script></a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.winpcap.org/loris/">http://www.winpcap.org/loris/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fulvio Risso</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Politecnico di Torino</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Corso Duca degli Abruzzi, 24</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Torino  10129</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Italy</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+39 011 564 7008</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fulvio.risso@polito.it">fulvio.risso@polito.it<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script></a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://staff.polito.it/fulvio.risso/">http://staff.polito.it/fulvio.risso/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gianluca Varenni</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CACE Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1949 Fifth Street #103</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Davis, CA  95616</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">United States</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 530 758 2790</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gianluca.varenni@cacetech.com">gianluca.varenni@cacetech.com<script cf-hash="f9e31" type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script></a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.winpcap.org/gianluca/">http://www.winpcap.org/gianluca/</a></td></tr>
</tbody></table>
<a name="rfc.copyright"></a><br><hr>
<table summary="layout" class="TOCbug" align="right" cellpadding="0" cellspacing="2"><tbody><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<h3>Full Copyright Statement</h3>
<p class="copyright">
Copyright © The Internet Society (2004). All Rights Reserved.</p>
<p class="copyright">
This document and translations of it may be copied and furnished to
others, and derivative works that comment on or otherwise explain it
or assist in its implementation may be prepared, copied, published and
distributed, in whole or in part, without restriction of any kind,
provided that the above copyright notice and this paragraph are
included on all such copies and derivative works. However, this
document itself may not be modified in any way, such as by removing
the copyright notice or references to the Internet Society or other
Internet organizations, except as needed for the purpose of
developing Internet standards in which case the procedures for
copyrights defined in the Internet Standards process must be
followed, or as required to translate it into languages other than
English.</p>
<p class="copyright">
The limited permissions granted above are perpetual and will not be
revoked by the Internet Society or its successors or assignees.</p>
<p class="copyright">
This document and the information contained herein is provided on an
“AS IS” basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class="copyright">
The IETF takes no position regarding the validity or scope of
any intellectual property or other rights that might be claimed
to  pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; neither does
it represent that it has made any effort to identify any such
rights. Information on the IETF's procedures with respect to
rights in standards-track and standards-related documentation
can be found in BCP&nbsp;11. Copies of claims of rights made
available for publication and any assurances of licenses to
be made available, or the result of an attempt made
to obtain a general license or permission for the use of such
proprietary rights by implementors or users of this
specification can be obtained from the IETF Secretariat.</p>
<p class="copyright">
The IETF invites any interested party to bring to its
attention any copyrights, patents or patent applications, or
other proprietary rights which may cover technology that may be
required to practice this standard. Please address the
information to the IETF Executive Director.</p>
<h3>Acknowledgment</h3>
<p class="copyright">
Funding for the RFC Editor function is currently provided by
the Internet Society.</p>
<script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l=document.getElementsByTagName("a"),t=document.createElement("textarea");for(i=0;l.length-i;i++){try{a=l[i].getAttribute("href");if(a&&a.indexOf("/cdn-cgi/l/email-protection") > -1  && (a.length > 28)){s='';j=27+ 1 + a.indexOf("/cdn-cgi/l/email-protection");if (a.length > j) {r=parseInt(a.substr(j,2),16);for(j+=2;a.length>j&&a.substr(j,1)!='X';j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}j+=1;s+=a.substr(j,a.length-j);}t.innerHTML=s.replace(/</g,"&lt;").replace(/>/g,"&gt;");l[i].setAttribute("href","mailto:"+t.value);}}catch(e){}}}catch(e){}})();
/* ]]> */
</script>


</body></html>
