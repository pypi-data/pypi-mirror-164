"use strict";// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt GNU-AGPL-3.0-or-later
function startQuotes(){const o=elById("next"),s=elById("upvote"),a=elById("downvote"),f=elById("report"),h=[elById("top").getAttribute("quote-id")],m=[o.getAttribute("quote-id")],i=w.location.search,r=(()=>{const e=new URLSearchParams(i).get("keys");return e&&e.length?e.length===4?e.toUpperCase():(alert("Invalid keys given, using default."),"WASD"):"WASD"})();elById("wasd").innerText=`${r[0]} (Witzig), ${r[2]} (Nicht Witzig), ${r[1]} (Vorheriges) und ${r[3]} (Nächstes)`,d.onkeydown=e=>{switch(e.code){case`Key${r[0]}`:s.click();break;case`Key${r[1]}`:w.history.back();break;case`Key${r[2]}`:a.click();break;case`Key${r[3]}`:o.click()}};const p=elById("share"),B=elById("download"),$=elById("author"),u=elById("quote"),c=elById("real-author-name"),x=elById("rating-text"),g=elById("rating-img-container");o.removeAttribute("href");function b(e){p.href=fixHref(`/zitate/share/${e}${i}`),B.href=fixHref(`/zitate/${e}.gif${i}`);const[t,n]=e.split("-",2);u.href=fixHref(`/zitate/info/z/${t}${i}`),$.href=fixHref(`/zitate/info/a/${n}${i}`),h[0]=e}function I(e){if(e=e.toString(),x.innerText=e,["---","???","0"].includes(e)){g.innerHTML="";return}const t=Number.parseInt(e),n=d.createElement("div");n.className="rating-img"+(t>0?" witzig":" nicht-witzig"),g.innerHTML=(n.outerHTML+" ").repeat(Math.min(4,Math.abs(t))).trim()}function k(e){function t(n,z,y){n.disabled=!1,e===z?(n.setAttribute("voted",y),n.value="0"):(n.removeAttribute("voted"),n.value=y)}t(s,1,"1"),t(a,-1,"-1")}function l(e){if(e.status)error(e),e.status in[429,420]&&alert(e.reason);else if(e&&e.id){if(b(e.id),m[0]=e.next,u.innerText=`»${e.quote}«`,$.innerText=`- ${e.author}`,c.innerText=e.real_author,c.href=fixHref(`/zitate/info/a/${e.real_author_id}${i}`),f){const t=new URLSearchParams(i);t.set("subject",`Das falsche Zitat ${e.id} hat ein Problem`),t.set("message",`${u.innerText} ${c.innerText}`),f.href=fixHref(`/kontakt?${t}`)}return I(e.rating),k(Number.parseInt(e.vote)),!0}}w.PopStateHandlers.quotes=e=>e.state&&l(e.state),o.onclick=()=>get(`/api/zitate/${m[0]}`,i,e=>{!l(e)||(e.stateType="quotes",e.url=`/zitate/${e.id}${i}`,w.history.pushState(e,"Falsche Zitate",e.url),w.lastLocation=e.url)});const v=e=>post(`/api/zitate/${h[0]}`,{vote:e},t=>l(t));for(const e of[s,a])e.type="button",e.onclick=()=>{s.disabled=!0,a.disabled=!0,v(e.value),s.disabled=!1,a.disabled=!1}}for(const o of document.getElementsByClassName("auto-submit-element"))o.onchange=()=>o.form.submit();startQuotes();// @license-end
//# sourceMappingURL=quotes.js.map
