From 67410c3ce2c8a210d42d02c790c3ac1f9791605a Mon Sep 17 00:00:00 2001
From: Joachim Bauch <bauch@struktur.de>
Date: Fri, 14 May 2021 09:14:12 +0200
Subject: [PATCH] Calculate with 64bit to avoid potential overflow.

Found by Coverity Scan.
---
 libheif/bitstream.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libheif/bitstream.h b/libheif/bitstream.h
index b694cf4d..48c4c5a8 100644
--- a/libheif/bitstream.h
+++ b/libheif/bitstream.h
@@ -272,7 +272,7 @@ namespace heif {
 
     int64_t get_bits_remaining() const
     {
-      return bytes_remaining*8 + nextbits_cnt;
+      return ((int64_t) bytes_remaining) * 8 + nextbits_cnt;
     }
 
   private:
