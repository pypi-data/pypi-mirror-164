From 82070385eca01f64c587e02c0a75d60386d308c3 Mon Sep 17 00:00:00 2001
From: Joachim Bauch <bauch@struktur.de>
Date: Fri, 14 May 2021 09:11:25 +0200
Subject: [PATCH] Fix undefined behaviour from left shift.

Found by Coverity Scan.
---
 libheif/heif_avif.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libheif/heif_avif.cc b/libheif/heif_avif.cc
index bd233b37..47e858a9 100644
--- a/libheif/heif_avif.cc
+++ b/libheif/heif_avif.cc
@@ -87,7 +87,7 @@ static uint64_t leb128(BitReader& reader)
 {
   uint64_t val = 0;
   for (int i = 0; i < 8; i++) {
-    int v = reader.get_bits(8);
+    int64_t v = reader.get_bits(8);
     val |= (v & 0x7F) << (i * 7);
     if (!(v & 0x80)) {
       break;
