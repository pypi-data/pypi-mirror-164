import{d as C,u as A,al as d,c as s,r as w,e,o as r,b as p,w as k,i as x,at as D,au as I,av as P,aw as $,ax as N,f as m,ao as R,ay as U,ak as V,Q as f,p as F}from"./index.8031f405.js";import{u as H}from"./useRouteParam.7e51ceca.js";import{u as y}from"./useSubscriptionWithDependencies.09bb186a.js";const z=C({__name:"BlocksCatalogCreate",setup(Q){const i=A(),l=d({}),u=d(""),b=H("blockTypeSlug"),_=s(()=>b.value?[b.value]:null),v=y(R.getBlockTypeBySlug,_),a=s(()=>v.response),S=s(()=>a.value?[{blockSchemas:{blockTypeId:{any_:[a.value.id]}}}]:null),h=y(U.getBlockSchemas,S),t=s(()=>{var o;return(o=h.response)==null?void 0:o[0]});function g(){!t.value||!a.value||V.createBlockDocument({name:u.value,data:l.value,blockSchemaId:t.value.id,blockTypeId:a.value.id}).then(({id:o})=>{f("Block created successfully","success"),i.push(F.block(o))}).catch(o=>{f("Failed to create block","error"),console.error(o)})}function T(){i.back()}return(o,c)=>{const B=w("p-layout-default");return e(a)?(r(),p(B,{key:0,class:"blocks-catalog-create"},{header:k(()=>[x(e(D),{"block-type":e(a)},null,8,["block-type"])]),default:k(()=>[e(a)?(r(),p(e(I),{key:0,"block-type":e(a)},{default:k(()=>[e(t)?(r(),p(e(P),$({key:0,data:l.value,"onUpdate:data":c[0]||(c[0]=n=>l.value=n),name:u.value,"onUpdate:name":c[1]||(c[1]=n=>u.value=n),"block-schema":e(t)},N({submit:g,cancel:T})),null,16,["data","name","block-schema"])):m("",!0)]),_:1},8,["block-type"])):m("",!0)]),_:1})):m("",!0)}}});export{z as default};
